function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{jcJX:function(e,t,r){"use strict";r.r(t);var a,i,s=r("ofXK"),n=r("tyNb"),o=r("AytR"),c=r("fXoL"),u=r("naqj"),d=r("3Pt+"),l=r("2Vo4"),b=((a=function(){function e(t){var r=this;_classCallCheck(this,e),this.scriptLoaded=!1,this.readySubject=new l.a(!1),window.reCaptchaOnloadCallback=function(){return t.run(r.onloadCallback.bind(r))}}return _createClass(e,[{key:"getReady",value:function(e){if(!this.scriptLoaded){this.scriptLoaded=!0;var t=document.body,r=document.createElement("script");r.innerHTML="",r.src="https://www.google.com/recaptcha/api.js?onload=reCaptchaOnloadCallback&render=explicit"+(e?"&hl="+e:""),r.async=!0,r.defer=!0,t.appendChild(r)}return this.readySubject.asObservable()}},{key:"onloadCallback",value:function(){this.readySubject.next(!0)}}]),e}()).\u0275fac=function(e){return new(e||a)(c.ac(c.A))},a.\u0275prov=c.Mb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),m=["target"],p=((i=function(){function e(t,r){_classCallCheck(this,e),this._zone=t,this._captchaService=r,this.site_key=null,this.theme="light",this.type="image",this.size="normal",this.tabindex=0,this.language=null,this.captchaResponse=new c.o,this.captchaExpired=new c.o,this.widgetId=null}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this._captchaService.getReady(this.language).subscribe((function(t){t&&(e.widgetId=window.grecaptcha.render(e.targetRef.nativeElement,{sitekey:e.site_key,theme:e.theme,type:e.type,size:e.size,tabindex:e.tabindex,callback:function(t){return e._zone.run(e.recaptchaCallback.bind(e,t))},"expired-callback":function(){return e._zone.run(e.recaptchaExpiredCallback.bind(e))}}))}))}},{key:"reset",value:function(){null!==this.widgetId&&window.grecaptcha.reset(this.widgetId)}},{key:"getResponse",value:function(){return this.widgetId?window.grecaptcha.getResponse(this.targetRef.nativeElement):null}},{key:"recaptchaCallback",value:function(e){this.captchaResponse.emit(e)}},{key:"recaptchaExpiredCallback",value:function(){this.captchaExpired.emit()}}]),e}()).\u0275fac=function(e){return new(e||i)(c.Qb(c.A),c.Qb(b))},i.\u0275cmp=c.Kb({type:i,selectors:[["bd2-recaptcha"]],viewQuery:function(e,t){var r;1&e&&c.Fc(m,!0),2&e&&c.wc(r=c.fc())&&(t.targetRef=r.first)},inputs:{site_key:"site_key",theme:"theme",type:"type",size:"size",tabindex:"tabindex",language:"language"},outputs:{captchaResponse:"captchaResponse",captchaExpired:"captchaExpired"},decls:2,vars:0,consts:[["target",""]],template:function(e,t){1&e&&c.Rb(0,"div",null,0)},encapsulation:2}),i),f=["recaptcha"];function h(e,t){if(1&e&&(c.Wb(0,"div",3),c.Jc(1),c.Vb()),2&e){var r=c.ic();c.Cb(1),c.Lc("",r.msg," ")}}function g(e,t){if(1&e&&(c.Wb(0,"div",4),c.Jc(1),c.Vb()),2&e){var r=c.ic();c.Cb(1),c.Lc("",r.errMsg," ")}}function v(e,t){if(1&e){var r=c.Xb();c.Wb(0,"form",null,5),c.Wb(2,"div",6),c.Wb(3,"label",7),c.Jc(4,"Login or email"),c.Vb(),c.Wb(5,"input",8),c.ec("ngModelChange",(function(e){return c.Ac(r),c.ic().identifier=e})),c.Vb(),c.Vb(),c.Wb(6,"div",6),c.Wb(7,"bd2-recaptcha",9,10),c.ec("captchaResponse",(function(e){return c.Ac(r),c.ic().captcha(e)}))("captchaExpired",(function(e){return c.Ac(r),c.ic().captchaExpired()})),c.Vb(),c.Wb(9,"div",11),c.Jc(10," Captcha selection is needed "),c.Vb(),c.Vb(),c.Wb(11,"button",12),c.ec("click",(function(e){return c.Ac(r),c.ic().request()})),c.Jc(12,"Send "),c.Vb(),c.Vb()}if(2&e){var a=c.xc(1),i=c.ic();c.Cb(5),c.oc("ngModel",i.identifier),c.Cb(2),c.oc("site_key",i.captchaSiteKey),c.Cb(2),c.oc("hidden",!i.missingCaptcha),c.Cb(2),c.oc("disabled",!a.valid)}}var w,y=((w=function(){function e(t){_classCallCheck(this,e),this.userService=t,this.requested=!1,this.captchaSiteKey=o.a.captchaSiteKey}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"captcha",value:function(e){this.gRecaptchaResponse=e,e&&(this.missingCaptcha=!1)}},{key:"captchaExpired",value:function(){this.gRecaptchaResponse=null}},{key:"request",value:function(){var e=this;this.identifier&&""!==this.identifier.trim()&&(this.msg=void 0,this.errMsg=void 0,this.userService.requestReset(this.identifier,this.gRecaptchaResponse).then((function(t){e.msg="Reset link was sent to "+t,e.requested=!0})).catch((function(t){e.errMsg=t.message?t.message:t,e.gRecaptchaResponse=null,e.recaptcha&&e.recaptcha.reset()})))}}]),e}()).\u0275fac=function(e){return new(e||w)(c.Qb(u.a))},w.\u0275cmp=c.Kb({type:w,selectors:[["bd2-reset-request"]],viewQuery:function(e,t){var r;1&e&&c.Pc(f,!0),2&e&&c.wc(r=c.fc())&&(t.recaptcha=r.first)},decls:6,vars:3,consts:[["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-success"],[1,"alert","alert-danger"],["reminderForm","ngForm"],[1,"form-group"],["for","identifier"],["type","text","required","","id","identifier","name","identifier",1,"form-control",3,"ngModel","ngModelChange"],[3,"site_key","captchaResponse","captchaExpired"],["recaptcha",""],[1,"alert","alert-danger",3,"hidden"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.Wb(0,"div"),c.Wb(1,"h3"),c.Jc(2,"Forgotten password"),c.Vb(),c.Hc(3,h,2,1,"div",0),c.Hc(4,g,2,1,"div",1),c.Hc(5,v,13,4,"form",2),c.Vb()),2&e&&(c.Cb(3),c.oc("ngIf",t.msg),c.Cb(1),c.oc("ngIf",t.errMsg),c.Cb(1),c.oc("ngIf",!t.requested))},directives:[s.m,d.C,d.q,d.r,d.c,d.y,d.p,d.s,p],encapsulation:2}),w),C=/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/,W=/^[a-z]+$/,V=/^[A-Z]+$/,k=/^[0-9]+$/;function I(e){return!e||e.length<8||!!W.test(e)||!!V.test(e)||!!k.test(e)}function J(e){return I(e)?{"password-weak":!0}:null}function N(e){return e.password===e.password2?null:{"password-mismatch":!0}}function F(e){return t=(t=e)?t.toLocaleLowerCase():"",C.test(t)?null:{pattern:"Not valid email format"};var t}function R(e,t){if(1&e&&(c.Wb(0,"div",3),c.Jc(1),c.Vb()),2&e){var r=c.ic();c.Cb(1),c.Lc("",r.msg," ")}}function q(e,t){if(1&e&&(c.Wb(0,"div",4),c.Jc(1),c.Vb()),2&e){var r=c.ic();c.Cb(1),c.Lc("",r.errMsg," ")}}function P(e,t){if(1&e){var r=c.Xb();c.Wb(0,"form",null,5),c.Wb(2,"div",6),c.Wb(3,"label",7),c.Jc(4,"Password"),c.Vb(),c.Wb(5,"input",8,9),c.ec("ngModelChange",(function(e){return c.Ac(r),c.ic(2).password=e})),c.Vb(),c.Wb(7,"div",10),c.Jc(8," Password must be at least 8 long, containing a digit or symbol or capital letter "),c.Vb(),c.Vb(),c.Wb(9,"div",6),c.Wb(10,"label",11),c.Jc(11,"Repeat password"),c.Vb(),c.Wb(12,"input",12,13),c.ec("ngModelChange",(function(e){return c.Ac(r),c.ic(2).password2=e})),c.Vb(),c.Wb(14,"div",10),c.Jc(15," Passwords do not match "),c.Vb(),c.Vb(),c.Wb(16,"button",14),c.ec("click",(function(e){return c.Ac(r),c.ic(2).reset()})),c.Jc(17,"Reset "),c.Vb(),c.Vb()}if(2&e){var a=c.xc(1),i=c.xc(6),s=c.xc(13),n=c.ic(2);c.Cb(5),c.oc("ngModel",n.password),c.Cb(2),c.oc("hidden",i.pristine||!n.weakPassword()),c.Cb(5),c.oc("ngModel",n.password2),c.Cb(2),c.oc("hidden",s.pristine||n.matching()),c.Cb(2),c.oc("disabled",!a.form.valid||n.passwordProblem())}}function x(e,t){if(1&e&&(c.Wb(0,"div"),c.Hc(1,P,18,5,"form",2),c.Vb()),2&e){var r=c.ic();c.Cb(1),c.oc("ngIf",!r.requested)}}var A,_=((A=function(){function e(t,r){_classCallCheck(this,e),this.userService=t,this.route=r,this.requested=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.token=this.route.snapshot.queryParamMap.get("token"),this.token||(this.errMsg="Missing reset token")}},{key:"reset",value:function(){var e=this;this.token&&this.userService.resetPassword(this.password,this.token).then((function(t){e.msg="You can sign in with new password and login "+t,e.requested=!0})).catch((function(t){e.errMsg=t.message?t.message:t}))}},{key:"weakPassword",value:function(){return I(this.password)}},{key:"matching",value:function(){return this.password===this.password2}},{key:"passwordProblem",value:function(){return!!this.weakPassword()||!this.matching()}}]),e}()).\u0275fac=function(e){return new(e||A)(c.Qb(u.a),c.Qb(n.a))},A.\u0275cmp=c.Kb({type:A,selectors:[["ng-component"]],decls:6,vars:3,consts:[["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-success"],[1,"alert","alert-danger"],["resetForm","ngForm"],[1,"form-group"],["for","password"],["type","password","required","","minlength","8","id","password","placeholder","new password","name","fPassword",1,"form-control",3,"ngModel","ngModelChange"],["fPassword","ngModel"],[1,"alert","alert-danger",3,"hidden"],["for","password2"],["type","password","id","password2","required","","placeholder","password","name","fPassword2",1,"form-control",3,"ngModel","ngModelChange"],["fPassword2","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.Wb(0,"div"),c.Wb(1,"h3"),c.Jc(2,"Password reset"),c.Vb(),c.Hc(3,R,2,1,"div",0),c.Hc(4,q,2,1,"div",1),c.Hc(5,x,2,1,"div",2),c.Vb()),2&e&&(c.Cb(3),c.oc("ngIf",t.msg),c.Cb(1),c.oc("ngIf",t.errMsg),c.Cb(1),c.oc("ngIf",t.token))},directives:[s.m,d.C,d.q,d.r,d.c,d.y,d.l,d.p,d.s],encapsulation:2}),A),M=r("6tuW");function S(e,t){1&e&&(c.Wb(0,"div",1),c.Jc(1,"Use the activation link that was sent in the email"),c.Vb())}var E,O=((E=function(){function e(t,r,a,i){_classCallCheck(this,e),this.route=t,this.router=r,this.userService=a,this.feedback=i}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.token=this.route.snapshot.queryParamMap.get("token"),this.token&&this.userService.activate(this.token).then((function(t){e.feedback.success("Your account has been activated, use: "+t.login+" to sign in"),e.router.navigate(["/login"])})).catch((function(t){e.feedback.error(t),e.router.navigate(["/login"])}))}}]),e}()).\u0275fac=function(e){return new(e||E)(c.Qb(n.a),c.Qb(n.c),c.Qb(u.a),c.Qb(M.a))},E.\u0275cmp=c.Kb({type:E,selectors:[["ng-component"]],decls:1,vars:1,consts:[["class","alert alert-danger danger",4,"ngIf"],[1,"alert","alert-danger","danger"]],template:function(e,t){1&e&&c.Hc(0,S,2,0,"div",0),2&e&&c.oc("ngIf",!t.token)},directives:[s.m],encapsulation:2}),E),H=r("LRne"),L=r("lJxs"),Q=r("JIr8"),j=r("Ee+/"),z=r("Wp6s"),K=r("kmnG"),G=r("qFsG"),U=r("bSwM"),X=["recaptcha"];function D(e,t){if(1&e&&(c.Wb(0,"div",3),c.Wb(1,"h4"),c.Jc(2,"Your registration was successful."),c.Vb(),c.Jc(3," We sent you the activation link to "),c.Wb(4,"strong"),c.Jc(5),c.Vb(),c.Jc(6,", please use that link before logging in "),c.Vb()),2&e){var r=c.ic();c.Cb(5),c.Kc(r.registeredMsg)}}function $(e,t){1&e&&(c.Wb(0,"mat-error"),c.Jc(1,"Alphanumerical login, min length 5, only numbers, small letters and ._"),c.Vb())}function Y(e,t){1&e&&(c.Wb(0,"mat-error"),c.Jc(1,"Such login already exists"),c.Vb())}function T(e,t){1&e&&(c.Wb(0,"mat-error"),c.Jc(1,"Not valid email format"),c.Vb())}function B(e,t){1&e&&(c.Wb(0,"mat-error"),c.Jc(1,"Address is already being used"),c.Vb())}function Z(e,t){1&e&&(c.Wb(0,"mat-error"),c.Jc(1," Academic email is required for the registration. Contact us if your email is not recognized as academic. "),c.Vb())}function ee(e,t){1&e&&(c.Wb(0,"mat-error"),c.Jc(1,"Passwords do not match"),c.Vb())}function te(e,t){if(1&e){var r=c.Xb();c.Wb(0,"div",4),c.Wb(1,"form",5,6),c.Wb(3,"div",7),c.Wb(4,"mat-form-field",8),c.Wb(5,"mat-label",9),c.Jc(6,"Login"),c.Vb(),c.Rb(7,"input",10),c.Wb(8,"mat-hint"),c.Jc(9,"Alphanumerical login, min length 5"),c.Vb(),c.Hc(10,$,2,0,"mat-error",11),c.Hc(11,Y,2,0,"mat-error",11),c.Vb(),c.Vb(),c.Wb(12,"div",7),c.Wb(13,"mat-form-field",8),c.Wb(14,"mat-label",12),c.Jc(15,"Email"),c.Vb(),c.Rb(16,"input",13),c.Hc(17,T,2,0,"mat-error",11),c.Hc(18,B,2,0,"mat-error",11),c.Hc(19,Z,2,0,"mat-error",11),c.Vb(),c.Vb(),c.Wb(20,"div",14),c.Wb(21,"div",7),c.Wb(22,"mat-form-field",8),c.Wb(23,"mat-label",15),c.Jc(24,"Password"),c.Vb(),c.Rb(25,"input",16),c.Wb(26,"mat-hint"),c.Jc(27,"Password must be at least 8 long, containing a digit or symbol or capital letter"),c.Vb(),c.Wb(28,"mat-error"),c.Jc(29,"Password must be at least 8 long, containing a digit or symbol or capital letter"),c.Vb(),c.Vb(),c.Vb(),c.Wb(30,"div",7),c.Wb(31,"mat-form-field",8),c.Wb(32,"mat-label",17),c.Jc(33,"Repeat password"),c.Vb(),c.Rb(34,"input",18),c.Hc(35,ee,2,0,"mat-error",11),c.Vb(),c.Vb(),c.Vb(),c.Wb(36,"div",7),c.Wb(37,"mat-form-field",8),c.Wb(38,"mat-label",19),c.Jc(39,"First Name"),c.Vb(),c.Rb(40,"input",20),c.Vb(),c.Vb(),c.Wb(41,"div",7),c.Wb(42,"mat-form-field",8),c.Wb(43,"mat-label",21),c.Jc(44,"Family Name"),c.Vb(),c.Rb(45,"input",22),c.Vb(),c.Vb(),c.Wb(46,"div",7),c.Wb(47,"mat-form-field",8),c.Wb(48,"mat-label",23),c.Jc(49,"Institution"),c.Vb(),c.Rb(50,"input",24),c.Vb(),c.Vb(),c.Wb(51,"div",7),c.Wb(52,"bd2-recaptcha",25,26),c.ec("captchaExpired",(function(e){return c.Ac(r),c.ic().captchaExpired()}))("captchaResponse",(function(e){return c.Ac(r),c.ic().captcha(e)})),c.Vb(),c.Wb(54,"div",27),c.Jc(55," Captcha selection is needed "),c.Vb(),c.Vb(),c.Wb(56,"div",7),c.Wb(57,"mat-checkbox",28),c.Jc(58," I agree to conditions of "),c.Wb(59,"span",29),c.Wb(60,"a",30),c.ec("click",(function(e){return c.Ac(r),c.ic().helpDialog.show("service")})),c.Jc(61,"service"),c.Vb(),c.Vb(),c.Jc(62,". And I understand that unless changed my data will be shared 3 years after their registration. "),c.Vb(),c.Vb(),c.Wb(63,"button",31),c.ec("click",(function(e){return c.Ac(r),c.ic().register()})),c.Jc(64," Register "),c.Vb(),c.Vb(),c.Vb()}if(2&e){var a=c.ic();c.Cb(1),c.oc("formGroup",a.userForm),c.Cb(9),c.oc("ngIf",a.userNameField.errors&&!a.userNameField.errors["login-taken"]),c.Cb(1),c.oc("ngIf",a.userNameField.errors&&a.userNameField.errors["login-taken"]),c.Cb(6),c.oc("ngIf",a.emailField.errors&&a.emailField.errors.pattern),c.Cb(1),c.oc("ngIf",a.emailField.errors&&a.emailField.errors["email-taken"]),c.Cb(1),c.oc("ngIf",a.emailField.errors&&a.emailField.errors["email-nonacademic"]),c.Cb(16),c.oc("ngIf",a.passwordsGroup.errors),c.Cb(17),c.oc("site_key",a.captchaSiteKey),c.Cb(2),c.oc("hidden",!a.missingCaptcha),c.Cb(9),c.oc("disabled",a.blocked||a.userForm.invalid)}}var re,ae=((re=function(){function e(t,r,a,i){_classCallCheck(this,e),this.userService=t,this.feedback=r,this.fb=a,this.helpDialog=i,this.blocked=!1,this.missingCaptcha=!1,this.captchaSiteKey=o.a.captchaSiteKey}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.userForm=this.fb.group({username:[void 0,{validators:[d.A.required],asyncValidators:function(t){return e.availableLogin(t.value)},updateOn:"blur"}],email:[void 0,{validators:[d.A.required,function(e){return F(e.value)}],asyncValidators:function(t){return e.suitableEmail(t.value)},updateOn:"blur"}],passwords:this.fb.group({password:[void 0,[d.A.required,function(e){return J(e.value)}]],password2:[void 0,[d.A.required]]},{validator:function(e){return N(e.value)}}),firstName:[void 0,[d.A.required]],lastName:[void 0,[d.A.required]],institution:[void 0,[d.A.required]],terms:[void 0,[d.A.required]]}),this.userNameField=this.userForm.get("username"),this.emailField=this.userForm.get("email"),this.passwordField=this.userForm.get("passwords.password"),this.password2Field=this.userForm.get("passwords.password2"),this.passwordsGroup=this.userForm.get("passwords")}},{key:"captcha",value:function(e){this.gRecaptchaResponse=e,e&&(this.missingCaptcha=!1)}},{key:"captchaExpired",value:function(){this.gRecaptchaResponse=null}},{key:"availableLogin",value:function(e){var t=this;return!e||e.length<5?Object(H.a)({"too-short":!0}):this.userService.availableLogin(e).pipe(Object(L.a)((function(t){return t?null:{"login-taken":"User "+e+" already exists"}})),Object(Q.a)((function(e){return t.feedback.error(e),Object(H.a)({"cannot-connect":!0})})))}},{key:"suitableEmail",value:function(e){var t=this;return this.userService.suitableEmail(e).pipe(Object(L.a)((function(t){if(t.isFree&&t.isAcademic)return null;var r={};return t.isFree||(r["email-taken"]="Email: "+e+" is already being used"),t.isAcademic||(r["email-nonacademic"]="Academic email is required for the registration. Contact us if your email is not recognized as academic."),r})),Object(Q.a)((function(e){return t.feedback.error(e),Object(H.a)({"cannot-connect":!0})})))}},{key:"register",value:function(){if(this.userForm.valid){if(!this.gRecaptchaResponse&&!this.emailField.value.endsWith(".cn")&&!this.emailField.value.endsWith(".tw"))return void(this.missingCaptcha=!0);var e=this.makeUserData(this.userForm.value);this.triggerRegistration(e)}}},{key:"makeUserData",value:function(e){return{login:e.username,password:e.passwords.password,email:e.email,firstName:e.firstName,lastName:e.lastName,institution:e.institution,terms:e.terms,g_recaptcha_response:this.gRecaptchaResponse}}},{key:"triggerRegistration",value:function(e){var t=this;this.userService.register(e).then((function(e){t.registered=!0,t.registeredMsg=e.email,t.feedback.success("Registration successful")})).catch((function(e){t.feedback.error(e),t.gRecaptchaResponse=void 0,t.recaptcha&&t.recaptcha.reset()}))}}]),e}()).\u0275fac=function(e){return new(e||re)(c.Qb(u.a),c.Qb(M.a),c.Qb(d.d),c.Qb(j.a))},re.\u0275cmp=c.Kb({type:re,selectors:[["ng-component"]],viewQuery:function(e,t){var r;1&e&&c.Pc(X,!0),2&e&&c.wc(r=c.fc())&&(t.recaptcha=r.first)},decls:7,vars:2,consts:[[1,"mb-2"],["class","alert alert-success",4,"ngIf"],["class","mb-4",4,"ngIf"],[1,"alert","alert-success"],[1,"mb-4"],[3,"formGroup"],["registrationForm",""],[1,"form-group"],[1,"w-100"],["for","username"],["matInput","","formControlName","username","id","username","minlength","5","pattern","[0-9|a-z|\\._]+","placeholder","choose login","required","","type","text",1,""],[4,"ngIf"],["for","email"],["matInput","","formControlName","email","id","email","placeholder","your email","required","","type","text",1,""],["formGroupName","passwords"],["for","password"],["matInput","","formControlName","password","id","password","minlength","8","placeholder","password","required","","type","password",1,""],["for","password2"],["matInput","","formControlName","password2","id","password2","minlength","8","placeholder","password","required","","type","password",1,""],["for","firstName"],["matInput","","formControlName","firstName","id","firstName","minlength","2","placeholder","e.g. Charles","required","","type","text",1,""],["for","lastName"],["matInput","","formControlName","lastName","id","lastName","minlength","2","placeholder","e.g. Darwin","required","","type","text",1,""],["for","institution"],["matInput","","formControlName","institution","id","institution","minlength","3","placeholder","e.g. University of Edinburgh","required","","type","text",1,""],[3,"site_key","captchaExpired","captchaResponse"],["recaptcha",""],[1,"alert","alert-danger",3,"hidden"],["formControlName","terms","id","terms","required","","type","checkbox"],[2,"font-weight","bold","text-decoration","underline"],["role","button",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.Wb(0,"mat-card",0),c.Wb(1,"mat-card-title"),c.Wb(2,"h2"),c.Jc(3,"User registration"),c.Vb(),c.Vb(),c.Wb(4,"mat-card-content"),c.Hc(5,D,7,1,"div",1),c.Hc(6,te,65,10,"div",2),c.Vb(),c.Vb()),2&e&&(c.Cb(5),c.oc("ngIf",t.registered),c.Cb(1),c.oc("ngIf",!t.registered))},directives:[z.a,z.e,z.c,s.m,d.C,d.q,d.h,K.b,K.f,G.b,d.c,d.p,d.g,d.l,d.v,d.y,K.e,d.i,K.a,p,U.a,U.c],encapsulation:2}),re),ie=r("PqYM");function se(e,t){1&e&&(c.Wb(0,"div",21),c.Jc(1,"Account has been updated"),c.Vb())}function ne(e,t){if(1&e){var r=c.Xb();c.Wb(0,"mat-card",1),c.Wb(1,"mat-card-title"),c.Wb(2,"h2"),c.Jc(3),c.Vb(),c.Vb(),c.Wb(4,"mat-card-content"),c.Hc(5,se,2,0,"div",2),c.Wb(6,"form",3,4),c.Wb(8,"div",5),c.Wb(9,"mat-form-field",6),c.Wb(10,"mat-label",7),c.Jc(11,"Login"),c.Vb(),c.Rb(12,"input",8),c.Vb(),c.Vb(),c.Wb(13,"div",5),c.Wb(14,"a",9),c.Jc(15,"Change password"),c.Vb(),c.Vb(),c.Wb(16,"div",5),c.Wb(17,"mat-form-field",6),c.Wb(18,"mat-label",10),c.Jc(19,"Email"),c.Vb(),c.Rb(20,"input",11),c.Wb(21,"mat-error"),c.Jc(22,"Not valid email format"),c.Vb(),c.Vb(),c.Vb(),c.Wb(23,"div",5),c.Wb(24,"mat-form-field",6),c.Wb(25,"mat-label",12),c.Jc(26,"First Name"),c.Vb(),c.Rb(27,"input",13),c.Vb(),c.Vb(),c.Wb(28,"div",5),c.Wb(29,"mat-form-field",6),c.Wb(30,"mat-label",14),c.Jc(31,"Family Name"),c.Vb(),c.Rb(32,"input",15),c.Vb(),c.Vb(),c.Wb(33,"div",5),c.Wb(34,"mat-form-field",6),c.Wb(35,"mat-label",16),c.Jc(36,"Institution"),c.Vb(),c.Rb(37,"input",17),c.Vb(),c.Vb(),c.Wb(38,"div",5),c.Wb(39,"mat-form-field",6),c.Wb(40,"mat-label",18),c.Jc(41,"Current password"),c.Vb(),c.Rb(42,"input",19),c.Vb(),c.Vb(),c.Wb(43,"button",20),c.ec("click",(function(e){return c.Ac(r),c.ic().save()})),c.Jc(44," Update "),c.Vb(),c.Vb(),c.Vb(),c.Vb()}if(2&e){var a=c.ic();c.Cb(3),c.Lc("Edit user: ",a.user.name,""),c.Cb(2),c.oc("ngIf",a.updated),c.Cb(1),c.oc("formGroup",a.userForm),c.Cb(37),c.oc("disabled",a.userForm.invalid)}}function oe(e,t){1&e&&(c.Wb(0,"div",18),c.Jc(1,"Password has been updated"),c.Vb())}function ce(e,t){1&e&&(c.Wb(0,"mat-error"),c.Jc(1,"Passwords do not match"),c.Vb())}function ue(e,t){if(1&e){var r=c.Xb();c.Wb(0,"mat-card",1),c.Wb(1,"mat-card-title"),c.Wb(2,"h2"),c.Jc(3),c.Vb(),c.Vb(),c.Wb(4,"mat-card-content"),c.Hc(5,oe,2,0,"div",2),c.Wb(6,"form",3,4),c.Wb(8,"div",5),c.Wb(9,"mat-form-field",6),c.Wb(10,"mat-label",7),c.Jc(11,"Login"),c.Vb(),c.Rb(12,"input",8),c.Vb(),c.Vb(),c.Wb(13,"div",9),c.Wb(14,"div",5),c.Wb(15,"mat-form-field",6),c.Wb(16,"mat-label",10),c.Jc(17,"Password"),c.Vb(),c.Rb(18,"input",11),c.Wb(19,"mat-hint"),c.Jc(20,"Password must be at least 8 long, containing a digit or symbol or capital letter"),c.Vb(),c.Wb(21,"mat-error"),c.Jc(22,"Password must be at least 8 long, containing a digit or symbol or capital letter"),c.Vb(),c.Vb(),c.Vb(),c.Wb(23,"div",5),c.Wb(24,"mat-form-field",6),c.Wb(25,"mat-label",12),c.Jc(26,"Repeat password"),c.Vb(),c.Rb(27,"input",13),c.Hc(28,ce,2,0,"mat-error",14),c.Vb(),c.Vb(),c.Vb(),c.Wb(29,"div",5),c.Wb(30,"mat-form-field",6),c.Wb(31,"mat-label",15),c.Jc(32,"Current password"),c.Vb(),c.Rb(33,"input",16),c.Vb(),c.Vb(),c.Wb(34,"button",17),c.ec("click",(function(e){return c.Ac(r),c.ic().save()})),c.Jc(35," Update "),c.Vb(),c.Vb(),c.Vb(),c.Vb()}if(2&e){var a=c.ic();c.Cb(3),c.Lc("Change password for ",a.user.name,""),c.Cb(2),c.oc("ngIf",a.updated),c.Cb(1),c.oc("formGroup",a.userForm),c.Cb(22),c.oc("ngIf",a.passwordsGroup.errors),c.Cb(6),c.oc("disabled",a.userForm.invalid)}}var de,le,be,me,pe=[{path:"",children:[{path:"edit",component:(le=function(){function e(t,r,a){_classCallCheck(this,e),this.userService=t,this.feedback=r,this.fb=a,this.updated=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.user=this.userService.currentUser,this.userForm=this.fb.group({username:[{value:this.user.login,disabled:!0},[d.A.required],[]],email:[this.user.email,[d.A.required,function(e){return F(e.value)}],[]],firstName:[this.user.firstName,[d.A.required]],lastName:[this.user.lastName,[d.A.required]],institution:[this.user.institution,[d.A.required]],currentPassword:[void 0,[d.A.required]]}),this.userNameField=this.userForm.get("username"),this.emailField=this.userForm.get("email"),this.currentPasswordField=this.userForm.get("currentPassword")}},{key:"save",value:function(){var e=this;if(this.userForm.valid){var t=this.userForm.value,r={login:this.user.login,currentPassword:t.currentPassword,email:t.email,firstName:t.firstName,lastName:t.lastName,institution:t.institution};this.updated=!1,this.userService.update(r).subscribe((function(t){e.user=t,e.currentPasswordField.reset(),e.feedback.success("User: "+t.login+" has been updated"),e.updated=!0,Object(ie.a)(5e3).subscribe((function(){return e.updated=!1}))}),(function(t){e.feedback.error(t),e.currentPasswordField.reset()}))}}}]),e}(),le.\u0275fac=function(e){return new(e||le)(c.Qb(u.a),c.Qb(M.a),c.Qb(d.d))},le.\u0275cmp=c.Kb({type:le,selectors:[["ng-component"]],decls:1,vars:1,consts:[["class","mb-2",4,"ngIf"],[1,"mb-2"],["class","alert alert-success",4,"ngIf"],[3,"formGroup"],["registrationForm",""],[1,"form-group"],[1,"w-100"],["for","username"],["matInput","","formControlName","username","id","username","required","","type","text",1,""],["routerLink","/account/password"],["for","email"],["matInput","","formControlName","email","id","email","placeholder","your email","required","","type","text",1,""],["for","firstName"],["matInput","","formControlName","firstName","id","firstName","minlength","2","placeholder","e.g. Charles","required","","type","text",1,""],["for","lastName"],["matInput","","formControlName","lastName","id","lastName","minlength","2","placeholder","e.g. Darwin","required","","type","text",1,""],["for","institution"],["matInput","","formControlName","institution","id","institution","placeholder","e.g. University of Edinburgh","required","","type","text",1,""],["for","cPassword"],["matInput","","formControlName","currentPassword","id","cPassword","placeholder","current password","required","","type","password",1,""],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"alert","alert-success"]],template:function(e,t){1&e&&c.Hc(0,ne,45,4,"mat-card",0),2&e&&c.oc("ngIf",t.user&&!t.user.anonymous)},directives:[s.m,z.a,z.e,z.c,d.C,d.q,d.h,K.b,K.f,G.b,d.c,d.p,d.g,d.y,n.e,K.a,d.l],encapsulation:2}),le)},{path:"password",component:(de=function(){function e(t,r,a){_classCallCheck(this,e),this.userService=t,this.feedback=r,this.fb=a,this.updated=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.user=this.userService.currentUser,this.userForm=this.fb.group({username:[{value:this.user.login,disabled:!0},[d.A.required],[]],passwords:this.fb.group({password:[void 0,[d.A.required,function(e){return J(e.value)}]],password2:[void 0,[d.A.required]]},{validator:function(e){return N(e.value)}}),currentPassword:[void 0,[d.A.required]]}),this.passwordsGroup=this.userForm.get("passwords")}},{key:"save",value:function(){var e=this;if(this.userForm.valid){var t=this.userForm.value,r={login:this.user.login,currentPassword:t.currentPassword,password:t.passwords.password};this.updated=!1,this.userService.passwordUpdate(r).subscribe((function(t){e.user=t,e.userForm.reset(),e.feedback.success("User: "+t.login+" password has been updated"),e.updated=!0,Object(ie.a)(5e3).subscribe((function(){return e.updated=!1}))}),(function(t){e.userForm.reset(),e.feedback.error(t)}))}}}]),e}(),de.\u0275fac=function(e){return new(e||de)(c.Qb(u.a),c.Qb(M.a),c.Qb(d.d))},de.\u0275cmp=c.Kb({type:de,selectors:[["ng-component"]],decls:1,vars:1,consts:[["class","mb-2",4,"ngIf"],[1,"mb-2"],["class","alert alert-success",4,"ngIf"],[3,"formGroup"],["registrationForm",""],[1,"form-group"],[1,"w-100"],["for","username"],["matInput","","formControlName","username","id","username","required","","type","text",1,""],["formGroupName","passwords"],["for","password"],["matInput","","formControlName","password","id","password","minlength","8","placeholder","password","required","","type","password",1,""],["for","password2"],["matInput","","formControlName","password2","id","password2","minlength","8","placeholder","password","required","","type","password",1,""],[4,"ngIf"],["for","cPassword"],["matInput","","formControlName","currentPassword","id","cPassword","placeholder","current password","required","","type","password",1,""],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"alert","alert-success"]],template:function(e,t){1&e&&c.Hc(0,ue,36,5,"mat-card",0),2&e&&c.oc("ngIf",t.user&&!t.user.anonymous)},directives:[s.m,z.a,z.e,z.c,d.C,d.q,d.h,K.b,K.f,G.b,d.c,d.p,d.g,d.y,d.i,d.l,K.e,K.a],encapsulation:2}),de)},{path:"register",component:ae},{path:"activate",component:O},{path:"remind",component:y},{path:"reset",component:_}]}],fe=((me=function e(){_classCallCheck(this,e)}).\u0275mod=c.Ob({type:me}),me.\u0275inj=c.Nb({factory:function(e){return new(e||me)},imports:[[n.f.forChild(pe)],n.f]}),me),he=((be=function e(){_classCallCheck(this,e)}).\u0275mod=c.Ob({type:be}),be.\u0275inj=c.Nb({factory:function(e){return new(e||be)},imports:[[]]}),be),ge=r("wMBR"),ve=r("f0Cb"),we=r("NFeN");r.d(t,"AccountModule",(function(){return Ce}));var ye,Ce=((ye=function e(){_classCallCheck(this,e)}).\u0275mod=c.Ob({type:ye}),ye.\u0275inj=c.Nb({factory:function(e){return new(e||ye)},imports:[[s.c,d.j,d.x,he,ge.a,fe,z.d,ve.b,K.d,we.b,G.c,U.b]]}),ye)}}]);