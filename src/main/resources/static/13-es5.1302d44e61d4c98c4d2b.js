!function(){function e(t,n,i){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(t,n,i||t)}function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return r(this,n)}}function r(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"9+85":function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var i=n("0IaG"),r=n("fXoL"),c=n("ofXK");function o(e,t){if(1&e&&r.Ob(0,"div",5),2&e){var n=r.dc();r.jc("innerHTML",n.question.details,r.tc)}}var u,l,d=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Cancel",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"OK";s(this,e),this.question=t,this.details=n,this.cancelLabel=i,this.okLabel=r},b=((l=function(){function e(t){s(this,e),this.question=t||new d("Missing question")}return a(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||l)(r.Nb(i.a))},l.\u0275cmp=r.Hb({type:l,selectors:[["ng-component"]],decls:10,vars:5,consts:[["mat-dialog-title","",1,"modal-title"],["mat-dialog-content","",1,"modal-body"],[3,"innerHTML",4,"ngIf"],["mat-dialog-close","",1,"btn","btn-primary","btn-sm","mr-2"],[1,"btn","btn-primary","btn-sm",3,"mat-dialog-close"],[3,"innerHTML"]],template:function(e,t){1&e&&(r.Tb(0,"h4",0),r.Dc(1),r.Sb(),r.Tb(2,"div",1),r.Bc(3,o,1,1,"div",2),r.Sb(),r.Ob(4,"hr"),r.Tb(5,"div"),r.Tb(6,"button",3),r.Dc(7),r.Sb(),r.Tb(8,"button",4),r.Dc(9),r.Sb(),r.Sb()),2&e&&(r.Bb(1),r.Fc("",t.question.question," "),r.Bb(2),r.jc("ngIf",t.question.details),r.Bb(4),r.Ec(t.question.cancelLabel),r.Bb(1),r.jc("mat-dialog-close",!0),r.Bb(1),r.Ec(t.question.okLabel))},directives:[i.h,i.e,c.m,i.d],encapsulation:2}),l),f=((u=function(){function e(t){s(this,e),this.dialogs=t}return a(e,[{key:"confirm",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Cancel",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"OK",r=new d(e,t,n,i);return this.dialogs.open(b,{data:r,autoFocus:!1}).afterClosed()}}]),e}()).\u0275fac=function(e){return new(e||u)(r.Xb(i.b))},u.\u0275prov=r.Jb({token:u,factory:u.\u0275fac,providedIn:"root"}),u)},GVyA:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("fXoL"),r=n("RtrU"),c=n("qnP+"),o=n("6tuW"),a=n("BMm9"),u=n("tyNb"),l=function(){var e=function e(t,n,i,r,c){s(this,e),this.experimentService=t,this.currentExperiment=n,this.feedback=i,this.titleSetter=r,this.router=c};return e.\u0275fac=function(t){return new(t||e)(i.Xb(r.a),i.Xb(c.a),i.Xb(o.a),i.Xb(a.a),i.Xb(u.c))},e.\u0275prov=i.Jb({token:e,factory:e.\u0275fac}),e}()},TPWj:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(t){s(this,e),this.validator=t,this.errors=void 0}return a(e,[{key:"triggerValidation",value:function(){var e=this.validate(this.getModel());return e?(this.showErrors(e),!1):(this.clearErrors(),!0)}},{key:"clearErrors",value:function(){this.errors=void 0}},{key:"showErrors",value:function(e){this.errors=e}},{key:"validate",value:function(e){if(this.validator){var t=this.validator.validate(e);return 0===t.length?null:t}return null}}]),e}()},YiFe:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("ofXK"),r=n("3Pt+"),c=n("fXoL"),o=function(){var e=function e(){s(this,e)};return e.\u0275mod=c.Lb({type:e}),e.\u0275inj=c.Kb({factory:function(t){return new(t||e)},providers:[],imports:[[i.c,r.k]]}),e}()},eLum:function(n,r,o){"use strict";o.r(r),o.d(r,"ExperimentModule",(function(){return Ti}));var u=o("ofXK"),l=o("tyNb"),d=o("pLZG"),b=o("lJxs"),f=o("qnP+"),m=o("GVyA"),h=o("fXoL"),p=o("RtrU"),v=o("vejM"),g=o("6tuW"),y=o("ZMwR"),S=o("9+85");function T(e,t){if(1&e&&(h.Tb(0,"div",2),h.Tb(1,"strong"),h.Dc(2,"Open Access: "),h.Sb(),h.Dc(3," under "),h.Tb(4,"strong"),h.Dc(5),h.Sb(),h.Dc(6," license "),h.Sb()),2&e){var n=h.dc(2);h.Bb(5),h.Ec(n.model.features.licence)}}function D(e,t){if(1&e&&(h.Tb(0,"span"),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.Bb(1),h.Fc("",n.name,", ")}}function k(e,t){if(1&e&&(h.Tb(0,"div",2),h.Tb(1,"strong"),h.Dc(2,"Authors: "),h.Sb(),h.Bc(3,D,2,1,"span",5),h.Sb()),2&e){var n=h.dc(2);h.Bb(3),h.jc("ngForOf",n.model.contributionDesc.authors)}}function B(e,t){if(1&e&&(h.Tb(0,"div",1),h.Tb(1,"div",2),h.Tb(2,"strong"),h.Dc(3,"Purpose: "),h.Sb(),h.Dc(4),h.Sb(),h.Bc(5,T,7,1,"div",3),h.Bc(6,k,4,1,"div",3),h.Tb(7,"div",4),h.Tb(8,"strong"),h.Dc(9,"Data category: "),h.Sb(),h.Dc(10),h.Sb(),h.Sb()),2&e){var n=h.dc();h.Bb(4),h.Fc(" ",n.model.generalDesc.purpose," "),h.Bb(1),h.jc("ngIf",n.model.features.isOpenAccess),h.Bb(1),h.jc("ngIf",n.model.contributionDesc.authors),h.Bb(4),h.Fc(" ",null==n.model.dataCategory?null:n.model.dataCategory.longName," ")}}var w,j=((w=function e(){s(this,e)}).\u0275fac=function(e){return new(e||w)},w.\u0275cmp=h.Hb({type:w,selectors:[["bd2-experiment-basic-info-view"]],inputs:{model:"model"},decls:1,vars:1,consts:[["class","summary-box",4,"ngIf"],[1,"summary-box"],[1,"item"],["class","item",4,"ngIf"],[1,"item","item-last"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&h.Bc(0,B,11,4,"div",0),2&e&&h.jc("ngIf",t.model)},directives:[u.m,u.l],encapsulation:2}),w),F=function(){return["edit"]},I=function(){return{exact:!0}};function x(e,t){1&e&&(h.Tb(0,"a",6),h.Dc(1,"Edit"),h.Sb()),2&e&&h.jc("routerLink",h.lc(2,F))("routerLinkActiveOptions",h.lc(3,I))}var M=function(){return[".","data","view","ts"]};function O(e,t){1&e&&(h.Tb(0,"a",6),h.Dc(1,"Show data"),h.Sb()),2&e&&h.jc("routerLink",h.lc(2,M))("routerLinkActiveOptions",h.lc(3,I))}var C=function(){return[".","data","view","heatmap"]};function E(e,t){1&e&&(h.Tb(0,"a",6),h.Dc(1,"Heatmap"),h.Sb()),2&e&&h.jc("routerLink",h.lc(2,C))("routerLinkActiveOptions",h.lc(3,I))}var A=function(){return["ppa/new"]};function q(e,t){1&e&&(h.Tb(0,"a",6),h.Dc(1,"Period analysis"),h.Sb()),2&e&&h.jc("routerLink",h.lc(2,A))("routerLinkActiveOptions",h.lc(3,I))}var N=function(){return["ppa"]},L=function(){return{exact:!1}};function P(e,t){1&e&&(h.Tb(0,"a",6),h.Dc(1,"Period analysis"),h.Sb()),2&e&&h.jc("routerLink",h.lc(2,N))("routerLinkActiveOptions",h.lc(3,L))}var U=function(){return["rhythmicity"]};function R(e,t){1&e&&(h.Tb(0,"a",6),h.Dc(1,"Rhythmicity"),h.Sb()),2&e&&h.jc("routerLink",h.lc(2,U))("routerLinkActiveOptions",h.lc(3,L))}var Z=function(){return[".","data","ts-import"]};function _(e,t){if(1&e&&(h.Tb(0,"a",6),h.Dc(1),h.Sb()),2&e){var n=h.dc(2);h.jc("routerLink",h.lc(3,Z))("routerLinkActiveOptions",h.lc(4,I)),h.Bb(1),h.Fc(" ",n.experiment.features.hasTSData?"Replace data":"Import data","")}}var W=function(){return["publish"]};function G(e,t){1&e&&(h.Tb(0,"a",6),h.Tb(1,"i",8),h.Dc(2,"lock_open"),h.Sb(),h.Sb()),2&e&&h.jc("routerLink",h.lc(2,W))("routerLinkActiveOptions",h.lc(3,I))}var z=function(){return["/experiments"]},V=function(){return["."]},H=function(){return["file"]};function $(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div",1),h.Tb(1,"nav",2),h.Tb(2,"a",3),h.Tb(3,"i",4),h.Dc(4,"fast_rewind"),h.Sb(),h.Sb(),h.Tb(5,"a",5),h.Zb("click",(function(){return h.sc(n),h.dc().back()})),h.Tb(6,"i",4),h.Dc(7,"arrow_left"),h.Sb(),h.Sb(),h.Tb(8,"a",5),h.Zb("click",(function(){return h.sc(n),h.dc().refresh()})),h.Tb(9,"i",4),h.Dc(10,"refresh"),h.Sb(),h.Sb(),h.Tb(11,"a",6),h.Dc(12,"Overview"),h.Sb(),h.Bc(13,x,2,4,"a",7),h.Bc(14,O,2,4,"a",7),h.Bc(15,E,2,4,"a",7),h.Bc(16,q,2,4,"a",7),h.Bc(17,P,2,4,"a",7),h.Bc(18,R,2,4,"a",7),h.Bc(19,_,2,5,"a",7),h.Tb(20,"a",6),h.Dc(21,"Files"),h.Sb(),h.Bc(22,G,3,4,"a",7),h.Sb(),h.Sb()}if(2&e){var i=h.dc();h.Bb(2),h.jc("routerLink",h.lc(13,z)),h.Bb(9),h.jc("routerLink",h.lc(14,V))("routerLinkActiveOptions",h.lc(15,I)),h.Bb(2),h.jc("ngIf",i.experiment.security.canWrite),h.Bb(1),h.jc("ngIf",i.experiment.features.hasTSData),h.Bb(1),h.jc("ngIf",i.experiment.features.hasTSData),h.Bb(1),h.jc("ngIf",i.experiment.security.canWrite&&i.experiment.features.hasTSData&&!i.experiment.features.hasPPAJobs),h.Bb(1),h.jc("ngIf",i.experiment.features.hasPPAJobs),h.Bb(1),h.jc("ngIf",i.experiment.security.canWrite&&i.experiment.features.hasTSData||i.experiment.features.hasRhythmicityJobs),h.Bb(1),h.jc("ngIf",i.experiment.security.canWrite),h.Bb(1),h.jc("routerLink",h.lc(16,H))("routerLinkActiveOptions",h.lc(17,I)),h.Bb(2),h.jc("ngIf",i.experiment.security.isOwner||i.experiment.security.isSuperOwner)}}var X,J=((X=function(){function e(){s(this,e),this.onRefresh=new h.o}return a(e,[{key:"refresh",value:function(){this.onRefresh.emit(!0)}},{key:"back",value:function(){window.history.back()}}]),e}()).\u0275fac=function(e){return new(e||X)},X.\u0275cmp=h.Hb({type:X,selectors:[["bd2-experiment-navigation"]],inputs:{experiment:"experiment"},outputs:{onRefresh:"onRefresh"},features:[h.Ab([])],decls:1,vars:1,consts:[["style","margin-bottom: 2em;",4,"ngIf"],[2,"margin-bottom","2em"],[1,"secondary"],[3,"routerLink"],[1,"material-icons","bd-icon"],["role","button",1,"shade",3,"click"],["routerLinkActive","active",3,"routerLink","routerLinkActiveOptions"],["routerLinkActive","active",3,"routerLink","routerLinkActiveOptions",4,"ngIf"],[1,"material-icons","bd-icon",2,"color","green"]],template:function(e,t){1&e&&h.Bc(0,$,23,18,"div",0),2&e&&h.jc("ngIf",t.experiment)},directives:[u.m,l.e,l.d],encapsulation:2}),X);function K(e,t){1&e&&(h.Tb(0,"i",7),h.Dc(1,"lock_open"),h.Sb())}function Y(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Tb(1,"div",1),h.Tb(2,"div",2),h.Tb(3,"h3"),h.Bc(4,K,2,0,"i",3),h.Dc(5),h.Ob(6,"br"),h.Tb(7,"small"),h.Dc(8),h.Sb(),h.Sb(),h.Sb(),h.Tb(9,"div",4),h.Ob(10,"bd2-experiment-basic-info-view",5),h.Sb(),h.Sb(),h.Tb(11,"bd2-experiment-navigation",6),h.Zb("onRefresh",(function(){return h.sc(n),h.dc().refresh()})),h.Sb(),h.Sb()}if(2&e){var i=h.dc();h.Bb(4),h.jc("ngIf",i.model.features.isOpenAccess),h.Bb(1),h.Fc(" Experiment: ",i.model.id,""),h.Bb(3),h.Ec(i.model.name),h.Bb(2),h.jc("model",i.model),h.Bb(1),h.jc("experiment",i.model)}}function Q(e,t){1&e&&(h.Tb(0,"div"),h.Dc(1," ... loading experiment "),h.Tb(2,"p"),h.Dc(3,"If just logged in try to refresh the window if the experiment is not loading."),h.Sb(),h.Sb())}function ee(e,t){1&e&&(h.Tb(0,"div"),h.Tb(1,"h4"),h.Dc(2,"You don't have sufficient permissions to see the experiment"),h.Sb(),h.Tb(3,"p"),h.Dc(4,"Try to login"),h.Sb(),h.Sb())}var te,ne=((te=function(){function e(t,n,i,r,c,o,a,u){s(this,e),this.experimentService=t,this.RDMSocial=n,this.currentExperiment=i,this.feedback=r,this.analytics=c,this.route=o,this.router=a,this.dialogs=u,this.isUnauthorised=!1}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.expSubscription=this.currentExperiment.experiment().pipe(Object(d.a)((function(e){return!!e}))).subscribe((function(t){e.model=t,e.analytics.experimentView(t.id),e.RDMSocial.shouldShowMeasurementWarning(t).then((function(t){t&&e.showMetadataWarning()}))}),(function(t){return e.feedback.error(t)}),(function(){return console.log("currentExperimentStream completed")})),this.paramsSubscription=this.route.paramMap.pipe(Object(b.a)((function(e){return e.get("id")})),Object(d.a)((function(e){return!!e}))).subscribe((function(t){return e.loadExperiment(+t)}))}},{key:"ngOnDestroy",value:function(){this.paramsSubscription&&this.paramsSubscription.unsubscribe(),this.expSubscription&&this.expSubscription.unsubscribe(),this.currentExperiment&&this.currentExperiment.close()}},{key:"refresh",value:function(){this.model&&this.loadExperiment(this.model.id)}},{key:"loadExperiment",value:function(e){var t=this;this.experimentService.getExperiment(e).then((function(e){t.currentExperiment.push(e),t.isUnauthorised=!1})).catch((function(e){t.isUnauthorised=e.isUnauthorised,t.feedback.error(e)}))}},{key:"handleWarningResponse",value:function(e){console.log("Dialog: "+e)}},{key:"showMetadataWarning",value:function(){var e=this;this.dialogs.confirm("Metadata reminder","\n        <p>\n        Please add measurements details, like technique, equipment and short description.\n        </p>\n        <p>\n        It will improve the metadata quality and it will help you when searching for the data.\n        </p>\n","Not now").subscribe((function(t){e.RDMSocial.registerMeasurementWarning(e.model),t&&e.router.navigate(["edit"],{relativeTo:e.route,fragment:"MeasurementSection"})}))}}]),e}()).\u0275fac=function(e){return new(e||te)(h.Nb(p.a),h.Nb(v.a),h.Nb(f.a),h.Nb(g.a),h.Nb(y.a),h.Nb(l.a),h.Nb(l.c),h.Nb(S.a))},te.\u0275cmp=h.Hb({type:te,selectors:[["ng-component"]],features:[h.Ab([f.a,m.a])],decls:5,vars:3,consts:[[4,"ngIf"],[1,"card","asset-card"],[1,"card-header"],["class","material-icons bd-icon","style","color: green; font-size: 1.5em;",4,"ngIf"],[1,"card-body"],[3,"model"],[3,"experiment","onRefresh"],[1,"material-icons","bd-icon",2,"color","green","font-size","1.5em"]],template:function(e,t){1&e&&(h.Tb(0,"div"),h.Bc(1,Y,12,5,"div",0),h.Bc(2,Q,4,0,"div",0),h.Bc(3,ee,5,0,"div",0),h.Ob(4,"router-outlet"),h.Sb()),2&e&&(h.Bb(1),h.jc("ngIf",t.model),h.Bb(1),h.jc("ngIf",!t.model&&!t.isUnauthorised),h.Bb(1),h.jc("ngIf",!t.model&&t.isUnauthorised))},directives:[u.m,l.g,j,J],encapsulation:2}),te),ie=o("yYXI");function re(e,t){if(1&e&&(h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"strong"),h.Dc(3,"Description"),h.Sb(),h.Tb(4,"div"),h.Dc(5),h.Sb(),h.Sb()),2&e){var n=h.dc(2);h.Bb(5),h.Ec(n.model.description)}}function ce(e,t){if(1&e&&(h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"strong"),h.Dc(3,"Comments"),h.Sb(),h.Tb(4,"div"),h.Dc(5),h.Sb(),h.Sb()),2&e){var n=h.dc(2);h.Bb(5),h.Ec(n.model.comments)}}function oe(e,t){if(1&e&&(h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"strong"),h.Dc(3,"Execution date"),h.Sb(),h.Tb(4,"div"),h.Dc(5),h.ec(6,"date"),h.Sb(),h.Sb()),2&e){var n=h.dc(2);h.Bb(5),h.Ec(h.fc(6,1,n.model.executionDate.date))}}function ae(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"h4"),h.Dc(2),h.Sb(),h.Tb(3,"div"),h.Ob(4,"hr"),h.Tb(5,"strong"),h.Dc(6,"Purpose/Hypothesis"),h.Sb(),h.Tb(7,"div"),h.Dc(8),h.Sb(),h.Sb(),h.Bc(9,re,6,1,"div",0),h.Bc(10,ce,6,1,"div",0),h.Bc(11,oe,7,3,"div",0),h.Sb()),2&e){var n=h.dc();h.Bb(2),h.Ec(n.model.name),h.Bb(6),h.Ec(n.model.purpose),h.Bb(1),h.jc("ngIf",n.model.description),h.Bb(1),h.jc("ngIf",n.model.comments),h.Bb(1),h.jc("ngIf",n.model.executionDate)}}var se,ue=((se=function e(){s(this,e)}).\u0275fac=function(e){return new(e||se)},se.\u0275cmp=h.Hb({type:se,selectors:[["bd2-general-desc-view"]],inputs:{model:"model"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&h.Bc(0,ae,12,5,"div",0),2&e&&h.jc("ngIf",t.model)},directives:[u.m],pipes:[u.e],encapsulation:2}),se);function le(e,t){if(1&e&&(h.Tb(0,"span"),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.Bb(1),h.Fc("",n.name,", ")}}function de(e,t){if(1&e&&(h.Tb(0,"h4"),h.Bc(1,le,2,1,"span",1),h.Sb()),2&e){var n=h.dc(2);h.Bb(1),h.jc("ngForOf",n.model.authors)}}function be(e,t){if(1&e&&(h.Tb(0,"span"),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.Bb(1),h.Fc("",n.name,", ")}}function fe(e,t){if(1&e&&(h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"strong"),h.Dc(3,"Data curators: "),h.Sb(),h.Bc(4,be,2,1,"span",1),h.Sb()),2&e){var n=h.dc(2);h.Bb(4),h.jc("ngForOf",n.model.curators)}}function me(e,t){if(1&e&&(h.Tb(0,"span"),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.Bb(1),h.Fc("",n.name,", ")}}function he(e,t){if(1&e&&(h.Tb(0,"span"),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.Bb(1),h.Fc("",n.name,", ")}}function pe(e,t){if(1&e&&(h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"strong"),h.Dc(3,"Institutions/Fundings: "),h.Sb(),h.Bc(4,me,2,1,"span",1),h.Bc(5,he,2,1,"span",1),h.Sb()),2&e){var n=h.dc(2);h.Bb(4),h.jc("ngForOf",n.model.institutions),h.Bb(1),h.jc("ngForOf",n.model.fundings)}}function ve(e,t){if(1&e&&(h.Tb(0,"div"),h.Bc(1,de,2,1,"h4",0),h.Bc(2,fe,5,1,"div",0),h.Bc(3,pe,6,2,"div",0),h.Sb()),2&e){var n=h.dc();h.Bb(1),h.jc("ngIf",n.model.authors.length>0),h.Bb(1),h.jc("ngIf",n.model.curators.length>0),h.Bb(1),h.jc("ngIf",n.model.institutions.length>0||n.model.fundings.length>0)}}var ge,ye=((ge=function e(){s(this,e)}).\u0275fac=function(e){return new(e||ge)},ge.\u0275cmp=h.Hb({type:ge,selectors:[["bd2-contr-desc-view"]],inputs:{model:"model"},outputs:{onAccepted:"onAccepted",onCancelled:"onCancelled"},decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&h.Bc(0,ve,4,3,"div",0),2&e&&h.jc("ngIf",t.model)},directives:[u.m,u.l],encapsulation:2}),ge);function Se(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"p"),h.Tb(2,"strong"),h.Dc(3,"Species: "),h.Sb(),h.Dc(4),h.Sb(),h.Tb(5,"p"),h.Tb(6,"strong"),h.Dc(7,"Data category: "),h.Sb(),h.Dc(8),h.Sb(),h.Sb()),2&e){var n=h.dc();h.Bb(4),h.Fc(" ",n.model.species," "),h.Bb(4),h.Fc(" ",null==n.model.dataCategory?null:n.model.dataCategory.longName," ")}}var Te,De=((Te=function e(){s(this,e)}).\u0275fac=function(e){return new(e||Te)},Te.\u0275cmp=h.Hb({type:Te,selectors:[["bd2-simple-bio-desc-view"]],inputs:{model:"model"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&h.Bc(0,Se,9,2,"div",0),2&e&&h.jc("ngIf",t.model)},directives:[u.m],encapsulation:2}),Te);function ke(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"strong"),h.Dc(2,"Details"),h.Sb(),h.Tb(3,"div"),h.Dc(4),h.Sb(),h.Sb()),2&e){var n=h.dc(3);h.Bb(4),h.Ec(n.model.description)}}function Be(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"strong"),h.Dc(2,"Technique:"),h.Sb(),h.Dc(3),h.Bc(4,ke,5,1,"div",0),h.Sb()),2&e){var n=h.dc(2);h.Bb(3),h.Gc(" ",n.model.technique," ",n.model.equipment?"("+n.model.equipment+")":""," "),h.Bb(1),h.jc("ngIf",n.model.description)}}function we(e,t){1&e&&(h.Tb(0,"div"),h.Dc(1," Unspecified "),h.Sb())}function je(e,t){if(1&e&&(h.Tb(0,"div"),h.Bc(1,Be,5,3,"div",0),h.Bc(2,we,2,0,"div",0),h.Sb()),2&e){var n=h.dc();h.Bb(1),h.jc("ngIf",n.model.technique),h.Bb(1),h.jc("ngIf",!n.model.technique)}}var Fe,Ie=((Fe=function(){function e(){s(this,e)}return a(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Fe)},Fe.\u0275cmp=h.Hb({type:Fe,selectors:[["bd2-measurement-desc-view"]],inputs:{model:"model"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&h.Bc(0,je,3,2,"div",0),2&e&&h.jc("ngIf",t.model)},directives:[u.m],encapsulation:2}),Fe);function xe(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"h3"),h.Dc(2,"Overview of experimental details"),h.Sb(),h.Tb(3,"div",1),h.Tb(4,"div",2),h.Dc(5,"General description"),h.Sb(),h.Tb(6,"div",3),h.Ob(7,"bd2-general-desc-view",4),h.Sb(),h.Sb(),h.Tb(8,"div",1),h.Tb(9,"div",2),h.Dc(10,"Contributions"),h.Sb(),h.Tb(11,"div",3),h.Ob(12,"bd2-contr-desc-view",4),h.Sb(),h.Sb(),h.Tb(13,"div",1),h.Tb(14,"div",2),h.Dc(15,"Biological details"),h.Sb(),h.Tb(16,"div",3),h.Ob(17,"bd2-simple-bio-desc-view",4),h.Sb(),h.Sb(),h.Tb(18,"div",1),h.Tb(19,"div",2),h.Dc(20,"Measurement details"),h.Sb(),h.Tb(21,"div",3),h.Ob(22,"bd2-measurement-desc-view",4),h.Sb(),h.Sb(),h.Sb()),2&e){var n=h.dc();h.Bb(7),h.jc("model",n.assay.generalDesc),h.Bb(5),h.jc("model",n.assay.contributionDesc),h.Bb(5),h.jc("model",n.assay),h.Bb(5),h.jc("model",n.assay.experimentalDetails.measurementDesc)}}var Me,Oe,Ce=((Oe=function(e){t(r,e);var n=i(r);function r(e){return s(this,r),n.call(this,e)}return r}(ie.a)).\u0275fac=function(e){return new(e||Oe)(h.Nb(m.a))},Oe.\u0275cmp=h.Hb({type:Oe,selectors:[["ng-component"]],features:[h.Ab([]),h.yb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"card","mb-2"],[1,"card-header"],[1,"card-body"],[3,"model"]],template:function(e,t){1&e&&h.Bc(0,xe,23,4,"div",0),2&e&&h.jc("ngIf",t.assay)},directives:[u.m,ue,ye,De,Ie],encapsulation:2}),Oe),Ee=function(){var e=function(){function e(){s(this,e)}return a(e,[{key:"validate",value:function(e){var t=[];return e?(e.name&&""!=e.name.trim()||t.push("Non empty name is required"),e.purpose&&""!=e.purpose.trim()||t.push("Purpose is required"),e.purpose&&e.purpose.trim().length<20&&t.push("Purpose is too short"),t):["General description cannot be empty"]}},{key:"GeneralDescValidator",value:function(){}}]),e}();return e.INSTANCE=new e,e}(),Ae=function(){var e=function(){function e(){s(this,e)}return a(e,[{key:"validate",value:function(e){return e?e.authors.length<1?["At least one author is required"]:[]:["Contribution cannot be empty"]}},{key:"ContributionDescValidator",value:function(){}}]),e}();return e.INSTANCE=new e,e}(),qe=function(){var e=function(){function e(){s(this,e)}return a(e,[{key:"validate",value:function(e){var t=[];return e?(e.species&&""!=e.species.trim()||t.push("Non empty species is required"),e.dataCategory&&"NONE"!=e.dataCategory.name||t.push("Data category is required"),t):["Cannot validate null object"]}}]),e}();return e.INSTANCE=new e,e}(),Ne=((Me=function(){function e(){s(this,e),this.generalV=Ee.INSTANCE,this.contribV=Ae.INSTANCE,this.bioV=qe.INSTANCE}return a(e,[{key:"validate",value:function(e){var t=[];return t=t.concat(this.generalV.validate(e.generalDesc),this.contribV.validate(e.contributionDesc),this.bioV.validate(e))}}]),e}()).INSTANCE=new Me,Me),Le=o("TPWj"),Pe=function(e){t(r,e);var n=i(r);function r(e){var t;return s(this,r),(t=n.call(this,e)).onAccepted=new h.o,t.onCancelled=new h.o,t}return a(r,[{key:"cancel",value:function(){this.clearErrors(),this.onCancelled.emit(!0)}},{key:"save",value:function(){this._orgModel&&this.triggerValidation()&&(this._orgModel.setAll(this._model),this.onAccepted.emit(this._orgModel))}},{key:"getModel",value:function(){return this._model}},{key:"setModel",value:function(e){this._orgModel=e,e&&(this._model=e.clone())}}]),r}(Le.a),Ue=function(){function e(t){s(this,e),this.text=t||"",this.nextPosition=0,this.limit=this.text.length,this.currentWorld=""}return a(e,[{key:"next",value:function(){if(this.nextPosition>=this.limit)return"";for(;this.nextPosition<this.limit;this.nextPosition++){var e=this.text.charAt(this.nextPosition);if(" "===e||"\t"===e||"\n"===e){if(this.currentWorld){var t=this.currentWorld.toLowerCase();return this.currentWorld="",t}}else{if("."===e||","===e||":"===e||"'"===e)continue;this.currentWorld=this.currentWorld+e}}return this.currentWorld.toLowerCase()}}]),e}(),Re=function(){var e=function(){function e(){s(this,e)}return a(e,null,[{key:"initBannedWords",value:function(){var e=new Set;return e.add("sensible"),e.add("description"),e.add("with"),e.add("more"),e.add("words"),e.add("required"),e.add("purpose"),e.add("hypothesis"),e}},{key:"removeLetterChain",value:function(e){if(!e)return"";for(var t=e.length,n=e.charAt(0),i=e.charAt(0),r=1;r<t;r++){var c=e.charAt(r);c!==i&&(i=c,n+=c)}return n}},{key:"removePairChain",value:function(e){if(!e)return"";if(e.length<4)return e;for(var t=e.length-1,n=e.substring(0,2),i=n,r=2;r<t;){var c=e.substring(r,r+2);c!==i?(i=i.charAt(1)+c.charAt(0),n+=c.charAt(0),r++):r+=2}return r==t&&(n+=e.charAt(e.length-1)),n}},{key:"simplifyWorld",value:function(t){var n=e.removeLetterChain(t);return n=e.removePairChain(n)}},{key:"countDistinctCharacters",value:function(e){if(!e)return 0;for(var t=new Set,n=0;n<e.length;n++)t.add(e.charAt(n));return t.size}},{key:"isSensibleWorld",value:function(t){if(!t)return!1;if(t.length>6&&e.countDistinctCharacters(t)<=4)return!1;if(e.bannedWords.has(t))return!1;var n=e.simplifyWorld(t),i=4;return 4===t.length&&(i=3),t.length>10&&(i=.6*t.length),n.length>=i}}]),e}();return e.bannedWords=e.initBannedWords(),e}(),Ze=function(){function e(t){s(this,e),this.minWords=5,this.previouslyValid="",this.minWords=t||5}return a(e,[{key:"validateText",value:function(e){if(e&&this.previouslyValid&&e.startsWith(this.previouslyValid))return null;var t=this.countWords(e,this.minWords);return t<this.minWords?{minWords:"required "+this.minWords+" found: "+t}:(this.previouslyValid=e,null)}},{key:"countWords",value:function(e,t){for(var n=new Ue(e),i=new Set,r=n.next();r&&i.size<t;r=n.next())Re.isSensibleWorld(r)&&i.add(r);return i.size}}]),e}(),_e=o("B9cw"),We=o("3Pt+"),Ge=o("kmnG"),ze=o("qFsG"),Ve=o("iadO");function He(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Tb(1,"form",null,1),h.Tb(3,"div",2),h.Tb(4,"mat-form-field",3),h.Tb(5,"mat-label",4),h.Dc(6,"Name"),h.Sb(),h.Tb(7,"input",5,6),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc().model.name=e})),h.Sb(),h.Tb(9,"mat-hint"),h.Dc(10,"Good name hints the data content"),h.Sb(),h.Tb(11,"mat-error"),h.Dc(12,"Descriptive name is required"),h.Sb(),h.Sb(),h.Sb(),h.Tb(13,"div",2),h.Tb(14,"mat-form-field",3),h.Tb(15,"mat-label",7),h.Dc(16,"Purpose/Hypothesis"),h.Sb(),h.Tb(17,"textarea",8,9),h.Zb("input",(function(){return h.sc(n),h.dc().checkPurpose()}))("ngModelChange",(function(e){return h.sc(n),h.dc().model.purpose=e})),h.Dc(19,"                   "),h.Sb(),h.Tb(20,"mat-hint"),h.Dc(21,"Sensible description with more than few words is required"),h.Sb(),h.Sb(),h.Sb(),h.Tb(22,"div",2),h.Tb(23,"mat-form-field",3),h.Tb(24,"mat-label",10),h.Dc(25,"Description"),h.Sb(),h.Tb(26,"textarea",11,12),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc().model.description=e})),h.Dc(28,"                 "),h.Sb(),h.Sb(),h.Sb(),h.Tb(29,"div",2),h.Tb(30,"mat-form-field",3),h.Tb(31,"mat-label",13),h.Dc(32,"Comments"),h.Sb(),h.Tb(33,"textarea",14,15),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc().model.comments=e})),h.Dc(35,"                "),h.Sb(),h.Sb(),h.Sb(),h.Tb(36,"div",2),h.Tb(37,"mat-form-field"),h.Tb(38,"input",16,17),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc().executionDate=e})),h.Sb(),h.Ob(40,"mat-datepicker-toggle",18),h.Ob(41,"mat-datepicker",null,19),h.Tb(43,"mat-error"),h.Dc(44,"Date is required and cannot be much in the future"),h.Sb(),h.Sb(),h.Ob(45,"br"),h.Sb(),h.Tb(46,"button",20),h.Zb("click",(function(){return h.sc(n),h.dc().save()})),h.Dc(47),h.Sb(),h.Tb(48,"button",21),h.Zb("click",(function(){return h.sc(n),h.dc().cancel()})),h.Dc(49,"Cancel"),h.Sb(),h.Sb(),h.Sb()}if(2&e){var i=h.qc(2),r=h.qc(18),c=h.qc(42),o=h.dc();h.Bb(7),h.jc("ngModel",o.model.name),h.Bb(10),h.jc("ngModel",o.model.purpose),h.Bb(3),h.yc("color",o.sufficientPurpose||r.pristine?"":"red"),h.Bb(6),h.jc("ngModel",o.model.description),h.Bb(7),h.jc("ngModel",o.model.comments),h.Bb(5),h.jc("matDatepicker",c)("ngModel",o.executionDate)("max",o.maxDate)("min",o.minDate),h.Bb(2),h.jc("for",c),h.Bb(6),h.jc("disabled",o.blocked||!i.form.valid||!o.sufficientPurpose),h.Bb(1),h.Ec(o.okLabel)}}var $e,Xe=(($e=function(n){t(o,n);var r=i(o);function o(){var e;return s(this,o),(e=r.call(this,Ee.INSTANCE)).okLabel="Save",e.sufficientPurpose=!1,e.purposeWorldValidator=new Ze(5),e.maxDate=new Date,e.maxDate.setDate(e.maxDate.getDate()+21),e.minDate=new Date,e.minDate.setFullYear(e.minDate.getFullYear()-10),e}return a(o,[{key:"checkPurpose",value:function(){this.sufficientPurpose=null===this.purposeWorldValidator.validateText(this.model.purpose)}},{key:"save",value:function(){this.model.executionDate=_e.a.fromDate(this.executionDate),e(c(o.prototype),"save",this).call(this)}},{key:"model",get:function(){return this._model},set:function(e){this.setModel(e),this.executionDate=e.executionDate.date,this.checkPurpose()}}]),o}(Pe)).\u0275fac=function(e){return new(e||$e)},$e.\u0275cmp=h.Hb({type:$e,selectors:[["bd2-general-desc-form"]],inputs:{okLabel:"okLabel",blocked:"blocked",model:"model"},outputs:{onAccepted:"onAccepted",onCancelled:"onCancelled"},features:[h.yb],decls:1,vars:1,consts:[[4,"ngIf"],["gDescForm","ngForm"],[1,"form-group"],[1,"w-100"],["for","gName"],["matInput","","id","gName","maxlength","100","minlength","6","name","gName","placeholder","e.g. Testing robustness in low light (E12)","required","","type","text",1,"",3,"ngModel","ngModelChange"],["gName","ngModel"],["for","gPurpose"],["matInput","","id","gPurpose","minlength","55","name","gPurpose","placeholder","Describe the main aim of the experiment. What you tried to achieve, test, verify, on what kind of samples.","required","","rows","4","type","text",1,"",3,"ngModel","input","ngModelChange"],["gPurpose","ngModel"],["for","gDescription"],["matInput","","id","gDescription","name","gDescription","placeholder","Describe how the experiment was conducted, what environmental conditions, sampling procedure.\nFor example: seedlings were exposed to short day light regime (LD 6:18) at two temperatures 15 and 25. Samples where harvested every 4 hours for 3 days and the genes levels measured with RT PCR","rows","5","type","text",1,"",3,"ngModel","ngModelChange"],["gDescription","ngModel"],["for","gComments"],["matInput","","id","gComments","name","gComments","placeholder","Optional remarks, for example technical issues during the experiment, discrepancies/simplifications of in the following sections","type","text",1,"",3,"ngModel","ngModelChange"],["gComments","ngModel"],["matInput","","name","executionDate","placeholder","Exp. execution date","required","",3,"matDatepicker","ngModel","max","min","ngModelChange"],["gDate","ngModel"],["matSuffix","",3,"for"],["picker",""],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["type","button",1,"btn","btn-outline-secondary",3,"click"]],template:function(e,t){1&e&&h.Bc(0,He,50,13,"div",0),2&e&&h.jc("ngIf",t.model)},directives:[u.m,We.D,We.r,We.s,Ge.c,Ge.g,ze.b,We.d,We.l,We.m,We.z,We.q,We.t,Ge.f,Ge.b,Ve.b,Ve.d,Ge.h,Ve.a],encapsulation:2}),$e),Je=o("kKfy"),Ke=o("RkHi"),Ye=o("cEDj"),Qe=o("BOp5"),et=o("Wp6s"),tt=o("A5z7"),nt=o("f0Cb"),it=o("NFeN"),rt=["persForm"],ct=["instForm"],ot=["fundForm"];function at(e,t){if(1&e&&(h.Tb(0,"li"),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.Bb(1),h.Ec(n)}}function st(e,t){if(1&e&&(h.Tb(0,"div",35),h.Tb(1,"ul",36),h.Bc(2,at,2,1,"li",37),h.Sb(),h.Sb()),2&e){var n=h.dc(2);h.Bb(2),h.jc("ngForOf",n.errors)}}function ut(e,t){1&e&&(h.Tb(0,"p"),h.Dc(1,"Please add an author"),h.Sb())}function lt(e,t){if(1&e){var n=h.Ub();h.Tb(0,"mat-chip",38),h.Zb("removed",(function(){h.sc(n);var e=t.$implicit;return h.dc(2).removeAuthor(e)})),h.Dc(1),h.Tb(2,"mat-icon",39),h.Dc(3,"cancel"),h.Sb(),h.Sb()}if(2&e){var i=t.$implicit;h.Bb(1),h.Fc(" ",i.name," ")}}function dt(e,t){if(1&e){var n=h.Ub();h.Tb(0,"mat-chip",38),h.Zb("removed",(function(){h.sc(n);var e=t.$implicit;return h.dc(3).removeCurator(e)})),h.Dc(1),h.Tb(2,"mat-icon",39),h.Dc(3,"cancel"),h.Sb(),h.Sb()}if(2&e){var i=t.$implicit;h.Bb(1),h.Fc(" ",i.name," ")}}function bt(e,t){if(1&e&&(h.Tb(0,"div",2),h.Tb(1,"label"),h.Tb(2,"strong"),h.Dc(3,"Data curators"),h.Sb(),h.Sb(),h.Tb(4,"mat-chip-list"),h.Bc(5,dt,4,1,"mat-chip",3),h.Sb(),h.Ob(6,"mat-divider",4),h.Sb()),2&e){var n=h.dc(2);h.Bb(5),h.jc("ngForOf",n.model.curators)}}function ft(e,t){1&e&&(h.Tb(0,"p"),h.Dc(1,"Please add an institution"),h.Sb())}function mt(e,t){if(1&e){var n=h.Ub();h.Tb(0,"mat-chip",38),h.Zb("removed",(function(){h.sc(n);var e=t.$implicit;return h.dc(2).removeInstitution(e)})),h.Dc(1),h.Tb(2,"mat-icon",39),h.Dc(3,"cancel"),h.Sb(),h.Sb()}if(2&e){var i=t.$implicit;h.Bb(1),h.Fc(" ",i.name," ")}}function ht(e,t){if(1&e){var n=h.Ub();h.Tb(0,"mat-chip",38),h.Zb("removed",(function(){h.sc(n);var e=t.$implicit;return h.dc(3).removeFunding(e)})),h.Dc(1),h.Tb(2,"mat-icon",39),h.Dc(3,"cancel"),h.Sb(),h.Sb()}if(2&e){var i=t.$implicit;h.Bb(1),h.Fc(" ",i.name," ")}}function pt(e,t){if(1&e&&(h.Tb(0,"div",2),h.Tb(1,"label"),h.Tb(2,"strong"),h.Dc(3,"Fundings"),h.Sb(),h.Sb(),h.Tb(4,"mat-chip-list"),h.Bc(5,ht,4,1,"mat-chip",3),h.Sb(),h.Ob(6,"mat-divider",4),h.Sb()),2&e){var n=h.dc(2);h.Bb(5),h.jc("ngForOf",n.model.fundings)}}function vt(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Bc(1,st,3,1,"div",1),h.Tb(2,"mat-card"),h.Tb(3,"mat-card-content"),h.Tb(4,"div",2),h.Tb(5,"label"),h.Tb(6,"strong"),h.Dc(7,"Authors"),h.Sb(),h.Sb(),h.Bc(8,ut,2,0,"p",0),h.Tb(9,"mat-chip-list"),h.Bc(10,lt,4,1,"mat-chip",3),h.Sb(),h.Ob(11,"mat-divider",4),h.Sb(),h.Bc(12,bt,7,1,"div",5),h.Tb(13,"form",6,7),h.Tb(15,"div",8),h.Tb(16,"mat-form-field"),h.Tb(17,"mat-label",9),h.Dc(18,"Name"),h.Sb(),h.Tb(19,"input",10,11),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc().firstName=e})),h.Sb(),h.Sb(),h.Sb(),h.Tb(21,"div",2),h.Tb(22,"mat-form-field"),h.Tb(23,"mat-label",12),h.Dc(24,"Surname"),h.Sb(),h.Tb(25,"input",13,14),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc().lastName=e})),h.Sb(),h.Sb(),h.Sb(),h.Tb(27,"button",15),h.Zb("click",(function(){return h.sc(n),h.dc().addAuthor()})),h.Dc(28,"New Author "),h.Sb(),h.Tb(29,"button",16),h.Zb("click",(function(){return h.sc(n),h.dc().addCurator()})),h.Dc(30,"New Curator "),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Ob(31,"mat-divider",17),h.Tb(32,"mat-card"),h.Tb(33,"mat-card-content"),h.Tb(34,"div",2),h.Tb(35,"label"),h.Tb(36,"strong"),h.Dc(37,"Institutions"),h.Sb(),h.Sb(),h.Bc(38,ft,2,0,"p",0),h.Tb(39,"mat-chip-list"),h.Bc(40,mt,4,1,"mat-chip",3),h.Sb(),h.Ob(41,"mat-divider",4),h.Sb(),h.Tb(42,"form",6,18),h.Tb(44,"div",2),h.Tb(45,"mat-form-field"),h.Tb(46,"mat-label",19),h.Dc(47,"Institution"),h.Sb(),h.Tb(48,"input",20,21),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc().institutionName=e})),h.Sb(),h.Sb(),h.Sb(),h.Tb(50,"button",22),h.Zb("click",(function(){return h.sc(n),h.dc().addInstitution()})),h.Dc(51," Add Institution "),h.Sb(),h.Ob(52,"mat-divider",23),h.Sb(),h.Bc(53,pt,7,1,"div",5),h.Tb(54,"form",6,24),h.Tb(56,"div",2),h.Tb(57,"mat-form-field",25),h.Tb(58,"mat-label",26),h.Dc(59,"Funder"),h.Sb(),h.Tb(60,"input",27,28),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc().funderName=e})),h.Sb(),h.Sb(),h.Sb(),h.Tb(62,"div",2),h.Tb(63,"mat-form-field"),h.Tb(64,"mat-label",29),h.Dc(65,"Grant"),h.Sb(),h.Tb(66,"input",30,31),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc().grantNr=e})),h.Sb(),h.Sb(),h.Sb(),h.Tb(68,"button",22),h.Zb("click",(function(){return h.sc(n),h.dc().addFunding()})),h.Dc(69," Add Funding "),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(70,"div",32),h.Tb(71,"button",33),h.Zb("click",(function(){return h.sc(n),h.dc().save()})),h.Dc(72),h.Sb(),h.Tb(73,"button",34),h.Zb("click",(function(){return h.sc(n),h.dc().cancel()})),h.Dc(74,"Cancel"),h.Sb(),h.Sb(),h.Sb()}if(2&e){var i=h.qc(14),r=h.qc(43),c=h.qc(55),o=h.dc();h.Bb(1),h.jc("ngIf",o.errors),h.Bb(7),h.jc("ngIf",!o.model.authors||o.model.authors.length<1),h.Bb(2),h.jc("ngForOf",o.model.authors),h.Bb(2),h.jc("ngIf",o.model.curators.length>0),h.Bb(7),h.jc("ngModel",o.firstName),h.Bb(6),h.jc("ngModel",o.lastName),h.Bb(2),h.jc("disabled",!i.form.valid),h.Bb(2),h.jc("disabled",!i.form.valid),h.Bb(9),h.jc("ngIf",!o.model.institutions||o.model.institutions.length<1),h.Bb(2),h.jc("ngForOf",o.model.institutions),h.Bb(8),h.jc("ngModel",o.institutionName),h.Bb(2),h.jc("disabled",!r.form.valid),h.Bb(3),h.jc("ngIf",o.model.fundings.length>0),h.Bb(7),h.jc("ngModel",o.funderName),h.Bb(6),h.jc("ngModel",o.grantNr),h.Bb(2),h.jc("disabled",!c.form.valid),h.Bb(3),h.jc("disabled",o.blocked||o.errors),h.Bb(1),h.Ec(o.okLabel)}}var gt,yt,St=((gt=function(e){t(r,e);var n=i(r);function r(){var e;return s(this,r),(e=n.call(this,Ae.INSTANCE)).okLabel="Save",e.blocked=!1,e}return a(r,[{key:"addAuthor",value:function(){var e=this.selectedPerson();e&&(this._model.authors.push(e),this.resetPerson(),this.triggerValidation())}},{key:"addCurator",value:function(){var e=this.selectedPerson();e&&(this._model.curators.push(e),this.resetPerson())}},{key:"removeAuthor",value:function(e){Object(Qe.b)(e,this._model.authors),this.triggerValidation()}},{key:"removeCurator",value:function(e){Object(Qe.b)(e,this._model.curators)}},{key:"addInstitution",value:function(){var e=this.selectedInstitution();if(e){if(this.hasInstitution(e,this._model))return;this._model.institutions.push(e),this.resetInstitution()}}},{key:"hasInstitution",value:function(e,t){return t.institutions.findIndex((function(t){return t.name===e.name}))>=0}},{key:"removeInstitution",value:function(e){Object(Qe.b)(e,this.model.institutions)}},{key:"addFunding",value:function(){var e=this.selectedFunding();if(e){if(this.hasFunding(e,this._model))return;this._model.fundings.push(e),this.resetFunding()}}},{key:"hasFunding",value:function(e,t){return t.fundings.findIndex((function(t){return t.name===e.name}))>=0}},{key:"removeFunding",value:function(e){Object(Qe.b)(e,this._model.fundings)}},{key:"resetPerson",value:function(){this.firstName=void 0,this.lastName=void 0,this.persForm.reset()}},{key:"selectedPerson",value:function(){return this.firstName&&this.lastName?new Ye.a(this.firstName,this.lastName):null}},{key:"resetInstitution",value:function(){this.institutionName=void 0,this.instForm.reset()}},{key:"selectedInstitution",value:function(){return this.institutionName?new Ke.a(this.institutionName):null}},{key:"resetFunding",value:function(){this.funderName=void 0,this.grantNr=void 0,this.fundForm.reset()}},{key:"selectedFunding",value:function(){if(this.funderName){var e=new Ke.a(this.funderName),t=new Je.a;return t.institution=e,t.grantNr=this.grantNr,t}return null}},{key:"model",get:function(){return this._model},set:function(e){this.setModel(e)}}]),r}(Pe)).\u0275fac=function(e){return new(e||gt)},gt.\u0275cmp=h.Hb({type:gt,selectors:[["bd2-contr-desc-form"]],viewQuery:function(e,t){var n;1&e&&(h.Ic(rt,!0),h.Ic(ct,!0),h.Ic(ot,!0)),2&e&&(h.pc(n=h.ac())&&(t.persForm=n.first),h.pc(n=h.ac())&&(t.instForm=n.first),h.pc(n=h.ac())&&(t.fundForm=n.first))},inputs:{okLabel:"okLabel",blocked:"blocked",model:"model"},outputs:{onAccepted:"onAccepted",onCancelled:"onCancelled"},features:[h.yb],decls:1,vars:1,consts:[[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"form-group"],[3,"removed",4,"ngFor","ngForOf"],["inset","",1,"mt-2"],["class","form-group",4,"ngIf"],[1,"form-inline"],["persForm","ngForm"],[1,"form-group","mr-1"],["for","pFirst"],["matInput","","id","pFirst","maxlength","100","minlength","2","name","pFirst","placeholder","e.g. John)","required","","type","text",3,"ngModel","ngModelChange"],["pFirst","ngModel"],["for","pLast"],["matInput","","id","pLast","maxlength","100","minlength","2","name","pLast","placeholder","e.g. Smith","required","","type","text",3,"ngModel","ngModelChange"],["pLast","ngModel"],["type","button",1,"btn","btn-primary","btn-sm","mr-1","ml-1",3,"disabled","click"],["type","button",1,"btn","btn-primary","btn-sm",3,"disabled","click"],[1,"mb-1"],["instForm","ngForm"],["for","iName"],["matInput","","id","iName","maxlength","100","minlength","3","name","iName","placeholder","e.g. University of Edinburgh","required","","type","text",1,"",3,"ngModel","ngModelChange"],["iName","ngModel"],["type","button",1,"btn","btn-primary","btn-sm","ml-1",3,"disabled","click"],["inset","",1,"mt-1","mb-2"],["fundForm","ngForm"],[1,"mr-1"],["for","fName"],["matInput","","id","fName","maxlength","100","minlength","3","name","fName","placeholder","e.g. BBSRC","required","","type","text",1,"",3,"ngModel","ngModelChange"],["fName","ngModel"],["for","fGrant"],["matInput","","id","fGrant","maxlength","100","minlength","3","name","fGrant","placeholder","e.g. EC2014","type","text",1,"",3,"ngModel","ngModelChange"],["fGrant","ngModel"],[1,"mt-2"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"alert","alert-danger"],[1,"mb-0"],[4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""]],template:function(e,t){1&e&&h.Bc(0,vt,75,18,"div",0),2&e&&h.jc("ngIf",t.model)},directives:[u.m,et.a,et.c,tt.c,u.l,nt.a,We.D,We.r,We.s,Ge.c,Ge.g,ze.b,We.d,We.l,We.m,We.z,We.q,We.t,tt.a,it.a,tt.d],encapsulation:2}),gt),Tt=o("FUU9"),Dt=o("D0XW"),kt=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),Bt=o("mlxB"),wt=o("l7GE"),jt=o("ZUHj"),Ft=function(){function e(t,n,i,r){s(this,e),this.waitFor=t,this.absoluteTimeout=n,this.withObservable=i,this.scheduler=r}return a(e,[{key:"call",value:function(e,t){return t.subscribe(new It(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))}}]),e}(),It=function(n){t(o,n);var r=i(o);function o(e,t,n,i,c){var a;return s(this,o),(a=r.call(this,e)).absoluteTimeout=t,a.waitFor=n,a.withObservable=i,a.scheduler=c,a.action=null,a.scheduleTimeout(),a}return a(o,[{key:"scheduleTimeout",value:function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(o.dispatchTimeout,this.waitFor,this))}},{key:"_next",value:function(t){this.absoluteTimeout||this.scheduleTimeout(),e(c(o.prototype),"_next",this).call(this,t)}},{key:"_unsubscribe",value:function(){this.action=null,this.scheduler=null,this.withObservable=null}}],[{key:"dispatchTimeout",value:function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(Object(jt.a)(e,t))}}]),o}(wt.a),xt=o("z6cu"),Mt=o("vkgz"),Ot=o("JIr8"),Ct=o("LRne"),Et=o("UsWK"),At=((yt=function(){function e(t){s(this,e),this.BD2REST=t,this.popularSpecies=["Arabidopsis thaliana","Brassica rapa","Danio rerio","Drosophila melanogaster","Glycine max","Homo sapiens","Lemna gibba","Lemna minor","Marchantia polymorpha","Medicago truncatula","Mus musculus","Nannochloropsis","Neurospora crassa","Oryza sativa","Ostreococcus tauri","Phaeodactylum tricornutum","Physcometrella patens","Picea abies","Rattus norvegicus","Saccharomyces cerevisiae","Synechococcus elongatus","Synthetic data"],this.fetchedSpecies=void 0,console.log("Species Service")}return a(e,[{key:"species",value:function(){return this.fetchedSpecies?Promise.resolve(this.fetchedSpecies):this.fetchSpecies().toPromise()}},{key:"fetchSpecies",value:function(){var e=this;return this.BD2REST.species().pipe(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dt.a;return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dt.a;return function(i){var r=Object(Bt.a)(e),c=r?+e-n.now():Math.abs(e);return i.lift(new Ft(c,r,t,n))}}(5e3,Object(xt.a)(new kt),t)}(),Object(Mt.a)((function(t){if(!(t&&t.length>0))throw new Error("Retrieved empty species falls back to default");e.fetchedSpecies=t})),Object(Ot.a)((function(t){return console.log(" Could not fetch species",t),Object(Ct.a)(e.popularSpecies)})))}}]),e}()).\u0275fac=function(e){return new(e||yt)(h.Xb(Et.a))},yt.\u0275prov=h.Jb({token:yt,factory:yt.\u0275fac,providedIn:"root"}),yt),qt=o("d3UM"),Nt=o("FKr1");function Lt(e,t){if(1&e&&(h.Tb(0,"mat-option",13),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.jc("value",n),h.Bb(1),h.Fc("",n," ")}}function Pt(e,t){if(1&e&&(h.Tb(0,"mat-option",13),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.jc("value",n.name),h.Bb(1),h.Fc(" ",n.longName," ")}}function Ut(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Tb(1,"form",null,1),h.Tb(3,"div",2),h.Tb(4,"mat-form-field",3),h.Tb(5,"mat-label",4),h.Dc(6,"Species"),h.Sb(),h.Tb(7,"mat-select",5,6),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc()._model.species=e})),h.Bc(9,Lt,2,2,"mat-option",7),h.Sb(),h.Tb(10,"mat-hint"),h.Dc(11,"Please email us if you don't see suitable terms in the value lists"),h.Sb(),h.Sb(),h.Sb(),h.Tb(12,"div",2),h.Tb(13,"mat-form-field",3),h.Tb(14,"mat-label",8),h.Dc(15,"Data category"),h.Sb(),h.Tb(16,"mat-select",9,10),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc()._model.category=e})),h.Bc(18,Pt,2,2,"mat-option",7),h.Sb(),h.Tb(19,"mat-hint"),h.Dc(20,"Please email us if you don't see suitable terms in the value lists"),h.Sb(),h.Sb(),h.Sb(),h.Tb(21,"button",11),h.Zb("click",(function(){return h.sc(n),h.dc().save()})),h.Dc(22),h.Sb(),h.Tb(23,"button",12),h.Zb("click",(function(){return h.sc(n),h.dc().cancel()})),h.Dc(24,"Cancel"),h.Sb(),h.Sb(),h.Sb()}if(2&e){var i=h.qc(2),r=h.dc();h.Bb(7),h.jc("ngModel",r._model.species),h.Bb(2),h.jc("ngForOf",r.knownSpecies),h.Bb(7),h.jc("ngModel",r._model.category),h.Bb(2),h.jc("ngForOf",r.categories),h.Bb(3),h.jc("disabled",r.blocked||!i.form.valid),h.Bb(1),h.Ec(r.okLabel)}}var Rt,Zt,_t=((Rt=function(e){t(r,e);var n=i(r);function r(e){var t;return s(this,r),(t=n.call(this)).speciesService=e,t.okLabel="Save",t.blocked=!1,t.onAccepted=new h.o,t.onCancelled=new h.o,t.categories=[],t.knownSpecies=[],t._model={species:null,category:null},t}return a(r,[{key:"getModel",value:function(){return this._model}},{key:"ngOnInit",value:function(){var e=this;this.speciesService.species().then((function(t){return e.knownSpecies=t})),this.categories=this.initCategories()}},{key:"cancel",value:function(){this.clearErrors(),this.onCancelled.emit(!0)}},{key:"save",value:function(){this.triggerValidation()&&(this.experiment.dataCategory=Tt.a.get(this._model.category),this.experiment.species=this._model.species,this.onAccepted.emit(this.experiment))}},{key:"validate",value:function(e){var t=[];return e.species&&""!==e.species.trim()||t.push("Species cannot be empty"),e.species&&this.knownSpecies.indexOf(e.species)<0&&t.push("Unknown species: "+e.species),e.category&&"NONE"!==e.category||t.push("Data category is required"),0===t.length?null:t}},{key:"initCategories",value:function(){var e=Tt.a.getValidOptions().slice();return Object(Qe.b)(Tt.a.get("NONE"),e),e}},{key:"model",set:function(e){e&&(this.experiment=e,this._model.species=e.species,this._model.category=e.dataCategory?e.dataCategory.name:null)}}]),r}(Le.a)).\u0275fac=function(e){return new(e||Rt)(h.Nb(At))},Rt.\u0275cmp=h.Hb({type:Rt,selectors:[["bd2-simple-bio-desc-form"]],inputs:{okLabel:"okLabel",blocked:"blocked",model:"model"},outputs:{onAccepted:"onAccepted",onCancelled:"onCancelled"},features:[h.yb],decls:1,vars:1,consts:[[4,"ngIf"],["sBioForm","ngForm"],[1,"form-group"],[1,"w-100"],["for","species"],["id","species","required","","placeholder","Select species","name","species",1,"",3,"ngModel","ngModelChange"],["species","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","dataCategory"],["id","dataCategory","required","","placeholder","Select category","name","dataCategory",1,"",3,"ngModel","ngModelChange"],["dataCategory","ngModel"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[3,"value"]],template:function(e,t){1&e&&h.Bc(0,Ut,25,6,"div",0),2&e&&h.jc("ngIf",t.experiment)},directives:[u.m,We.D,We.r,We.s,Ge.c,Ge.g,qt.a,We.z,We.q,We.t,u.l,Ge.f,Nt.o],encapsulation:2}),Rt),Wt=o("JX91"),Gt=o("zrmi"),zt=((Zt=function(){function e(){s(this,e),this.equipments=new Map,this.parameters=new Map,this.initTechniques()}return a(e,[{key:"getTechniques",value:function(){return Promise.resolve(this.techniques)}},{key:"getEquipments",value:function(e){return this.equipments.has(e)?Promise.resolve(this.equipments.get(e)):Promise.reject(new Error("Unknown technique: "+e))}},{key:"getParameters",value:function(e){return this.parameters.has(e)?Promise.resolve(this.parameters.get(e)):Promise.reject(new Error("Unknown technique: "+e))}},{key:"registerEquipment",value:function(e,t){return this.equipments.has(e)?(this.equipments.get(e).indexOf(t)<0&&this.equipments.get(e).push(t),Promise.resolve(t)):Promise.reject(new Error("Unknown technique: "+e))}},{key:"initTechniques",value:function(){var e=this,t=["Luciferase luminescence","Bioluminescence","(G)FP fluorescence","Delayed fluorescence","Endogenous fluorescence","Leaf movement","General imaging"];this.techniques=t.concat(["Computer simulation","qRT-PCR","RNA microarray","RNA-Seq","Northern blot","Western blot","Protein array","Mass Spectrometry","Flow cytometry","Spectrophotometry","Immunoprecipitation","Biomass Assay","Gas exchange","Oxygen concentration","Other"]);var n=["","Luminometer","Tecan Infinite 200 PRO","Topcount 1","Topcount 2","Topcount 3","Topcount 4","HAM 1","HAM 2","HAM 3","Unknown"];this.equipments=new Map,this.techniques.forEach((function(t){return e.equipments.set(t,["","Unknown"])})),t.forEach((function(t){return e.equipments.set(t,n)})),this.equipments.set("qRT-PCR",["","Robot + Light Cycler 480","Light Cycler 480","Unknown"]),this.equipments.set("Oxygen concentration",["","Galvanic Clarck's probe","Unknown"]);var i=[];i.push(new Gt.b("exposure_time",void 0,"Exposure time","min")),i.push(new Gt.b("interval",void 0,"Img interval","h")),i.push(new Gt.b("start_time",void 0,"Start time","h")),this.parameters=new Map,this.techniques.forEach((function(t){return e.parameters.set(t,[])})),t.forEach((function(t){return e.parameters.set(t,i)}))}}]),e}()).\u0275fac=function(e){return new(e||Zt)},Zt.\u0275prov=h.Jb({token:Zt,factory:Zt.\u0275fac,providedIn:"root"}),Zt),Vt=o("/1cH");function Ht(e,t){1&e&&(h.Tb(0,"mat-error"),h.Dc(1,"Known technique must be selected"),h.Sb())}function $t(e,t){if(1&e&&(h.Tb(0,"mat-option",19),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.jc("value",n),h.Bb(1),h.Fc(" ",n," ")}}function Xt(e,t){if(1&e&&(h.Tb(0,"mat-option",19),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.jc("value",n),h.Bb(1),h.Fc(" ",n," ")}}function Jt(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Tb(1,"form",1),h.Tb(2,"mat-hint",2),h.Dc(3,"Please email us if you don't see suitable terms in the value lists"),h.Sb(),h.Tb(4,"div",3),h.Tb(5,"mat-form-field",4),h.Tb(6,"mat-label",5),h.Dc(7,"Technique"),h.Sb(),h.Ob(8,"input",6,7),h.Tb(10,"mat-hint"),h.Dc(11,"Type to select technique (backspace for all available)"),h.Sb(),h.Bc(12,Ht,2,0,"mat-error",0),h.Sb(),h.Tb(13,"mat-autocomplete",8,9),h.Zb("optionSelected",(function(e){return h.sc(n),h.dc().techniqueSelected(e)})),h.Bc(15,$t,2,2,"mat-option",10),h.ec(16,"async"),h.Sb(),h.Sb(),h.Tb(17,"div",3),h.Tb(18,"mat-form-field",4),h.Tb(19,"mat-label",11),h.Dc(20,"Equipment"),h.Sb(),h.Ob(21,"input",12,13),h.Tb(23,"mat-hint"),h.Dc(24,"Type define your equipment or choose from the list (backspace for all known)"),h.Sb(),h.Sb(),h.Tb(25,"mat-autocomplete",null,14),h.Bc(27,Xt,2,2,"mat-option",10),h.ec(28,"async"),h.Sb(),h.Sb(),h.Tb(29,"div",3),h.Tb(30,"mat-form-field",4),h.Tb(31,"mat-label",15),h.Dc(32,"Description"),h.Sb(),h.Tb(33,"textarea",16),h.Dc(34,"     "),h.Sb(),h.Tb(35,"mat-hint"),h.Dc(36,"Describe how the measurement was conducted"),h.Sb(),h.Sb(),h.Sb(),h.Tb(37,"button",17),h.Zb("click",(function(){return h.sc(n),h.dc().save()})),h.Dc(38),h.Sb(),h.Tb(39,"button",18),h.Zb("click",(function(){return h.sc(n),h.dc().cancel()})),h.Dc(40,"Cancel"),h.Sb(),h.Sb(),h.Sb()}if(2&e){var i=h.qc(14),r=h.qc(26),c=h.dc();h.Bb(1),h.jc("formGroup",c.formModel),h.Bb(7),h.jc("matAutocomplete",i),h.Bb(4),h.jc("ngIf",null==c.formModel.get("technique").errors?null:c.formModel.get("technique").errors.validTechnique),h.Bb(3),h.jc("ngForOf",h.fc(16,8,c.filteredTechniques)),h.Bb(6),h.jc("matAutocomplete",r),h.Bb(6),h.jc("ngForOf",h.fc(28,10,c.filteredEquipments)),h.Bb(10),h.jc("disabled",c.blocked||!c.formModel.valid),h.Bb(1),h.Ec(c.okLabel)}}var Kt,Yt=((Kt=function(){function e(t,n,i){s(this,e),this.techniqueService=t,this.feedback=n,this.fb=i,this.okLabel="Save",this.onAccepted=new h.o,this.onCancelled=new h.o,this.techniques=[],this.filteredTechniques=Object(Ct.a)([]),this.equipments=[],this.filteredEquipments=Object(Ct.a)([])}return a(e,[{key:"setModel",value:function(e){this._orgModel=e}},{key:"ngOnInit",value:function(){this.updateTechniques()}},{key:"filter",value:function(e,t){var n=t.toLowerCase();return e.filter((function(e){return e.toLowerCase().includes(n)}))}},{key:"buildMainForm",value:function(e){var t=this;return this.fb.group({technique:[e.technique,[We.B.required,function(e){return t.knownTechnique(e.value)}]],equipment:[e.equipment],description:[e.description],parameters:[]})}},{key:"knownTechnique",value:function(e){return e?this.techniques.find((function(t){return t===e}))?null:{validTechnique:"Unknown technique: "+e}:{validTechnique:"Empty value"}}},{key:"techniqueSelected",value:function(e){e.option.value&&this.updateEquipments(e.option.value)}},{key:"updateTechniques",value:function(){var e=this;return this.techniqueService.getTechniques().then((function(t){return e.techniques=t||[],t})).catch((function(t){return e.feedback.error(t),Promise.reject(t)}))}},{key:"updateEquipments",value:function(e){var t=this;return e?this.techniqueService.getEquipments(e).then((function(e){return t.equipments=e||[],e})).catch((function(e){return t.feedback.error(e),Promise.reject(e)})):(this.equipments=[],Promise.resolve([]))}},{key:"cancel",value:function(){this.onCancelled.emit(!0)}},{key:"save",value:function(){this.formModel.valid&&(this._orgModel.setAll(this.formModel.value),this.onAccepted.emit(this._orgModel))}},{key:"model",set:function(e){var t=this;this.setModel(e),this.updateTechniques().then((function(n){return t.updateEquipments(e.technique)})).then((function(n){return t.formModel=t.buildMainForm(e)})).then((function(e){t.filteredTechniques=t.formModel.get("technique").valueChanges.pipe(Object(Wt.a)(""),Object(b.a)((function(e){return t.filter(t.techniques,e)}))),t.filteredEquipments=t.formModel.get("equipment").valueChanges.pipe(Object(Wt.a)(""),Object(b.a)((function(e){return t.filter(t.equipments,e)})))}))}}]),e}()).\u0275fac=function(e){return new(e||Kt)(h.Nb(zt),h.Nb(g.a),h.Nb(We.e))},Kt.\u0275cmp=h.Hb({type:Kt,selectors:[["bd2-measurement-desc-rform"]],inputs:{okLabel:"okLabel",blocked:"blocked",model:"model"},outputs:{onAccepted:"onAccepted",onCancelled:"onCancelled"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"formGroup"],[1,"mb-2"],[1,"form-group"],[1,"w-100"],["for","mTechNameA"],["matInput","","formControlName","technique","id","mTechNameA","placeholder","Type to select technique (backspace for all available)","required","",1,"",3,"matAutocomplete"],["mTechNameA",""],[3,"optionSelected"],["techniqueAuto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["for","mEquipNameA"],["matInput","","formControlName","equipment","id","mEquipNameA","placeholder","Type to choose or define equipment",1,"",3,"matAutocomplete"],["mEquipNameA",""],["equipmentAuto","matAutocomplete"],["for","mDescription"],["matInput","","formControlName","description","id","mDescription","placeholder","Describe how the measurement was conducted, used technical tricks etc...\nFor example: plants were sprayed with luciferase two ours before measurement. Images were taken every two ours.","rows","5","type","text",1,""],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[3,"value"]],template:function(e,t){1&e&&h.Bc(0,Jt,41,12,"div",0),2&e&&h.jc("ngIf",t.formModel)},directives:[u.m,We.D,We.r,We.i,Ge.f,Ge.c,Ge.g,ze.b,We.d,Vt.c,We.q,We.h,We.z,Vt.a,u.l,Ge.b,Nt.o],pipes:[u.b],encapsulation:2}),Kt);function Qt(e,t){if(1&e&&(h.Tb(0,"li"),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.Bb(1),h.Ec(n)}}function en(e,t){if(1&e&&(h.Tb(0,"div",8),h.Tb(1,"ul"),h.Bc(2,Qt,2,1,"li",9),h.Sb(),h.Sb()),2&e){var n=h.dc(2);h.Bb(2),h.jc("ngForOf",n.errors)}}function tn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"bd2-general-desc-form",10),h.Zb("onAccepted",(function(e){return h.sc(n),h.dc(2).saveEdits(e)}))("onCancelled",(function(e){return h.sc(n),h.dc(2).hideEdits(e)})),h.Sb()}if(2&e){var i=h.dc(2);h.jc("blocked",i.blocked)("model",i.assay.generalDesc)}}function nn(e,t){if(1&e&&h.Ob(0,"bd2-general-desc-view",11),2&e){var n=h.dc(2);h.jc("model",n.assay.generalDesc)}}function rn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"button",12),h.Zb("click",(function(){return h.sc(n),h.dc(2).activeGeneralDescForm=!0})),h.Dc(3,"Modify "),h.Sb(),h.Sb()}if(2&e){var i=h.dc(2);h.Bb(2),h.jc("disabled",i.activeGeneralDescForm)}}function cn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"bd2-contr-desc-form",10),h.Zb("onAccepted",(function(e){return h.sc(n),h.dc(2).saveEdits(e)}))("onCancelled",(function(e){return h.sc(n),h.dc(2).hideEdits(e)})),h.Sb()}if(2&e){var i=h.dc(2);h.jc("blocked",i.blocked)("model",i.assay.contributionDesc)}}function on(e,t){if(1&e&&h.Ob(0,"bd2-contr-desc-view",11),2&e){var n=h.dc(2);h.jc("model",n.assay.contributionDesc)}}function an(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"button",12),h.Zb("click",(function(){return h.sc(n),h.dc(2).activeContributionDescForm=!0})),h.Dc(3,"Modify "),h.Sb(),h.Sb()}if(2&e){var i=h.dc(2);h.Bb(2),h.jc("disabled",i.activeContributionDescForm)}}function sn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"bd2-simple-bio-desc-form",10),h.Zb("onAccepted",(function(e){return h.sc(n),h.dc(2).saveEdits(e)}))("onCancelled",(function(e){return h.sc(n),h.dc(2).hideEdits(e)})),h.Sb()}if(2&e){var i=h.dc(2);h.jc("blocked",i.blocked)("model",i.assay)}}function un(e,t){if(1&e&&h.Ob(0,"bd2-simple-bio-desc-view",11),2&e){var n=h.dc(2);h.jc("model",n.assay)}}function ln(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"button",12),h.Zb("click",(function(){return h.sc(n),h.dc(2).activeSimpleBioDescForm=!0})),h.Dc(3,"Modify "),h.Sb(),h.Sb()}if(2&e){var i=h.dc(2);h.Bb(2),h.jc("disabled",i.activeSimpleBioDescForm)}}function dn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"bd2-measurement-desc-rform",10),h.Zb("onAccepted",(function(e){return h.sc(n),h.dc(2).saveEdits(e)}))("onCancelled",(function(e){return h.sc(n),h.dc(2).hideEdits(e)})),h.Sb()}if(2&e){var i=h.dc(2);h.jc("blocked",i.blocked)("model",i.assay.experimentalDetails.measurementDesc)}}function bn(e,t){if(1&e&&h.Ob(0,"bd2-measurement-desc-view",11),2&e){var n=h.dc(2);h.jc("model",n.assay.experimentalDetails.measurementDesc)}}function fn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"button",12),h.Zb("click",(function(){return h.sc(n),h.dc(2).activeMeasurementDescForm=!0})),h.Dc(3,"Modify "),h.Sb(),h.Sb()}if(2&e){var i=h.dc(2);h.Bb(2),h.jc("disabled",i.activeMeasurementDescForm)}}function mn(e,t){if(1&e&&(h.Tb(0,"li"),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.Bb(1),h.Ec(n)}}function hn(e,t){if(1&e&&(h.Tb(0,"div",8),h.Tb(1,"ul"),h.Bc(2,mn,2,1,"li",9),h.Sb(),h.Sb()),2&e){var n=h.dc(2);h.Bb(2),h.jc("ngForOf",n.errors)}}function pn(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"h3"),h.Dc(2,"Modify experiment description"),h.Sb(),h.Bc(3,en,3,1,"div",1),h.Tb(4,"div",2),h.Tb(5,"div",3),h.Dc(6,"General description"),h.Sb(),h.Tb(7,"div",4),h.Bc(8,tn,1,2,"bd2-general-desc-form",5),h.Bc(9,nn,1,1,"bd2-general-desc-view",6),h.Bc(10,rn,4,1,"div",0),h.Sb(),h.Sb(),h.Tb(11,"div",2),h.Tb(12,"div",3),h.Dc(13,"Contributions"),h.Sb(),h.Tb(14,"div",4),h.Bc(15,cn,1,2,"bd2-contr-desc-form",5),h.Bc(16,on,1,1,"bd2-contr-desc-view",6),h.Bc(17,an,4,1,"div",0),h.Sb(),h.Sb(),h.Tb(18,"div",2),h.Tb(19,"div",3),h.Dc(20,"Biological details"),h.Sb(),h.Tb(21,"div",4),h.Bc(22,sn,1,2,"bd2-simple-bio-desc-form",5),h.Bc(23,un,1,1,"bd2-simple-bio-desc-view",6),h.Bc(24,ln,4,1,"div",0),h.Sb(),h.Sb(),h.Tb(25,"div",7),h.Tb(26,"div",3),h.Dc(27,"Measurement details"),h.Sb(),h.Tb(28,"div",4),h.Bc(29,dn,1,2,"bd2-measurement-desc-rform",5),h.Bc(30,bn,1,1,"bd2-measurement-desc-view",6),h.Bc(31,fn,4,1,"div",0),h.Sb(),h.Sb(),h.Bc(32,hn,3,1,"div",1),h.Sb()),2&e){var n=h.dc();h.Bb(3),h.jc("ngIf",n.errors),h.Bb(5),h.jc("ngIf",n.activeGeneralDescForm),h.Bb(1),h.jc("ngIf",!n.activeGeneralDescForm),h.Bb(1),h.jc("ngIf",!n.activeGeneralDescForm),h.Bb(5),h.jc("ngIf",n.activeContributionDescForm),h.Bb(1),h.jc("ngIf",!n.activeContributionDescForm),h.Bb(1),h.jc("ngIf",!n.activeContributionDescForm),h.Bb(5),h.jc("ngIf",n.activeSimpleBioDescForm),h.Bb(1),h.jc("ngIf",!n.activeSimpleBioDescForm),h.Bb(1),h.jc("ngIf",!n.activeSimpleBioDescForm),h.Bb(5),h.jc("ngIf",n.activeMeasurementDescForm),h.Bb(1),h.jc("ngIf",!n.activeMeasurementDescForm),h.Bb(1),h.jc("ngIf",!n.activeMeasurementDescForm),h.Bb(1),h.jc("ngIf",n.errors)}}var vn,gn,yn=((vn=function(n){t(o,n);var r=i(o);function o(e,t){var n;return s(this,o),(n=r.call(this,t)).route=e,n.blocked=!1,n.activeGeneralDescForm=!1,n.activeContributionDescForm=!1,n.activeSimpleBioDescForm=!1,n.activeMeasurementDescForm=!1,n.titlePart=" Edit",n.validator=Ne.INSTANCE,n}return a(o,[{key:"ngOnInit",value:function(){var t=this;e(c(o.prototype),"ngOnInit",this).call(this),this.route.fragment.subscribe((function(e){t.requestedSection=e,t.focusOnSection(e)}))}},{key:"ngAfterViewInit",value:function(){this.focusOnSection(this.requestedSection)}},{key:"focusOnSection",value:function(e){if(e){var t=document.getElementById(e);t&&t.scrollIntoView(),"MeasurementSection"===e&&(this.activeMeasurementDescForm=!0)}}},{key:"saveEdits",value:function(e){var t=this;this.assay&&e&&this.triggerValidation()&&(this.blocked=!0,this.experimentService.save(this.assay).then((function(e){return t.feedback.success('Experiment: "'+e.name+'" updated.'),e})).then((function(e){return t.currentExperiment.push(e),e})).then((function(n){t.blocked=!1,t.hideEdits(e)})).catch((function(e){t.blocked=!1,t.feedback.error(e)})))}},{key:"hideEdits",value:function(e){this.activeGeneralDescForm=!1,this.activeContributionDescForm=!1,this.activeSimpleBioDescForm=!1,this.activeMeasurementDescForm=!1,this.triggerValidation()}},{key:"cancel",value:function(){this.clearErrors(),this.router.navigate(["/experiment",this.assay.id])}},{key:"updateModel",value:function(e){this._orgModel=e,this.assay=e?e.clone():null,this.setTitle()}}]),o}(ie.a)).\u0275fac=function(e){return new(e||vn)(h.Nb(l.a),h.Nb(m.a))},vn.\u0275cmp=h.Hb({type:vn,selectors:[["ng-component"]],features:[h.Ab([]),h.yb],decls:1,vars:1,consts:[[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"card","mb-2"],[1,"card-header"],[1,"card-body"],[3,"blocked","model","onAccepted","onCancelled",4,"ngIf"],[3,"model",4,"ngIf"],["id","MeasurementSection",1,"card","mb-2"],[1,"alert","alert-danger"],[4,"ngFor","ngForOf"],[3,"blocked","model","onAccepted","onCancelled"],[3,"model"],["type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&h.Bc(0,pn,33,14,"div",0),2&e&&h.jc("ngIf",t.assay)},directives:[u.m,u.l,Xe,ue,St,ye,_t,De,Yt,Ie],encapsulation:2}),vn),Sn=function(){var e=function(){function e(t){s(this,e),this.name=t}return a(e,[{key:"equals",value:function(e){return this.name===e.name}},{key:"toJSON",value:function(){return this.name}}],[{key:"deserialize",value:function(t){if(null==t)return null;var n=e.valuesMap.get(t);if(n)return n;var i=+t;if(i<0||i>=e.values.length||Number.isNaN(i))throw new RangeError("Uknown AssetType "+t);return e.values[i]}},{key:"initValuesMap",value:function(){var t=new Map;return e.values.forEach((function(e){return t.set(e.name,e)})),t}}]),e}();return e.NONE=new e("NONE"),e.FILE=new e("FILE"),e.MEDIA=new e("MEDIA"),e.DATA=new e("DATA"),e.TS_DATA=new e("TS_DATA"),e.values=[e.NONE,e.FILE,e.MEDIA,e.DATA,e.TS_DATA],e.valuesMap=e.initValuesMap(),e}(),Tn=function(){function e(){s(this,e),this.assetType=Sn.NONE,this.versions=[]}return a(e,[{key:"setAll",value:function(e){this.id=e.id,this.originalName=e.originalName,this.assetType=e.assetType,this.url=e.url,this.versions=e.versions}},{key:"last",get:function(){return this.versions[0]}}],[{key:"deserialize",value:function(t){var n=new e;return n.id=t.id,n.originalName=t.originalName,n.url=t.url,n.assetType=Sn.deserialize(t.assetType),t.versions&&(n.versions=t.versions.map((function(e){return function(){function e(){s(this,e)}return a(e,null,[{key:"deserialize",value:function(e){return e.created=_e.a.deserialize(e.created),e}}]),e}().deserialize(e)}))),n}}]),e}(),Dn=((gn=function(){function e(t){s(this,e),this.BD2REST=t}return a(e,[{key:"upload",value:function(e,t){for(var n=new FormData,i=0;i<t.length;i++)n.append("file",t[i],t[i].name);return this.BD2REST.expFileUpload(e.id,n).then((function(e){return e.data}))}},{key:"getFiles",value:function(e){var t=this;return this.BD2REST.files(e.id).then((function(e){return e.data})).then((function(e){return t.json2AssetsList(e)})).then((function(n){return t.fillURLs(n,e)}))}},{key:"fillURLs",value:function(e,t){var n=this;return e.map((function(e){return n.fillURL(e,t)}))}},{key:"fillURL",value:function(e,t){var n=this.BD2REST.fileURL(t.id,e.id);return e.url=n,e.versions.forEach((function(e){e.url=n+"/"+e.versionId})),e}},{key:"json2AssetsList",value:function(e){return e.map((function(e){return Tn.deserialize(e)}))}}]),e}()).\u0275fac=function(e){return new(e||gn)(h.Xb(Et.a))},gn.\u0275prov=h.Jb({token:gn,factory:gn.\u0275fac,providedIn:"root"}),gn),kn=o("vLYz");function Bn(e,t){if(1&e&&(h.Tb(0,"div"),h.Dc(1),h.Sb()),2&e){var n=h.dc(2);h.Bb(1),h.Ec(n.file.last.description)}}function wn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"li"),h.Dc(1),h.ec(2,"date"),h.Tb(3,"strong"),h.Tb(4,"a",4),h.Zb("click",(function(){return h.sc(n),h.dc(3).recordDownload()})),h.Dc(5),h.Sb(),h.Sb(),h.Ob(6,"br"),h.Dc(7),h.Sb()}if(2&e){var i=t.$implicit;h.Bb(1),h.Gc(" Version ",i.versionId,". ",h.gc(2,6,i.created.date,"shortDate")," "),h.Bb(3),h.kc("href",i.url,h.uc),h.kc("download",i.originalName),h.Bb(1),h.Ec(i.originalName),h.Bb(2),h.Fc("",i.description," ")}}function jn(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"ul",5),h.Bc(2,wn,8,9,"li",6),h.Sb(),h.Sb()),2&e){var n=h.dc(2);h.Bb(2),h.jc("ngForOf",n.file.versions)}}function Fn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Tb(1,"div",1),h.Dc(2),h.Tb(3,"a",2),h.Zb("click",(function(){h.sc(n);var e=h.dc();return e.showVersions=!e.showVersions})),h.Tb(4,"i",3),h.Dc(5,"expand_more"),h.Sb(),h.Sb(),h.Sb(),h.Tb(6,"h5"),h.Tb(7,"a",4),h.Zb("click",(function(){return h.sc(n),h.dc().recordDownload()})),h.Dc(8),h.Sb(),h.Sb(),h.Bc(9,Bn,2,1,"div",0),h.Bc(10,jn,3,1,"div",0),h.Sb()}if(2&e){var i=h.dc();h.Bb(2),h.Fc(" ",i.file.versions.length," versions "),h.Bb(5),h.kc("href",i.file.url,h.uc),h.kc("download",i.file.last.originalName),h.Bb(1),h.Ec(i.file.last.originalName),h.Bb(1),h.jc("ngIf",i.file.last.description),h.Bb(1),h.jc("ngIf",i.showVersions)}}var In,xn=((In=function(){function e(t){s(this,e),this.analytics=t,this.canEdit=!0,this.showVersions=!1,this.edit=!1,this.model=this.fakeFileAsset()}return a(e,[{key:"ngOnInit",value:function(){}},{key:"fakeFileAsset",value:function(){var e=JSON.parse('{\n      "id" : 2,\n      "originalName" : "f2",\n      "assetType" : "TS_DATA",\n      "versions" : [ {\n        "versionId" : 2,\n        "localFile" : "cos2",\n        "originalName" : "f2",\n        "contentType" : "txt",\n        "description" : "Some description",\n        "created" : [ 2016, 12, 8 ]\n      }, {\n        "versionId" : 1,\n        "localFile" : "cos2",\n        "originalName" : "f2",\n        "contentType" : "txt",\n        "description" : null,\n        "created" : [ 2016, 12, 8 ]\n      } ]\n    }');return Tn.deserialize(e)}},{key:"recordDownload",value:function(){this.analytics.fileDownload(this.parentId,this.file.id)}},{key:"model",set:function(e){this.file=e}}]),e}()).\u0275fac=function(e){return new(e||In)(h.Nb(y.a))},In.\u0275cmp=h.Hb({type:In,selectors:[["bd2-file-asset-view"]],inputs:{canEdit:"canEdit",parentId:"parentId",model:"model"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"float-right"],["role","button","aria-label","expand",3,"click"],[1,"material-icons","bd-icon"],[3,"href","download","click"],[1,"list-unstyled"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&h.Bc(0,Fn,11,6,"div",0),2&e&&h.jc("ngIf",t.file&&t.file.last)},directives:[u.m,u.l],pipes:[u.e],encapsulation:2}),In),Mn=["uploadWidget"];function On(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Tb(1,"bd2-file-upload-widget",2,3),h.Zb("uploadFiles",(function(e){return h.sc(n),h.dc(2).upload(e)})),h.Sb(),h.Ob(3,"hr"),h.Sb()}if(2&e){var i=h.dc(2);h.Bb(1),h.jc("autoReset",!1)("blocked",i.blocked)}}function Cn(e,t){if(1&e&&h.Ob(0,"bd2-file-asset-view",5),2&e){var n=t.$implicit,i=h.dc(3);h.jc("model",n)("parentId",i.assay.id)}}function En(e,t){1&e&&(h.Tb(0,"div",6),h.Dc(1,' Use "Replace data" to change timeseries files. '),h.Sb())}function An(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"h4"),h.Dc(2,"Timeseries files"),h.Sb(),h.Bc(3,Cn,1,2,"bd2-file-asset-view",4),h.Bc(4,En,2,0,"div",1),h.Ob(5,"hr"),h.Sb()),2&e){var n=h.dc(2);h.Bb(3),h.jc("ngForOf",n.tsData),h.Bb(1),h.jc("ngIf",n.assay.security.canWrite)}}function qn(e,t){1&e&&(h.Tb(0,"div",6),h.Dc(1,' Use "Import data" to add timeseries files. '),h.Sb())}function Nn(e,t){if(1&e&&h.Ob(0,"bd2-file-asset-view",5),2&e){var n=t.$implicit,i=h.dc(3);h.jc("model",n)("parentId",i.assay.id)}}function Ln(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"h4"),h.Dc(2,"Attachments"),h.Sb(),h.Bc(3,Nn,1,2,"bd2-file-asset-view",4),h.Sb()),2&e){var n=h.dc(2);h.Bb(3),h.jc("ngForOf",n.attachments)}}function Pn(e,t){1&e&&(h.Tb(0,"div",6),h.Dc(1," Drag and upload files using the upload area in order to update the attachments. "),h.Sb())}function Un(e,t){if(1&e&&(h.Tb(0,"div"),h.Bc(1,On,4,2,"div",0),h.Bc(2,An,6,2,"div",0),h.Bc(3,qn,2,0,"div",1),h.Bc(4,Ln,4,1,"div",0),h.Bc(5,Pn,2,0,"div",1),h.Sb()),2&e){var n=h.dc();h.Bb(1),h.jc("ngIf",n.assay.security.canWrite),h.Bb(1),h.jc("ngIf",n.tsData&&n.tsData.length>0),h.Bb(1),h.jc("ngIf",!n.tsData||0===n.tsData.length),h.Bb(1),h.jc("ngIf",n.attachments&&n.attachments.length>0),h.Bb(1),h.jc("ngIf",n.assay.security.canWrite)}}var Rn,Zn=((Rn=function(n){t(o,n);var r=i(o);function o(e,t){var n;return s(this,o),(n=r.call(this,t)).attachmentsService=e,n.attachments=[],n.tsData=[],n.blocked=!1,n.titlePart=" Files",n}return a(o,[{key:"updateModel",value:function(t){e(c(o.prototype),"updateModel",this).call(this,t),this.refreshAttachments()}},{key:"refreshAttachments",value:function(){var e=this;this.attachmentsService.getFiles(this.assay).then((function(t){return e.setFiles(t)})).catch((function(t){e.feedback.error(t)}))}},{key:"setFiles",value:function(e){this.tsData=e.filter((function(e){return e.assetType.equals(Sn.TS_DATA)})),this.attachments=e.filter((function(e){return!e.assetType.equals(Sn.TS_DATA)}))}},{key:"upload",value:function(e){var t=this;console.log("Uploading "+e.length),e&&0!==e.length&&(this.blocked=!0,this.attachmentsService.upload(this.assay,e).then((function(e){t.uploadWidget.reset(),t.blocked=!1,t.feedback.success(e.length+" files uploaded")})).then((function(){return t.refreshModel()})).catch((function(e){t.blocked=!1,t.feedback.error(e)})))}}]),o}(ie.a)).\u0275fac=function(e){return new(e||Rn)(h.Nb(Dn),h.Nb(m.a))},Rn.\u0275cmp=h.Hb({type:Rn,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&h.Ic(Mn,!0),2&e&&h.pc(n=h.ac())&&(t.uploadWidget=n.first)},features:[h.yb],decls:4,vars:1,consts:[[4,"ngIf"],["type","info","class","alert alert-info","role","alert",4,"ngIf"],[3,"autoReset","blocked","uploadFiles"],["uploadWidget",""],[3,"model","parentId",4,"ngFor","ngForOf"],[3,"model","parentId"],["type","info","role","alert",1,"alert","alert-info"]],template:function(e,t){1&e&&(h.Tb(0,"h3"),h.Dc(1,"Attached files"),h.Sb(),h.Ob(2,"hr"),h.Bc(3,Un,6,5,"div",0)),2&e&&(h.Bb(3),h.jc("ngIf",t.assay))},directives:[u.m,kn.a,u.l,xn],styles:[""]}),Rn);function _n(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"div",1),h.Dc(2," Experiment is already publicly available under "),h.Tb(3,"strong"),h.Dc(4),h.Sb(),h.Dc(5," licence. "),h.Sb(),h.Sb()),2&e){var n=h.dc(2);h.Bb(4),h.Ec(n.assay.features.licence)}}function Wn(e,t){if(1&e&&(h.Tb(0,"option",12),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.jc("value",n),h.Bb(1),h.Fc("",n," ")}}function Gn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Tb(1,"div",2),h.Dc(2," You are about to make the data public. Once they are public they cannot be made private again. "),h.Tb(3,"ul"),h.Tb(4,"li"),h.Dc(5,"make sure you know what you are doing"),h.Sb(),h.Tb(6,"li"),h.Dc(7,"make sure all contributors agree to public sharing"),h.Sb(),h.Tb(8,"li"),h.Dc(9,"double check the description is correct, not all changes will be possible after the publishing"),h.Sb(),h.Sb(),h.Sb(),h.Tb(10,"form",null,3),h.Tb(12,"div",4),h.Tb(13,"label",5),h.Dc(14,"Licence"),h.Sb(),h.Tb(15,"select",6,7),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc(2).licence=e})),h.Bc(17,Wn,2,2,"option",8),h.Sb(),h.Sb(),h.Tb(18,"div",4),h.Tb(19,"label"),h.Tb(20,"input",9,10),h.Zb("ngModelChange",(function(e){return h.sc(n),h.dc(2).terms=e})),h.Sb(),h.Dc(22," I understand that I cannot undo this operation "),h.Sb(),h.Sb(),h.Tb(23,"button",11),h.Zb("click",(function(){return h.sc(n),h.dc(2).publish()})),h.Dc(24," Publish "),h.Sb(),h.Sb(),h.Sb()}if(2&e){var i=h.qc(11),r=h.dc(2);h.Bb(15),h.jc("ngModel",r.licence),h.Bb(2),h.jc("ngForOf",r.licences),h.Bb(3),h.jc("ngModel",r.terms),h.Bb(3),h.jc("disabled",!i.form.valid)}}function zn(e,t){if(1&e&&(h.Tb(0,"div"),h.Tb(1,"h3"),h.Dc(2,"Publish experiment"),h.Sb(),h.Bc(3,_n,6,1,"div",0),h.Bc(4,Gn,25,4,"div",0),h.Sb()),2&e){var n=h.dc();h.Bb(3),h.jc("ngIf",n.assay.features.isOpenAccess),h.Bb(1),h.jc("ngIf",!n.assay.features.isOpenAccess)}}var Vn,Hn=((Vn=function(n){t(o,n);var r=i(o);function o(e){var t;return s(this,o),(t=r.call(this,e)).licences=["CC_BY"],t}return a(o,[{key:"ngOnInit",value:function(){e(c(o.prototype),"ngOnInit",this).call(this),this.licence=this.licences[0]}},{key:"publish",value:function(){var e=this;this.terms&&this.licence&&this.experimentService.publish(this.assay,this.licence).then((function(t){return e.feedback.success('Experiment: "'+t.name+'" published.'),t})).then((function(t){return e.currentExperiment.push(t),t})).then((function(t){e.goToExpHome(t.id)})).catch((function(t){e.feedback.error(t)}))}}]),o}(ie.a)).\u0275fac=function(e){return new(e||Vn)(h.Nb(m.a))},Vn.\u0275cmp=h.Hb({type:Vn,selectors:[["bd2-publish-form"]],features:[h.yb],decls:1,vars:1,consts:[[4,"ngIf"],["type","info","role","alert",1,"alert","alert-info"],["type","danger","role","alert",1,"alert","alert-danger"],["publishForm","ngForm"],[1,"form-group"],["for","licence"],["id","licence","required","","placeholder","Select licence","name","licence",1,"form-control",3,"ngModel","ngModelChange"],["licenceF","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","checkbox","required","","id","terms","name","fTerms",3,"ngModel","ngModelChange"],["fTerms","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&h.Bc(0,zn,5,2,"div",0),2&e&&h.jc("ngIf",t.assay)},directives:[u.m,We.D,We.r,We.s,We.A,We.z,We.q,We.t,u.l,We.b,We.a,We.u,We.C],encapsulation:2}),Vn);function $n(e,t){1&e&&(h.Tb(0,"div"),h.Tb(1,"h4"),h.Dc(2,"You don't have permission to create experiment"),h.Sb(),h.Tb(3,"p"),h.Dc(4,"Try to login"),h.Sb(),h.Sb())}function Xn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"bd2-general-desc-form",9),h.Zb("onAccepted",(function(e){return h.sc(n),h.dc(2).hideEdits(e)}))("onCancelled",(function(e){return h.sc(n),h.dc(2).hideEdits(e)})),h.Sb()}if(2&e){var i=h.dc(2);h.jc("model",i.assay.generalDesc)}}function Jn(e,t){if(1&e&&h.Ob(0,"bd2-general-desc-view",10),2&e){var n=h.dc(2);h.jc("model",n.assay.generalDesc)}}function Kn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"button",11),h.Zb("click",(function(){return h.sc(n),h.dc(2).activeGeneralDescForm=!0})),h.Dc(3,"Modify "),h.Sb(),h.Sb()}if(2&e){var i=h.dc(2);h.Bb(2),h.jc("disabled",i.activeGeneralDescForm)}}function Yn(e,t){if(1&e){var n=h.Ub();h.Tb(0,"bd2-simple-bio-desc-form",9),h.Zb("onAccepted",(function(e){return h.sc(n),h.dc(2).hideEdits(e)}))("onCancelled",(function(e){return h.sc(n),h.dc(2).hideEdits(e)})),h.Sb()}if(2&e){var i=h.dc(2);h.jc("model",i.assay)}}function Qn(e,t){if(1&e&&h.Ob(0,"bd2-simple-bio-desc-view",10),2&e){var n=h.dc(2);h.jc("model",n.assay)}}function ei(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"button",11),h.Zb("click",(function(){return h.sc(n),h.dc(2).activeSimpleBioDescForm=!0})),h.Dc(3,"Modify "),h.Sb(),h.Sb()}if(2&e){var i=h.dc(2);h.Bb(2),h.jc("disabled",i.activeSimpleBioDescForm)}}function ti(e,t){if(1&e){var n=h.Ub();h.Tb(0,"bd2-contr-desc-form",9),h.Zb("onAccepted",(function(e){return h.sc(n),h.dc(2).hideEdits(e)}))("onCancelled",(function(e){return h.sc(n),h.dc(2).hideEdits(e)})),h.Sb()}if(2&e){var i=h.dc(2);h.jc("model",i.assay.contributionDesc)}}function ni(e,t){if(1&e&&h.Ob(0,"bd2-contr-desc-view",10),2&e){var n=h.dc(2);h.jc("model",n.assay.contributionDesc)}}function ii(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"button",11),h.Zb("click",(function(){return h.sc(n),h.dc(2).activeContributionDescForm=!0})),h.Dc(3,"Modify "),h.Sb(),h.Sb()}if(2&e){var i=h.dc(2);h.Bb(2),h.jc("disabled",i.activeContributionDescForm)}}function ri(e,t){if(1&e){var n=h.Ub();h.Tb(0,"bd2-measurement-desc-rform",9),h.Zb("onAccepted",(function(e){return h.sc(n),h.dc(2).hideEdits(e)}))("onCancelled",(function(e){return h.sc(n),h.dc(2).hideEdits(e)})),h.Sb()}if(2&e){var i=h.dc(2);h.jc("model",i.assay.experimentalDetails.measurementDesc)}}function ci(e,t){if(1&e&&h.Ob(0,"bd2-measurement-desc-view",10),2&e){var n=h.dc(2);h.jc("model",n.assay.experimentalDetails.measurementDesc)}}function oi(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Ob(1,"hr"),h.Tb(2,"button",11),h.Zb("click",(function(){return h.sc(n),h.dc(2).activeMeasurementDescForm=!0})),h.Dc(3,"Modify "),h.Sb(),h.Sb()}if(2&e){var i=h.dc(2);h.Bb(2),h.jc("disabled",i.activeMeasurementDescForm)}}function ai(e,t){if(1&e&&(h.Tb(0,"li"),h.Dc(1),h.Sb()),2&e){var n=t.$implicit;h.Bb(1),h.Ec(n)}}function si(e,t){if(1&e&&(h.Tb(0,"div",12),h.Tb(1,"ul"),h.Bc(2,ai,2,1,"li",13),h.Sb(),h.Sb()),2&e){var n=h.dc(2);h.Bb(2),h.jc("ngForOf",n.errors)}}function ui(e,t){if(1&e){var n=h.Ub();h.Tb(0,"div"),h.Tb(1,"h3"),h.Dc(2,"Create experiment"),h.Sb(),h.Tb(3,"div",1),h.Tb(4,"div",2),h.Dc(5,"General description"),h.Sb(),h.Tb(6,"div",3),h.Bc(7,Xn,1,1,"bd2-general-desc-form",4),h.Bc(8,Jn,1,1,"bd2-general-desc-view",5),h.Bc(9,Kn,4,1,"div",0),h.Sb(),h.Sb(),h.Tb(10,"div",1),h.Tb(11,"div",2),h.Dc(12,"Biological details"),h.Sb(),h.Tb(13,"div",3),h.Bc(14,Yn,1,1,"bd2-simple-bio-desc-form",4),h.Bc(15,Qn,1,1,"bd2-simple-bio-desc-view",5),h.Bc(16,ei,4,1,"div",0),h.Sb(),h.Sb(),h.Tb(17,"div",1),h.Tb(18,"div",2),h.Dc(19,"Contributions"),h.Sb(),h.Tb(20,"div",3),h.Bc(21,ti,1,1,"bd2-contr-desc-form",4),h.Bc(22,ni,1,1,"bd2-contr-desc-view",5),h.Bc(23,ii,4,1,"div",0),h.Sb(),h.Sb(),h.Tb(24,"div",1),h.Tb(25,"div",2),h.Dc(26,"Measurement details"),h.Sb(),h.Tb(27,"div",3),h.Bc(28,ri,1,1,"bd2-measurement-desc-rform",4),h.Bc(29,ci,1,1,"bd2-measurement-desc-view",5),h.Bc(30,oi,4,1,"div",0),h.Sb(),h.Sb(),h.Bc(31,si,3,1,"div",6),h.Tb(32,"button",7),h.Zb("click",(function(){return h.sc(n),h.dc().save()})),h.Dc(33,"Create"),h.Sb(),h.Tb(34,"button",8),h.Zb("click",(function(){return h.sc(n),h.dc().cancel()})),h.Dc(35,"Cancel"),h.Sb(),h.Sb()}if(2&e){var i=h.dc();h.Bb(7),h.jc("ngIf",i.activeGeneralDescForm),h.Bb(1),h.jc("ngIf",!i.activeGeneralDescForm),h.Bb(1),h.jc("ngIf",!i.activeGeneralDescForm),h.Bb(5),h.jc("ngIf",i.activeSimpleBioDescForm),h.Bb(1),h.jc("ngIf",!i.activeSimpleBioDescForm),h.Bb(1),h.jc("ngIf",!i.activeSimpleBioDescForm),h.Bb(5),h.jc("ngIf",i.activeContributionDescForm),h.Bb(1),h.jc("ngIf",!i.activeContributionDescForm),h.Bb(1),h.jc("ngIf",!i.activeContributionDescForm),h.Bb(5),h.jc("ngIf",i.activeMeasurementDescForm),h.Bb(1),h.jc("ngIf",!i.activeMeasurementDescForm),h.Bb(1),h.jc("ngIf",!i.activeMeasurementDescForm),h.Bb(1),h.jc("ngIf",i.errors),h.Bb(1),h.jc("disabled",i.blocked||i.errors)}}var li,di,bi,fi,mi,hi=[{path:"new",pathMatch:"full",component:(li=function(e){t(r,e);var n=i(r);function r(e,t,i,c){var o;return s(this,r),(o=n.call(this,Ne.INSTANCE)).experimentService=e,o.RDMSocial=t,o.feedback=i,o.router=c,o.isUnauthorised=!1,o.blocked=!1,o.activeGeneralDescForm=!0,o.activeContributionDescForm=!1,o.activeSimpleBioDescForm=!0,o.activeMeasurementDescForm=!1,o}return a(r,[{key:"ngOnInit",value:function(){var e=this;this.experimentService.newDraft().then((function(t){e.assay=t})).catch((function(t){e.isUnauthorised=t.isUnauthorised,e.feedback.error(t)}))}},{key:"hideEdits",value:function(e){this.activeGeneralDescForm=!this.assay.generalDesc.name,this.activeSimpleBioDescForm=!this.assay.species||!this.assay.dataCategory,this.activeContributionDescForm=!1,this.activeMeasurementDescForm=!1,this.triggerValidation()}},{key:"cancel",value:function(){this.clearErrors(),this.router.navigate(["/experiments"])}},{key:"save",value:function(){var e=this;this.assay&&this.triggerValidation()&&(this.blocked=!0,this.experimentService.newExperiment(this.assay).then((function(t){return e.feedback.success('Experiment: "'+t.name+'" created.'),t})).then((function(t){return e.router.navigate(["/experiment",t.id])})).catch((function(t){e.blocked=!1,e.feedback.error(t)})))}},{key:"getModel",value:function(){return this.assay}}]),r}(Le.a),li.\u0275fac=function(e){return new(e||li)(h.Nb(p.a),h.Nb(v.a),h.Nb(g.a),h.Nb(l.c))},li.\u0275cmp=h.Hb({type:li,selectors:[["ng-component"]],features:[h.yb],decls:2,vars:2,consts:[[4,"ngIf"],[1,"card","mb-2"],[1,"card-header"],[1,"card-body"],["okLabel","Accept",3,"model","onAccepted","onCancelled",4,"ngIf"],[3,"model",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["type","button",1,"btn","btn-primary","mr-1",3,"disabled","click"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["okLabel","Accept",3,"model","onAccepted","onCancelled"],[3,"model"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"alert","alert-danger"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(h.Bc(0,$n,5,0,"div",0),h.Bc(1,ui,36,14,"div",0)),2&e&&(h.jc("ngIf",t.isUnauthorised),h.Bb(1),h.jc("ngIf",t.assay))},directives:[u.m,Xe,ue,_t,De,St,ye,Yt,Ie,u.l],encapsulation:2}),li)},{path:":id",component:ne,children:[{path:"",pathMatch:"full",component:Ce},{path:"edit",component:yn},{path:"file",component:Zn},{path:"publish",component:Hn},{path:"data",loadChildren:function(){return Promise.all([o.e(2),o.e(3),o.e(4),o.e(0),o.e(14)]).then(o.bind(null,"d9Wp")).then((function(e){return e.TsDataModule}))}},{path:"ppa",loadChildren:function(){return Promise.all([o.e(2),o.e(3),o.e(4),o.e(6),o.e(0),o.e(12)]).then(o.bind(null,"eJgY")).then((function(e){return e.PPAModule}))}},{path:"rhythmicity",loadChildren:function(){return Promise.all([o.e(2),o.e(3),o.e(4),o.e(0),o.e(17)]).then(o.bind(null,"ja10")).then((function(e){return e.RhythmicityModule}))}}]}],pi=((di=function e(){s(this,e)}).\u0275mod=h.Lb({type:di}),di.\u0275inj=h.Kb({factory:function(e){return new(e||di)},imports:[[l.f.forChild(hi)],l.f]}),di),vi=o("DkMi"),gi=o("YiFe"),yi=((mi=function e(){s(this,e)}).\u0275mod=h.Lb({type:mi}),mi.\u0275inj=h.Kb({factory:function(e){return new(e||mi)},providers:[],imports:[[u.c,gi.a]]}),mi),Si=((fi=function e(){s(this,e)}).\u0275mod=h.Lb({type:fi}),fi.\u0275inj=h.Kb({factory:function(e){return new(e||fi)},providers:[],imports:[[u.c,We.k]]}),fi),Ti=((bi=function e(){s(this,e)}).\u0275mod=h.Lb({type:bi}),bi.\u0275inj=h.Kb({factory:function(e){return new(e||bi)},imports:[[u.c,vi.a,yi,Si,pi]]}),bi)},"qnP+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("2Vo4"),r=n("fXoL"),c=1,o=function(){var e=function(){function e(){s(this,e),this.experimentStream=new i.a(null),this.id=c++}return a(e,[{key:"close",value:function(){this.experimentStream.complete()}},{key:"experiment",value:function(){return this.experimentStream}},{key:"push",value:function(e){this.experimentStream.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Jb({token:e,factory:e.\u0275fac}),e}()},vLYz:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n("fXoL"),r=n("BOp5"),c=n("ofXK"),o=["inputFieldM"];function u(e,t){if(1&e){var n=i.Ub();i.Tb(0,"div",11),i.Dc(1),i.Tb(2,"button",12),i.Zb("click",(function(){i.sc(n);var e=t.$implicit;return i.dc(2).remove(e)})),i.Tb(3,"span",13),i.Dc(4,"\xd7"),i.Sb(),i.Sb(),i.Sb()}if(2&e){var r=t.$implicit;i.Bb(1),i.Fc(" ",r.name," ")}}function l(e,t){if(1&e&&(i.Tb(0,"div",8),i.Tb(1,"div",9),i.Tb(2,"label"),i.Dc(3,"Files:"),i.Sb(),i.Sb(),i.Bc(4,u,5,1,"div",10),i.Sb()),2&e){var n=i.dc();i.Bb(4),i.jc("ngForOf",n.files)}}function d(e,t){if(1&e){var n=i.Ub();i.Tb(0,"input",14,15),i.Zb("change",(function(e){return i.sc(n),i.dc().handleFileSelect(e)})),i.Sb()}}function b(e,t){if(1&e){var n=i.Ub();i.Tb(0,"input",16,15),i.Zb("change",(function(e){return i.sc(n),i.dc().handleFileSelect(e)})),i.Sb()}}function f(e,t){if(1&e&&(i.Tb(0,"div",17),i.Dc(1),i.Sb()),2&e){var n=i.dc();i.Bb(1),i.Fc(" Maximum upload size is ",n.sizeLimit,"MB ")}}var m=function(){var e=function(){function e(){s(this,e),this.activeColor="green",this.baseColor="#ccc",this.overlayColor="rgba(255,255,255,0.5)",this.blocked=!1,this.multiple=!0,this.noDuplicates=!0,this.autoReset=!1,this.sizeLimit=50,this.uploadFiles=new i.o,this.selectedFiles=new i.o,this.dragging=!1,this.loaded=!1,this.sizeError=!1,this.files=[]}return a(e,[{key:"ngOnInit",value:function(){}},{key:"reset",value:function(){this.files=[],this.inputField&&this.inputField.nativeElement&&(this.inputField.nativeElement.value="")}},{key:"handleDragEnter",value:function(){this.dragging=!0}},{key:"handleDragLeave",value:function(){this.dragging=!1}},{key:"handleDrop",value:function(e){e.preventDefault(),this.dragging=!1,e.dataTransfer&&this.handleFileChange(e.dataTransfer.files)}},{key:"handleFileSelect",value:function(e){e.target&&this.handleFileChange(e.target.files)}},{key:"handleFileChange",value:function(e){var t=this.multiple?e.length:Math.min(1,e.length);this.multiple||(this.files=[]);for(var n=0;n<t;n++){var i=e[n];this.noDuplicates&&this.removeDuplicate(i),this.files.push(i)}this.checkSize(),this.selectedFiles.next(this.files)}},{key:"remove",value:function(e){Object(r.b)(e,this.files),this.checkSize()}},{key:"removeDuplicate",value:function(e){var t=this.files.find((function(t){return t.name===e.name}));this.remove(t)}},{key:"checkSize",value:function(){var e=0;this.files.map((function(e){return e.size})).forEach((function(t){return e+=t})),e/=1048576,this.sizeError=e>this.sizeLimit}},{key:"upload",value:function(){this.uploadFiles.next(this.files),this.autoReset&&this.reset()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Hb({type:e,selectors:[["bd2-file-upload-widget"]],viewQuery:function(e,t){var n;1&e&&i.Ic(o,!0),2&e&&i.pc(n=i.ac())&&(t.inputField=n.first)},inputs:{activeColor:"activeColor",baseColor:"baseColor",overlayColor:"overlayColor",blocked:"blocked",multiple:"multiple",noDuplicates:"noDuplicates",autoReset:"autoReset",sizeLimit:"sizeLimit"},outputs:{uploadFiles:"uploadFiles",selectedFiles:"selectedFiles"},decls:13,vars:9,consts:[["class","clearfix","style","margin-bottom: 1em;",4,"ngIf"],[2,"margin-bottom","1em"],["ondragover","return false;",1,"uploader-zone",3,"dragenter","dragleave","drop"],[1,"material-icons","bd-icon","bd-primary",2,"font-size","400%"],["multiple","","name","inputField","type","file",3,"change",4,"ngIf"],["name","inputField","type","file",3,"change",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-sm",3,"disabled","click"],[1,"clearfix",2,"margin-bottom","1em"],[1,""],["class","float-left fileitem",4,"ngFor","ngForOf"],[1,"float-left","fileitem"],["aria-label","Close","type","button",1,"close",2,"margin-left","0.5em",3,"click"],["aria-hidden","true"],["multiple","","name","inputField","type","file",3,"change"],["inputField",""],["name","inputField","type","file",3,"change"],[1,"alert","alert-danger"]],template:function(e,t){1&e&&(i.Tb(0,"div"),i.Bc(1,l,5,1,"div",0),i.Tb(2,"div",1),i.Tb(3,"label",2),i.Zb("dragenter",(function(){return t.handleDragEnter()}))("dragleave",(function(){return t.handleDragLeave()}))("drop",(function(e){return t.handleDrop(e)})),i.Tb(4,"i",3),i.Dc(5,"cloud_upload"),i.Sb(),i.Tb(6,"p"),i.Dc(7," Drag file(s) or click to select"),i.Sb(),i.Bc(8,d,2,0,"input",4),i.Bc(9,b,2,0,"input",5),i.Sb(),i.Sb(),i.Bc(10,f,2,1,"div",6),i.Tb(11,"button",7),i.Zb("click",(function(){return t.upload()})),i.Dc(12,"Upload selected "),i.Sb(),i.Sb()),2&e&&(i.Bb(1),i.jc("ngIf",t.files.length>0),i.Bb(2),i.yc("outline-color",t.dragging?t.activeColor:t.baseColor),i.Fb("loaded",t.loaded),i.Bb(5),i.jc("ngIf",t.multiple),i.Bb(1),i.jc("ngIf",!t.multiple),i.Bb(1),i.jc("ngIf",t.sizeError),i.Bb(1),i.jc("disabled",t.blocked||t.files.length<1||t.sizeError))},directives:[c.m,c.l],styles:[".uploader-zone[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.uploader-zone[_ngcontent-%COMP%]{font-weight:400;align-items:center;background-color:#efefef;background-color:rgba(0,0,0,.02);cursor:pointer;display:flex;height:100px;justify-content:center;outline:3px dashed #ccc}div.fileitem[_ngcontent-%COMP%]{margin:2px;padding:2px;border:1px solid #efefef;border-radius:4px}"]}),e}()},vejM:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("fXoL"),r=n("UsWK"),c=function(){var e=function(){function e(t){s(this,e),this.BD2REST=t,this.visited=new Set,console.log("RDMSocialServiceService created")}return a(e,[{key:"getAssayGuiAspects",value:function(e){var t=this;return this.BD2REST.rdmAssayGuiAspects(e.id).then((function(n){return t.visited.add(e.id),n}))}},{key:"shouldShowMeasurementWarning",value:function(e){return e.security.isOwner?this.visited.has(e.id)?Promise.resolve(!1):this.getAssayGuiAspects(e).then((function(e){return e.showMeasurementWarning})):Promise.resolve(!1)}},{key:"registerNewAssay",value:function(e){this.visited.add(e.id)}},{key:"registerMeasurementWarning",value:function(e){this.BD2REST.rdmRegisterWarning(e.id,"MEASUREMENT").then((function(e){return!0}))}},{key:"canProceedByMeasurement",value:function(e){return e.security.isOwner?this.getAssayGuiAspects(e).then((function(e){return e.canProceedByMeasurement})):Promise.resolve(!0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Xb(r.a))},e.\u0275prov=i.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},yYXI:function(e,n,r){"use strict";r.d(n,"a",(function(){return d}));var c=r("TPWj"),o=r("pLZG"),u=r("fXoL"),l=r("GVyA"),d=function(){var e=function(e){t(r,e);var n=i(r);function r(e){var t;return s(this,r),(t=n.call(this)).serviceDependencies=e,t.experimentService=e.experimentService,t.currentExperiment=e.currentExperiment,t.feedback=e.feedback,t.router=e.router,t.titleSetter=e.titleSetter,t.titlePart="",t}return a(r,[{key:"ngOnInit",value:function(){this.subscribeToExperiment()}},{key:"ngOnDestroy",value:function(){this.unsubscribeFromExperiment()}},{key:"getModel",value:function(){return this.assay}},{key:"updateModel",value:function(e){this.assay=e,this.setTitle()}},{key:"setTitle",value:function(){this.titleSetter.setTitle("Exp "+this.assay.id+this.titlePart)}},{key:"subscribeToExperiment",value:function(){var e=this;this.expSubscription=this.currentExperiment.experiment().pipe(Object(o.a)((function(e){return!!e}))).subscribe((function(t){e.updateModel(t)}),(function(t){return e.feedback.error(t)}),(function(){return console.log(e.constructor.name+" expSubscription completed")}))}},{key:"refreshModel",value:function(){var e=this;return this.experimentService.getExperiment(this.assay.id).then((function(t){return e.currentExperiment.push(t),t}))}},{key:"unsubscribeFromExperiment",value:function(){this.expSubscription&&this.expSubscription.unsubscribe()}},{key:"expHomePath",value:function(e){return["/experiment",e=e||this.assay.id]}},{key:"goToExpHome",value:function(e){this.router.navigate(this.expHomePath(e))}},{key:"goToExpEdit",value:function(e,t){var n=this.expHomePath(e);n.push("edit"),t?this.router.navigate(n,{fragment:t}):this.router.navigate(n)}}]),r}(c.a);return e.\u0275fac=function(t){return new(t||e)(u.Nb(l.a))},e.\u0275dir=u.Ib({type:e,features:[u.yb]}),e}()}}])}();