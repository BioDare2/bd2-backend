!function(){function t(e,r,n){return(t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(e,r,n||e)}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=a(t);if(e){var i=a(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return o(this,r)}}function o(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"117B":function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n=r("fXoL"),o=r("3Pt+"),a=r("BOp5"),s=r("B9cw"),l=r("QBpm"),u=r("QibW"),b=r("1jcm"),d=r("ofXK");function p(t,e){if(1&t&&(n.Tb(0,"option",20),n.Dc(1),n.ec(2,"date"),n.Sb()),2&t){var r=e.$implicit,o=n.dc();n.jc("value",r.jobId),n.Bb(1),n.Hc(" ",r.method,": ",o.shortUUID(r.jobId)," (",n.fc(2,4,o.toLocalDateTime(r.submitted)),") ")}}function h(t,e){if(1&t&&(n.Tb(0,"option",20),n.Dc(1),n.ec(2,"date"),n.Sb()),2&t){var r=e.$implicit,o=n.dc();n.jc("value",r.jobId),n.Bb(1),n.Hc(" ",o.friendlyRhythmMethod(r.parameters.METHOD),": ",o.shortUUID(r.jobId)," (",n.fc(2,4,o.toLocalDateTime(r.jobStatus.submitted)),") ")}}var f=function(){var t=function(){function t(e,r){i(this,t),this.fb=e,this.fetcher=r,this.sorting=new n.o,this.noPPA=!0,this.noRhythm=!0,this._rhythmJobs=[],this._ppaJobs=[],this.sortParamsForm=this.buildSortParamsForm(e),this.mainForm=this.buildMainForm(this.sortParamsForm,e),this.ppaJobs=[],this.rhythmJobs=[]}return c(t,[{key:"ngOnInit",value:function(){var t=this;this.valuesSubscription=this.mainForm.valueChanges.subscribe((function(e){var r=e;r.direction=e.isAscending?"asc":"desc",t.sorting.next(r),t.fetcher&&t.fetcher.sort(r)}))}},{key:"ngOnDestroy",value:function(){this.valuesSubscription&&this.valuesSubscription.unsubscribe(),this.sorting&&this.sorting.complete()}},{key:"buildSortParamsForm",value:function(t){return t.group({active:[this.defaultSorting(),[o.B.required]],isAscending:[!0,[o.B.required]],ppaJobId:[],rhythmJobId:[]})}},{key:"buildMainForm",value:function(t,e){return t}},{key:"defaultSorting",value:function(){return"NR"}},{key:"shortUUID",value:function(t){return Object(a.c)(t)}},{key:"toLocalDateTime",value:function(t){return s.b.deserialize(t).date}},{key:"friendlyRhythmMethod",value:function(t){return"BD2JTK"===t?"JTK":"BD2EJTK"===t?"eJTK":t}},{key:"rhythmJobs",set:function(t){this._rhythmJobs=t,this.noRhythm=!t||t.length<1,this.sortParamsForm.get("rhythmJobId").setValue(this.noRhythm?void 0:t[0].jobId)},get:function(){return this._rhythmJobs}},{key:"ppaJobs",set:function(t){this._ppaJobs=t,this.noPPA=!t||t.length<1,this.sortParamsForm.get("ppaJobId").setValue(this.noPPA?void 0:t[0].jobId)},get:function(){return this._ppaJobs}}]),t}();return t.\u0275fac=function(e){return new(e||t)(n.Nb(o.e),n.Nb(l.a,8))},t.\u0275cmp=n.Hb({type:t,selectors:[["bd2-tssort-params-rform"]],inputs:{rhythmJobs:"rhythmJobs",ppaJobs:"ppaJobs"},outputs:{sorting:"sorting"},decls:42,vars:10,consts:[[1,"container"],["role","form",3,"formGroup"],["aria-label","Sorting options","formControlName","active"],[1,"row","mb-1"],[1,"col-lg-2"],[1,"col-lg-4"],["formControlName","isAscending"],[1,"col-lg-5"],["value","NR"],["value","LABEL"],["id","ppa","aria-label","Select period analysis","formControlName","ppaJobId",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["value","PERIOD",3,"disabled"],["value","PHASE",3,"disabled"],["value","AMP",3,"disabled"],["value","ERR",3,"disabled"],["id","rhythm","aria-label","Select rhythmicity test","formControlName","rhythmJobId",1,"form-control"],["value","R_TAU",3,"disabled"],["value","R_PEAK",3,"disabled"],["value","R_PERIOD",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(n.Tb(0,"div",0),n.Tb(1,"form",1),n.Tb(2,"mat-radio-group",2),n.Tb(3,"div",3),n.Tb(4,"label",4),n.Dc(5,"Sort"),n.Sb(),n.Tb(6,"div",5),n.Tb(7,"mat-slide-toggle",6),n.Dc(8,"asc."),n.Sb(),n.Sb(),n.Tb(9,"div",7),n.Tb(10,"mat-radio-button",8),n.Dc(11,"nr."),n.Sb(),n.Tb(12,"mat-radio-button",9),n.Dc(13,"label"),n.Sb(),n.Sb(),n.Sb(),n.Tb(14,"div",3),n.Tb(15,"label",4),n.Dc(16,"PPA Analysis"),n.Sb(),n.Tb(17,"div",5),n.Tb(18,"select",10),n.Bc(19,p,3,6,"option",11),n.Sb(),n.Sb(),n.Tb(20,"div",7),n.Tb(21,"mat-radio-button",12),n.Dc(22,"period"),n.Sb(),n.Tb(23,"mat-radio-button",13),n.Dc(24,"phase"),n.Sb(),n.Tb(25,"mat-radio-button",14),n.Dc(26,"amp."),n.Sb(),n.Tb(27,"mat-radio-button",15),n.Dc(28,"err"),n.Sb(),n.Sb(),n.Sb(),n.Tb(29,"div",3),n.Tb(30,"label",4),n.Dc(31,"Rhythmicity Test"),n.Sb(),n.Tb(32,"div",5),n.Tb(33,"select",16),n.Bc(34,h,3,6,"option",11),n.Sb(),n.Sb(),n.Tb(35,"div",7),n.Tb(36,"mat-radio-button",17),n.Dc(37,"signif."),n.Sb(),n.Tb(38,"mat-radio-button",18),n.Dc(39,"peak"),n.Sb(),n.Tb(40,"mat-radio-button",19),n.Dc(41,"length"),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb(),n.Sb()),2&t&&(n.Bb(1),n.jc("formGroup",e.mainForm),n.Bb(18),n.jc("ngForOf",e.ppaJobs),n.Bb(2),n.jc("disabled",e.noPPA),n.Bb(2),n.jc("disabled",e.noPPA),n.Bb(2),n.jc("disabled",e.noPPA),n.Bb(2),n.jc("disabled",e.noPPA),n.Bb(7),n.jc("ngForOf",e.rhythmJobs),n.Bb(2),n.jc("disabled",e.noRhythm),n.Bb(2),n.jc("disabled",e.noRhythm),n.Bb(2),n.jc("disabled",e.noRhythm))},directives:[o.D,o.r,o.i,u.b,o.q,o.h,b.a,u.a,o.A,d.l,o.u,o.C],pipes:[d.e],styles:["mat-radio-button[_ngcontent-%COMP%] {\n        margin-right: 0.5em;\n      }"]}),t}()},K5d1:function(t,e,r){"use strict";r.d(e,"a",(function(){return d}));var n=r("XNiG"),o=r("2Vo4"),a=r("PkFh"),s=r("7jps"),l=r("fXoL"),u=r("ETLL"),b=r("FjDX"),d=function(){var t=function(){function t(e,r){i(this,t),this.ppa=e,this.rhythmicity=r,this.error$=new n.a,this.allowedPPAMethods=void 0,this.allowedRhythmMethods=void 0,this.ppaJobs=new o.a([]),this.rhythmJobs=new o.a([]),this.ppaJobs$=this.ppaJobs.asObservable(),this.rhythmJobs$=this.rhythmJobs.asObservable()}return c(t,[{key:"ngOnDestroy",value:function(){this.ppaJobs.complete(),this.rhythmJobs.complete()}},{key:"experiment",value:function(t){this.fetchPPA(t),this.fetchRhythm(t)}},{key:"fetchPPA",value:function(t){var e=this;this.ppa.getPPAJobs(t).subscribe((function(t){t=t.filter((function(t){return a.c.isFinished(t)})),e.allowedPPAMethods&&(t=t.filter((function(t){return e.allowedPPAMethods.includes(t.method)}))),e.ppaJobs.next(t)}),(function(t){e.error$.next(t),e.ppaJobs.next([])}))}},{key:"fetchRhythm",value:function(t){var e=this;this.rhythmicity.getJobs(t).subscribe((function(t){t=t.filter((function(t){return s.e.isFinished(t)})),e.allowedRhythmMethods&&(t=t.filter((function(t){return e.allowedRhythmMethods.includes(t.parameters.METHOD)}))),e.rhythmJobs.next(t)}),(function(t){e.error$.next(t),e.rhythmJobs.next([])}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(l.Xb(u.a),l.Xb(b.a))},t.\u0275prov=l.Jb({token:t,factory:t.\u0275fac}),t}()},d9Wp:function(r,o,s){"use strict";s.r(o),s.d(o,"TsDataModule",(function(){return X}));var l=s("ofXK"),u=s("tyNb"),b=s("yYXI"),d=s("bngM"),p=s("QBpm"),h=s("e8YO"),f=s("Kj3r"),m=s("Iab2"),y=s("K5d1"),v=s("fXoL"),g=s("vejM"),S=s("ZMwR"),T=s("GVyA"),P=s("wcxA"),D=s("3Pt+"),w=s("1jcm"),k=s("M9IT");function O(t,e){if(1&t&&(v.Tb(0,"option",28),v.Dc(1),v.Sb()),2&t){var r=e.$implicit;v.jc("value",r.name),v.Bb(1),v.Ec(r.label)}}function j(t,e){if(1&t&&(v.Tb(0,"option",28),v.Dc(1),v.Sb()),2&t){var r=e.$implicit;v.jc("value",r.name),v.Bb(1),v.Ec(r.label)}}function x(t,e){if(1&t&&(v.Tb(0,"option",28),v.Dc(1),v.Sb()),2&t){var r=e.$implicit;v.jc("value",r.name),v.Bb(1),v.Ec(r.label)}}var J,E=function(){return[10,25,50,100,200]},B=((J=function(t){e(o,t);var r=n(o);function o(t){return i(this,o),r.call(this,t)}return o}(P.a)).\u0275fac=function(t){return new(t||J)(v.Nb(D.e))},J.\u0275cmp=v.Hb({type:J,selectors:[["bd2-tsdisplay-params-rform"]],inputs:{disabled:"disabled",totalTraces:"totalTraces",currentPage:"currentPage"},outputs:{displayParams:"displayParams"},features:[v.yb],decls:47,vars:10,consts:[["role","form",1,"form-horizontal","container",3,"formGroup"],[1,"row"],[1,"col-md-8","col-sm-10"],["formGroupName","timeScale",1,"form-group","row"],[1,"col-md-3","col-sm-3"],["for","timeStart",1,"col-md-1","col-sm-2"],["type","number","step","any","min","0","size","5","id","timeStart","required","","formControlName","timeStart",1,"form-control"],["for","timeEnd",1,"col-md-1","col-sm-1"],["type","number","step","any","min","0","size","5","required","","id","timeEnd","formControlName","timeEnd",1,"form-control"],[1,"col-md-2","col-sm-4"],["formControlName","hourly",1,"mr-3"],[1,"form-group","row"],["for","detrending",1,"col-sm-2"],[1,"col-sm-3"],["required","","id","detrending","formControlName","detrending",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-1"],["for","align",1,"col-sm-1"],["required","","id","align","formControlName","align",1,"form-control"],[1,"col-sm-2"],["for","normalisation"],["required","","id","normalisation","formControlName","normalisation",1,"form-control"],[1,"col-sm"],["formControlName","trimFirst",1,"mr-3"],["formControlName","log2"],[1,"col-sm-8"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["dataPaginator",""],[3,"value"]],template:function(t,e){1&t&&(v.Tb(0,"form",0),v.Tb(1,"div",1),v.Tb(2,"div",2),v.Tb(3,"div",3),v.Tb(4,"label",4),v.Dc(5,"Time range"),v.Sb(),v.Tb(6,"label",5),v.Dc(7,"from:"),v.Sb(),v.Tb(8,"div",4),v.Ob(9,"input",6),v.Sb(),v.Tb(10,"label",7),v.Dc(11,"to:"),v.Sb(),v.Tb(12,"div",4),v.Ob(13,"input",8),v.Sb(),v.Sb(),v.Sb(),v.Tb(14,"div",9),v.Tb(15,"mat-slide-toggle",10),v.Dc(16,"hourly"),v.Sb(),v.Sb(),v.Sb(),v.Tb(17,"div",11),v.Tb(18,"label",12),v.Dc(19,"Detrending"),v.Sb(),v.Tb(20,"div",13),v.Tb(21,"select",14),v.Bc(22,O,2,2,"option",15),v.Sb(),v.Sb(),v.Ob(23,"div",16),v.Tb(24,"label",17),v.Dc(25,"Align"),v.Sb(),v.Tb(26,"div",13),v.Tb(27,"select",18),v.Bc(28,j,2,2,"option",15),v.Sb(),v.Sb(),v.Sb(),v.Tb(29,"div",11),v.Tb(30,"div",19),v.Tb(31,"label",20),v.Dc(32,"Normalize"),v.Sb(),v.Sb(),v.Tb(33,"div",13),v.Tb(34,"select",21),v.Bc(35,x,2,2,"option",15),v.Sb(),v.Sb(),v.Tb(36,"div",22),v.Tb(37,"mat-slide-toggle",23),v.Dc(38,"within range"),v.Sb(),v.Tb(39,"mat-slide-toggle",24),v.Dc(40,"log2 transf."),v.Sb(),v.Sb(),v.Sb(),v.Ob(41,"div",11),v.Tb(42,"div",11),v.Ob(43,"label",19),v.Tb(44,"div",25),v.Tb(45,"mat-paginator",26,27),v.Zb("page",(function(t){return e.loadDataPage(t)})),v.Sb(),v.Sb(),v.Sb(),v.Sb()),2&t&&(v.jc("formGroup",e.mainForm),v.Bb(22),v.jc("ngForOf",e.detrendingOptions),v.Bb(6),v.jc("ngForOf",e.alignOptions),v.Bb(7),v.jc("ngForOf",e.normalisationOptions),v.Bb(10),v.jc("length",e.totalTraces)("disabled",e.disabledPagination)("pageSize",e.currentPage.pageSize)("pageIndex",e.currentPage.pageIndex)("pageSizeOptions",v.lc(9,E)))},directives:[D.D,D.r,D.i,D.j,D.v,D.d,D.z,D.q,D.h,w.a,D.A,l.l,k.a,D.u,D.C],encapsulation:2}),J),I=s("7EHt"),A=s("117B"),C=s("nA4b");function M(t,e){if(1&t){var r=v.Ub();v.Tb(0,"div",8),v.Dc(1,"Please complete "),v.Tb(2,"a",9),v.Zb("click",(function(){v.sc(r);var t=v.dc(2);return t.goToExpEdit(t.assay.id,"MeasurementSection")})),v.Dc(3,"Measurement details"),v.Sb(),v.Dc(4," to get access to the secondary data "),v.Sb()}}function R(t,e){if(1&t){var r=v.Ub();v.Tb(0,"div",10),v.Tb(1,"label",11),v.Tb(2,"a",12),v.Zb("click",(function(){return v.sc(r),v.dc(2).exportDataView()})),v.Tb(3,"i",13),v.Dc(4,"save_alt"),v.Sb(),v.Tb(5,"span",14),v.Dc(6,"Download"),v.Sb(),v.Sb(),v.Dc(7," current view "),v.Sb(),v.Tb(8,"label",11),v.Tb(9,"a",15),v.Zb("click",(function(){return v.sc(r),v.dc(2).exportFullData()})),v.Tb(10,"i",13),v.Dc(11,"save_alt"),v.Sb(),v.Tb(12,"span",14),v.Dc(13,"Download"),v.Sb(),v.Sb(),v.Dc(14," full "),v.Sb(),v.Sb()}}function F(t,e){if(1&t&&v.Ob(0,"bd2-ts-plots",16),2&t){var r=v.dc(2);v.jc("tracesPerPlot",r.tracesPerPlot)("data",r.timeseries)}}function N(t,e){if(1&t){var r=v.Ub();v.Tb(0,"div"),v.Tb(1,"h3"),v.Dc(2,"Show timeseries"),v.Sb(),v.Ob(3,"hr"),v.Tb(4,"bd2-tsdisplay-params-rform",1),v.Zb("displayParams",(function(t){return v.sc(r),v.dc().displayChanged(t)})),v.Sb(),v.Tb(5,"mat-expansion-panel"),v.Tb(6,"mat-expansion-panel-header"),v.Tb(7,"mat-panel-title"),v.Dc(8," Sorting "),v.Sb(),v.Sb(),v.Ob(9,"bd2-tssort-params-rform",2),v.ec(10,"async"),v.ec(11,"async"),v.Sb(),v.Bc(12,M,5,0,"div",3),v.Ob(13,"hr"),v.Tb(14,"div",4),v.Dc(15," Hint: You can click on trace label box to remove it from the plot. "),v.Sb(),v.Tb(16,"div",5),v.Bc(17,R,15,0,"div",6),v.Sb(),v.Ob(18,"hr"),v.Bc(19,F,1,2,"bd2-ts-plots",7),v.Sb()}if(2&t){var n=v.dc();v.Bb(4),v.jc("disabled",n.disabledSecondary)("totalTraces",n.totalTraces)("currentPage",n.currentPage),v.Bb(5),v.jc("ppaJobs",v.fc(10,8,n.analysis.ppaJobs$))("rhythmJobs",v.fc(11,10,n.analysis.rhythmJobs$)),v.Bb(3),v.jc("ngIf",n.disabledSecondary),v.Bb(5),v.jc("ngIf",n.timeseries),v.Bb(2),v.jc("ngIf",n.timeseries)}}var _,L,z,H=[{path:"",children:[{path:"view/ts",component:(_=function(r){e(s,r);var o=n(s);function s(t,e,r,n,a){var c;return i(this,s),(c=o.call(this,a)).analysis=t,c.fetcher=e,c.RDMSocial=r,c.analytics=n,c.timeseries=[],c.totalTraces=0,c.currentPage=d.a.firstPage(),c.tracesPerPlot=5,c.blocked=!1,c.disabledSecondary=!1,c.csvExporter=new h.a,t.allowedPPAMethods=["NLLS","MESA"],c.titlePart=" Data",c}return c(s,[{key:"ngOnInit",value:function(){var e=this;t(a(s.prototype),"ngOnInit",this).call(this),this.timeSeriesSubsripction=this.fetcher.seriesPackStream.pipe(Object(f.a)(1e3)).subscribe((function(t){if(e.assay){var r=t.data;e.currentParams=t.params,e.timeseries=r,e.tracesPerPlot=Math.max(5,r.length/20),e.totalTraces=t.totalTraces,e.currentPage=t.currentPage,e.analytics.experimentDataView(e.assay.id)}}),(function(t){console.log("Error in TS subscription: "+t),e.feedback.error(t)})),this.fetcher.error$.subscribe((function(t){return e.feedback.error(t)}))}},{key:"ngOnDestroy",value:function(){this.timeSeriesSubsripction&&this.timeSeriesSubsripction.unsubscribe(),this.fetcher.ngOnDestroy(),t(a(s.prototype),"ngOnDestroy",this).call(this)}},{key:"displayChanged",value:function(t){this.fetcher.changeDisplayParams(t)}},{key:"exportDataView",value:function(){this.exportSeriesPack(this.fetcher.current)}},{key:"exportFullData",value:function(){var t=this;this.fetcher.getFullDataSet(this.assay,this.fetcher.current.params,this.fetcher.current.sorting).subscribe((function(e){t.exportSeriesPack(e,!0)}))}},{key:"exportSeriesPack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var r=this.csvExporter.renderCSVTable(t.data,t.params,t.currentPage,t.sorting,this.assay),n=new Blob([r],{type:"text/csv"});m.saveAs(n,"".concat(this.assay.id,"_data.").concat(t.params.detrending.name).concat(e?".full":".page"+(t.currentPage.pageIndex+1),".csv")),this.recordExport()}}},{key:"recordExport",value:function(){this.analytics.experimentDataExport(this.assay.id)}},{key:"updateModel",value:function(e){var r=this;t(a(s.prototype),"updateModel",this).call(this,e),this.RDMSocial.canProceedByMeasurement(e).then((function(t){r.disabledSecondary=!t})),this.fetcher.experiment(e),this.analysis.experiment(e)}}]),s}(b.a),_.\u0275fac=function(t){return new(t||_)(v.Nb(y.a),v.Nb(p.a),v.Nb(g.a),v.Nb(S.a),v.Nb(T.a))},_.\u0275cmp=v.Hb({type:_,selectors:[["ng-component"]],features:[v.Ab([p.a,y.a]),v.yb],decls:1,vars:1,consts:[[4,"ngIf"],[3,"disabled","totalTraces","currentPage","displayParams"],[3,"ppaJobs","rhythmJobs"],["type","danger","class","alert alert-danger","role","alert",4,"ngIf"],["type","info","role","alert","dismissible","true","dismissOnTimeout","20000",1,"alert","alert-info"],[1,"clearfix"],["class","float-right",4,"ngIf"],[3,"tracesPerPlot","data",4,"ngIf"],["type","danger","role","alert",1,"alert","alert-danger"],[3,"click"],[1,"float-right"],[1,"mr-4"],["download","","role","button","aria-label","download",1,"btn","btn-primary",2,"color","white",3,"click"],[1,"material-icons","bd-icon"],[1,"cdk-visually-hidden"],["download","","role","button","aria-label","download whole",1,"btn","btn-primary",2,"color","white",3,"click"],[3,"tracesPerPlot","data"]],template:function(t,e){1&t&&v.Bc(0,N,20,12,"div",0),2&t&&v.jc("ngIf",e.assay)},directives:[l.m,B,I.b,I.c,I.d,A.a,C.a],pipes:[l.b],encapsulation:2}),_)},{path:"view/heatmap",loadChildren:function(){return Promise.all([s.e(6),s.e(19)]).then(s.bind(null,"QftV")).then((function(t){return t.TsHeatmapModule}))}},{path:"ts-old-import",loadChildren:function(){return Promise.all([s.e(0),s.e(18)]).then(s.bind(null,"9Gw/")).then((function(t){return t.TsOldImportModule}))}},{path:"ts-import",loadChildren:function(){return Promise.all([s.e(0),s.e(20)]).then(s.bind(null,"yPAH")).then((function(t){return t.TsImportModule}))}}]}],$=((L=function t(){i(this,t)}).\u0275mod=v.Lb({type:L}),L.\u0275inj=v.Kb({factory:function(t){return new(t||L)},imports:[[u.f.forChild(H)],u.f]}),L),K=s("YiFe"),U=s("a6j2"),V=s("ZTEM"),X=((z=function t(){i(this,t)}).\u0275mod=v.Lb({type:z}),z.\u0275inj=v.Kb({factory:function(t){return new(t||z)},imports:[[l.c,D.k,D.y,K.a,U.a,$,V.a]]}),z)},e8YO:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=function(){function t(e){i(this,t),this.rows=new Map,this.nextColumn=0,this.sorted=!0,null!=e&&(this.sorted=e)}return c(t,[{key:"append",value:function(t,e){this.put(t,e,this.nextColumn)}},{key:"put",value:function(t,e,r){this._put(t,e,r),this.nextColumn=Math.max(this.nextColumn,r+1)}},{key:"putColumn",value:function(t,e,r){var n=this;t.forEach((function(t,o){n._put(t,e[o],r)})),this.nextColumn=Math.max(this.nextColumn,r+1)}},{key:"appendColumn",value:function(t,e){this.putColumn(t,e,this.nextColumn)}},{key:"getValue",value:function(t,e){var r=this.rows.get(t);return r?r[e]:void 0}},{key:"getRow",value:function(t){return this.rows.get(t)}},{key:"forEach",value:function(t){var e=this;this.keys().forEach((function(r,n){var o={key:r,columns:e.rows.get(r)};t(o,n,e)}))}},{key:"forEachFlat",value:function(t){var e=this;this.keys().forEach((function(r,n){var o=[r].concat(e.rows.get(r));t(o,n,e)}))}},{key:"keys",value:function(){return this.sorted?Array.from(this.rows.keys()).sort((function(t,e){return t==e?0:t<e?-1:1})):Array.from(this.rows.keys())}},{key:"_put",value:function(t,e,r){var n=this.rows.get(t);n||(n=[],this.rows.set(t,n)),n[r]=e}},{key:"width",get:function(){return this.nextColumn}},{key:"size",get:function(){return this.rows.size}}]),t}(),o=function(){function t(){i(this,t),this.SEP=","}return c(t,[{key:"renderCSVTable",value:function(t,e,r,n,o){var a=this.prepareHeaders(o,e,r,n,t.length);this.appendDataLabels(a,t);var i=this.prepareDataTable(t),s=this.mapToString(a,this.SEP);return s+=this.mapToString(i,this.SEP)}},{key:"prepareHeaders",value:function(t,e,r,n,o){var a=this.prepareExpHeaders(t);return this.appendDisplayProperties(a,e),this.appendSortingProperties(a,n),this.appendDataProperties(a,o,r),a}},{key:"prepareExpHeaders",value:function(t){var e=new n(!1);return e.put("Exp Id:",""+t.id,0),e.put("Exp URL:","https://biodare2.ed.ac.uk/experiment/"+t.id,0),e.put("Exp Name:",t.name,0),t.contributionDesc.authors.forEach((function(t,r){e.put("Authors:",t.name,r)})),e}},{key:"appendDisplayProperties",value:function(t,e){t.put("Time range:",e.timeScaleLabel,0),t.put("Detrending:",e.detrending.label,0),e.hourly&&t.put("Hourly binned:","true",0),e.log2&&t.put("Log2 transform:",""+e.log2,0),t.put("Normalization:",e.normalisation,0),t.put("Normalization:",e.trimFirst?"within range":"whole serie",1),t.put("Align:",e.align,0)}},{key:"appendSortingProperties",value:function(t,e){t.put("Sorting:","".concat(e.active," ").concat(e.direction),0),t.put("Sorting jobs:","".concat(e.ppaJobId," ").concat(e.rhythmJobId),0)}},{key:"appendDataProperties",value:function(t,e,r){t.put("Traces",e+" of "+r.length,0);var n=Math.floor(r.length/r.pageSize)+(r.length%r.pageSize==0?0:1);t.put("Data Page",r.pageIndex+1+" of "+n,0)}},{key:"appendDataLabels",value:function(t,e){e.forEach((function(e,r){t.put("Label:",e.label,r)}))}},{key:"prepareDataTable",value:function(t){var e=new n;return t.forEach((function(t){var r=t.data.map((function(t){return t.x})),n=t.data.map((function(t){return t.y}));e.appendColumn(r,n)})),e}},{key:"mapToString",value:function(t,e){var r="";return t.forEachFlat((function(t){for(var n=0;n<t.length;n++)void 0!==t[n]&&(r+=t[n]),r+=e;r+="\n"})),r}}]),t}()}}])}();