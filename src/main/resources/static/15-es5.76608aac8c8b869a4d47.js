function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(s){i=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{ja10:function(e,t,n){"use strict";n.r(t);var r,i,a,o=n("ofXK"),c=n("tyNb"),s=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n))).rhythmicityService=e,r.titlePart=" Rhythm",r}return _inherits(t,e),_createClass(t,[{key:"goToRhythmicityHome",value:function(e){var t=this.expHomePath(e);t.push("rhythmicity"),this.router.navigate(t)}}]),t}(n("yYXI").a),u=n("fXoL"),l=n("2Vo4"),b=n("PqYM"),d=n("B9cw"),h=n("Iab2"),f=n("zQ7r"),p=n("Iurr"),m=n("tu3j"),y=n("lJxs"),v=n("UsWK"),g=((i=function(){function e(t){_classCallCheck(this,e),this.BD2REST=t}return _createClass(e,[{key:"newTest",value:function(e,t){return this.BD2REST.rhythmicityNew(e.id,t)}},{key:"getJob",value:function(e,t){return this.BD2REST.rhythmicityJob(e,t)}},{key:"getJobs",value:function(e){return this.BD2REST.rhythmicityJobs(e.id).pipe(Object(y.a)((function(e){return e.data})))}},{key:"getResults",value:function(e,t){return this.BD2REST.rhythmicityResults(e,t)}},{key:"exportURL",value:function(e){return this.BD2REST.ppaExportURL(e.id)}},{key:"deleteJob",value:function(e,t){return this.BD2REST.rhythmicityDeleteJob(e.id,t)}},{key:"downloadJob",value:function(e,t){return this.BD2REST.rhythmicityExportJob(e,t)}}]),e}()).\u0275fac=function(e){return new(e||i)(u.ac(v.a))},i.\u0275prov=u.Mb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),C=((r=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,r))).rhythmicityService=e,n.finishedJob$=n.finished$,n.runningJob$=n.running$,n.allJob$=n.all$,n}return _inherits(t,e),_createClass(t,[{key:"initIntervalsKeeper",value:function(){return new m.a(1e3,3e4,6e5,2)}},{key:"assayJob",value:function(e){this.input(e)}},{key:"sameInput",value:function(e,t){return e[1]===t[1]&&e[0]===t[0]}},{key:"fetchAsset",value:function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return this.rhythmicityService.getJob(n,r)}},{key:"hasFailed",value:function(e){return!!e&&!this.isFinished(e)&&!this.isRunning(e)}},{key:"isFinished",value:function(e){return!(!e||!e.jobStatus||"FINISHED"!==e.jobStatus.state&&"SUCCESS"!==e.jobStatus.state)}},{key:"isRunning",value:function(e){return!!e&&!(!e||!e.jobStatus||"SUBMITTED"!==e.jobStatus.state&&"PROCESSING"!==e.jobStatus.state)}},{key:"assetToId",value:function(e){return e.jobId}},{key:"assetToInput",value:function(e){return[e.parentId,e.jobId]}},{key:"currentJob",get:function(){return this.currentAsset}}]),t}(f.a)).\u0275fac=function(e){return new(e||r)(u.ac(g),u.ac(p.a,8))},r.\u0275prov=u.Mb({token:r,factory:r.\u0275fac}),r),k=n("M9IT"),V=n("vkgz"),P=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this._name=t,this._label=n}return _createClass(e,[{key:"toJSON",value:function(){return this.name}},{key:"name",get:function(){return this._name}},{key:"label",get:function(){return this._label}}],[{key:"get",value:function(t){return e.getValuesMap().get(t)}},{key:"getValuesMap",value:function(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}},{key:"initValuesMap",value:function(){var t=new Map;return e.values.forEach((function(e){return t.set(e.name,e)})),t}}]),e}();return e.BD2EJTK=new e("BD2EJTK","BD2 eJTK"),e.values=[e.BD2EJTK],e}(),w=[P.BD2EJTK],S=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this._name=t,this._label=n}return _createClass(e,[{key:"toJSON",value:function(){return this.name}},{key:"name",get:function(){return this._name}},{key:"label",get:function(){return this._label}}],[{key:"get",value:function(t){return e.getValuesMap().get(t)}},{key:"getValuesMap",value:function(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}},{key:"initValuesMap",value:function(){var t=new Map;return e.values.forEach((function(e){return t.set(e.name,e)})),t}}]),e}();return e.EJTK_CLASSIC=new e("EJTK_CLASSIC","eJTK Classic"),e.BD2_CLASSIC=new e("BD2_CLASSIC","BD2 Classic"),e.BD2_SPREAD=new e("BD2_SPREAD","Period range"),e.values=[e.EJTK_CLASSIC,e.BD2_CLASSIC,e.BD2_SPREAD],e}(),J=[S.EJTK_CLASSIC,S.BD2_CLASSIC],W=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isValid",value:function(){return!(this.windowStart<0||this.windowEnd<0||this.periodMin<=0||this.periodMax<=0||this.periodMin>this.periodMax||this.windowEnd>0&&this.windowStart>=this.windowEnd||null==this.method||null==this.preset||null==this.detrending)}}]),e}(),_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this.pValue=t,this.bhCorrection=n,this.showPattern=r,this.circadian=i}return _createClass(e,[{key:"clone",value:function(){return new e(this.pValue,this.bhCorrection,this.showPattern,this.circadian)}}]),e}(),I=n("8jiw"),T=((a=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,r))).rhythmicityService=e,n.results$=n.data$,n}return _inherits(t,e),_createClass(t,[{key:"sameInput",value:function(e,t){return function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"sameJob",value:function(e,t){return!(!e||!t)&&e.jobId===t.jobId&&e.parentId===t.parentId}}]),e}().sameJob(e,t)}},{key:"assetToData",value:function(e,t){return e.results}},{key:"fetchAsset",value:function(e){var t=this;return this.rhythmicityService.getResults(e.parentId,e.jobId).pipe(Object(V.a)((function(e){return t.labelPatterns(e)})))}},{key:"sortingKey",value:function(e){switch(e.active){case"label":return function(e){return e.label};case"id":return function(e){return+e.id};case"empp":return function(e){return+e.result.empP};case"emppbh":return function(e){return+e.result.empPBH};case"tau":return function(e){return+e.result.tau};case"period":return function(e){return e.result.pattern.period};case"peak":return function(e){return e.result.pattern.peak};case"trough":return function(e){return e.result.pattern.trough};default:return console.error("Not implemented sorting for "+e.active),function(e){return 0}}}},{key:"processData",value:function(e,t){return t?(this.rankResults(e,t.pValue,t.bhCorrection),e):e}},{key:"labelPatterns",value:function(e){var t=this;e.results.forEach((function(e){e.result.patternLabel=t.describePattern(e.result),e.result.pattern.shapeLabel=t.patternToShape(e.result.pattern)}))}},{key:"describePattern",value:function(e){var t=e.pattern,n=Math.round(10*t.period)/10,r=Math.round(100*t.peak)/100,i=Math.round(100*t.trough)/100;return"".concat(this.patternToShape(t),"\t").concat(n,"\t").concat(r,"\t").concat(i)}},{key:"patternToShape",value:function(e){switch(e.waveform){case"ASYM_COSINE":return"ACOS";case"ASYM_COS_SPIKE":return"SPIKE";case"ASYM_COS_SPIKE_NEG":return"NPIKE";default:return e.waveform}}},{key:"rankResults",value:function(e,t,n){e.forEach((function(e){var r=e.result;r.rhythmic=(n?r.empPBH:r.empP)<t}))}}]),t}(I.a)).\u0275fac=function(e){return new(e||a)(u.ac(g),u.ac(p.a,8))},a.\u0275prov=u.Mb({token:a,factory:a.\u0275fac}),a),R=n("6tuW"),O=n("+0xr"),j=n("Dh3D"),D=n("bv9b");function x(e,t){1&e&&u.Rb(0,"mat-progress-bar",26)}function H(e,t){1&e&&(u.Wb(0,"th",27),u.Jc(1,"Id"),u.Vb())}function E(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(n.id)}}function M(e,t){1&e&&(u.Wb(0,"th",27),u.Jc(1,"Label"),u.Vb())}function A(e,t){if(1&e&&(u.Wb(0,"td",29),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(n.label)}}function K(e,t){1&e&&(u.Wb(0,"th",30),u.Jc(1,"Rhythmic"),u.Vb())}function B(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Gb("bold",n.result.rhythmic),u.Cb(1),u.Kc(n.result.rhythmic)}}function $(e,t){1&e&&(u.Wb(0,"th",27),u.Jc(1,"emp-p"),u.Vb())}function L(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.empP,"1.0-5"))}}function U(e,t){1&e&&(u.Wb(0,"th",27),u.Jc(1,"BH emp-p"),u.Vb())}function N(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.empPBH,"1.0-5"))}}function z(e,t){1&e&&(u.Wb(0,"th",27),u.Jc(1,"Tau"),u.Vb())}function q(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.tau,"1.0-2"))}}function F(e,t){1&e&&(u.Wb(0,"th",30),u.Jc(1,"Pattern"),u.Vb())}function Q(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(n.result.patternLabel)}}function G(e,t){1&e&&(u.Wb(0,"th",30),u.Jc(1,"P.Shape"),u.Vb())}function X(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(n.result.pattern.shapeLabel)}}function Y(e,t){1&e&&(u.Wb(0,"th",27),u.Jc(1,"P.Period"),u.Vb())}function Z(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.pattern.period,"1.0-1"))}}function ee(e,t){1&e&&(u.Wb(0,"th",27),u.Jc(1,"P.Peak"),u.Vb())}function te(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.pattern.peak,"1.1-1"))}}function ne(e,t){1&e&&(u.Wb(0,"th",30),u.Jc(1,"P.Peak"),u.Vb())}function re(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,24*n.result.pattern.peak/n.result.pattern.period,"1.1-1"))}}function ie(e,t){1&e&&(u.Wb(0,"th",27),u.Jc(1,"P.Trough"),u.Vb())}function ae(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.pattern.trough,"1.1-1"))}}function oe(e,t){1&e&&(u.Wb(0,"th",30),u.Jc(1,"P.Trough"),u.Vb())}function ce(e,t){if(1&e&&(u.Wb(0,"td",28),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,24*n.result.pattern.trough/n.result.pattern.period,"1.1-1"))}}function se(e,t){1&e&&u.Rb(0,"tr",31)}function ue(e,t){1&e&&u.Rb(0,"tr",32)}var le,be=function(){return[10,25,50,100,250]},de=((le=function(){function e(t,n){_classCallCheck(this,e),this.fetcher=t,this.feedback=n,this.normPColumns=["id","label","rhythmic","empp","tau"],this.bhPColumns=["id","label","rhythmic","emppbh","tau"],this.patternColumns=["shape","period","peak","trough"],this.patternColumnsC=["shape","period","peakc","troughc"],this.displayedColumns=this.normPColumns,this.disablePaginator=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.fetcher.error$.subscribe((function(t){return e.feedback.error(t)}));var t=new k.d;t.pageSize=25,t.pageIndex=0,this.fetcher.page(t),this.fetcher.on(!0)}},{key:"ngOnDestroy",value:function(){this.fetcher.close()}},{key:"ngAfterViewInit",value:function(){}},{key:"reload",value:function(){this.fetcher.refresh()}},{key:"sortData",value:function(e){this.fetcher.sort(e)}},{key:"loadPage",value:function(e){this.fetcher.page(e)}},{key:"job",set:function(e){e&&this.fetcher.input(e)}},{key:"statTestParams",set:function(e){if(e){this.fetcher.params(e);var t=e.bhCorrection?this.bhPColumns:this.normPColumns;e.showPattern&&(t=t.concat(e.circadian?this.patternColumnsC:this.patternColumns)),this.displayedColumns=t}}}]),e}()).\u0275fac=function(e){return new(e||le)(u.Qb(T),u.Qb(R.a))},le.\u0275cmp=u.Kb({type:le,selectors:[["bd2-rhythmicity-results-mdtable"]],inputs:{job:"job",statTestParams:"statTestParams"},features:[u.Bb([T])],decls:49,vars:18,consts:[[1,"mat-elevation-z8"],["mode","indeterminate",4,"ngIf"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["paginator",""],["mat-table","","matSort","","aria-label","Results","matSort","","matSortActive","id","matSortDirection","asc",1,"full-width-table",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","label"],["mat-cell","","class","word_wrapping","style","max-width: 100px",4,"matCellDef"],["matColumnDef","rhythmic"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"bold",4,"matCellDef"],["matColumnDef","empp"],["matColumnDef","emppbh"],["matColumnDef","tau"],["matColumnDef","pattern"],["matColumnDef","shape"],["matColumnDef","period"],["matColumnDef","peak"],["matColumnDef","peakc"],["matColumnDef","trough"],["matColumnDef","troughc"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["paginator2",""],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",1,"word_wrapping",2,"max-width","100px"],["mat-header-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,t){1&e&&(u.Wb(0,"div",0),u.Hc(1,x,1,0,"mat-progress-bar",1),u.jc(2,"async"),u.Wb(3,"mat-paginator",2,3),u.ec("page",(function(e){return t.loadPage(e)})),u.Vb(),u.Wb(5,"table",4),u.ec("matSortChange",(function(e){return t.sortData(e)})),u.Ub(6,5),u.Hc(7,H,2,0,"th",6),u.Hc(8,E,2,1,"td",7),u.Tb(),u.Ub(9,8),u.Hc(10,M,2,0,"th",6),u.Hc(11,A,2,1,"td",9),u.Tb(),u.Ub(12,10),u.Hc(13,K,2,0,"th",11),u.Hc(14,B,2,3,"td",12),u.Tb(),u.Ub(15,13),u.Hc(16,$,2,0,"th",6),u.Hc(17,L,3,4,"td",7),u.Tb(),u.Ub(18,14),u.Hc(19,U,2,0,"th",6),u.Hc(20,N,3,4,"td",7),u.Tb(),u.Ub(21,15),u.Hc(22,z,2,0,"th",6),u.Hc(23,q,3,4,"td",7),u.Tb(),u.Ub(24,16),u.Hc(25,F,2,0,"th",11),u.Hc(26,Q,2,1,"td",7),u.Tb(),u.Ub(27,17),u.Hc(28,G,2,0,"th",11),u.Hc(29,X,2,1,"td",7),u.Tb(),u.Ub(30,18),u.Hc(31,Y,2,0,"th",6),u.Hc(32,Z,3,4,"td",7),u.Tb(),u.Ub(33,19),u.Hc(34,ee,2,0,"th",6),u.Hc(35,te,3,4,"td",7),u.Tb(),u.Ub(36,20),u.Hc(37,ne,2,0,"th",11),u.Hc(38,re,3,4,"td",7),u.Tb(),u.Ub(39,21),u.Hc(40,ie,2,0,"th",6),u.Hc(41,ae,3,4,"td",7),u.Tb(),u.Ub(42,22),u.Hc(43,oe,2,0,"th",11),u.Hc(44,ce,3,4,"td",7),u.Tb(),u.Hc(45,se,1,0,"tr",23),u.Hc(46,ue,1,0,"tr",24),u.Vb(),u.Wb(47,"mat-paginator",2,25),u.ec("page",(function(e){return t.loadPage(e)})),u.Vb(),u.Vb()),2&e&&(u.Cb(1),u.oc("ngIf",u.kc(2,14,t.fetcher.isBusy$)),u.Cb(2),u.oc("length",t.fetcher.dataLength)("disabled",t.disablePaginator)("pageSize",(null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageSize)||25)("pageIndex",null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageIndex)("pageSizeOptions",u.qc(16,be)),u.Cb(2),u.oc("dataSource",t.fetcher.results$),u.Cb(40),u.oc("matHeaderRowDef",t.displayedColumns),u.Cb(1),u.oc("matRowDefColumns",t.displayedColumns),u.Cb(1),u.oc("length",t.fetcher.dataLength)("disabled",t.disablePaginator)("pageSize",(null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageSize)||25)("pageIndex",null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageIndex)("pageSizeOptions",u.qc(17,be)))},directives:[o.m,k.a,O.n,j.a,O.c,O.i,O.b,O.k,O.m,D.a,O.h,j.b,O.a,O.j,O.l],pipes:[o.b,o.f],styles:[".full-width-table[_ngcontent-%COMP%] {\n      width: 100%;\n    }"]}),le),he=n("9+85"),fe=n("Wp6s"),pe=n("f0Cb"),me=n("Xa2L"),ye=n("3Pt+"),ve=n("kmnG"),ge=n("QibW");function Ce(e,t){if(1&e&&(u.Wb(0,"mat-radio-button",5),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n),u.Cb(1),u.Kc(n)}}var ke,Ve,Pe=((ke=function(){function e(){_classCallCheck(this,e),this.values=[1e-4,.001,.005,.01,.05,.1],this.pvalue=.001,this.pvalue$=new u.o}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.pvalue$.emit(this.pvalue)}},{key:"selected",value:function(e){this.pvalue$.emit(e.value)}}]),e}()).\u0275fac=function(e){return new(e||ke)},ke.\u0275cmp=u.Kb({type:ke,selectors:[["bd2-pvalue-form"]],outputs:{pvalue$:"pvalue$"},decls:8,vars:2,consts:[[1,"form-inline"],[1,"mx-auto","text-center"],["id","pvalues-label",1,"mb-1"],["aria-label","Select p-value","aria-labelledby","pvalues-label",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(u.Wb(0,"form",0),u.Wb(1,"div",1),u.Wb(2,"mat-label",2),u.Wb(3,"strong"),u.Jc(4,"p-value threshold:"),u.Vb(),u.Vb(),u.Wb(5,"div"),u.Wb(6,"mat-radio-group",3),u.ec("change",(function(e){return t.selected(e)})),u.Hc(7,Ce,2,2,"mat-radio-button",4),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e&&(u.Cb(6),u.oc("value",t.pvalue),u.Cb(1),u.oc("ngForOf",t.values))},directives:[ye.C,ye.q,ye.r,ve.f,ge.b,o.l,ge.a],styles:[".mat-radio-button[_ngcontent-%COMP%]  {\n      margin-right: 15px;\n    }"]}),ke),we=n("1jcm"),Se=((Ve=function(){function e(){_classCallCheck(this,e),this.options=new u.o,this.currentOptions=new _(0,!1,!1,!1)}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"pValue",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.pValue=e,this.options.next(this.currentOptions)}},{key:"bhCorrection",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.bhCorrection=e,this.options.next(this.currentOptions)}},{key:"circadian",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.circadian=e,this.options.next(this.currentOptions)}},{key:"showPattern",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.showPattern=e,this.options.next(this.currentOptions)}}]),e}()).\u0275fac=function(e){return new(e||Ve)},Ve.\u0275cmp=u.Kb({type:Ve,selectors:[["bd2-stat-test-options-widget"]],outputs:{options:"options"},decls:14,vars:1,consts:[[3,"pvalue$"],[2,"margin-top","0.5em","text-align","center"],[3,"change"],["pattern",""],[3,"disabled","change"]],template:function(e,t){if(1&e&&(u.Wb(0,"mat-card"),u.Wb(1,"mat-card-content"),u.Wb(2,"section"),u.Wb(3,"bd2-pvalue-form",0),u.ec("pvalue$",(function(e){return t.pValue(e)})),u.Vb(),u.Vb(),u.Wb(4,"section",1),u.Wb(5,"mat-slide-toggle",2),u.ec("change",(function(e){return t.bhCorrection(e.checked)})),u.Jc(6,"Benjamini Hochberg correction"),u.Vb(),u.Vb(),u.Wb(7,"section",1),u.Wb(8,"mat-slide-toggle",2,3),u.ec("change",(function(e){return t.showPattern(e.checked)})),u.Jc(10,"show pattern"),u.Vb(),u.Jc(11," \xa0 "),u.Wb(12,"mat-slide-toggle",4),u.ec("change",(function(e){return t.circadian(e.checked)})),u.Jc(13,"circadian unit"),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){var n=u.xc(9);u.Cb(12),u.oc("disabled",!n.checked)}},directives:[fe.a,fe.c,Pe,we.a],encapsulation:2}),Ve);function Je(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",5),u.Wb(1,"button",13),u.ec("click",(function(e){return u.Ac(n),u.ic(2).delete()})),u.Wb(2,"i",4),u.Jc(3,"delete_forever"),u.Vb(),u.Vb(),u.Wb(4,"button",14),u.ec("click",(function(e){return u.Ac(n),u.ic(2).export()})),u.Wb(5,"i",4),u.Jc(6,"save_alt"),u.Vb(),u.Vb(),u.Vb()}}function We(e,t){if(1&e&&(u.Wb(0,"div",15),u.Rb(1,"br"),u.Jc(2),u.Vb()),2&e){var n=u.ic().ngIf;u.Cb(2),u.Lc("ERROR: ",n.jobStatus.message," ")}}function _e(e,t){1&e&&(u.Wb(0,"div"),u.Wb(1,"mat-card"),u.Wb(2,"mat-card-content"),u.Rb(3,"mat-spinner",16),u.Vb(),u.Vb(),u.Vb())}function Ie(e,t){1&e&&(u.Wb(0,"div"),u.Wb(1,"mat-card"),u.Wb(2,"mat-card-content"),u.Wb(3,"div",17),u.Jc(4,"It may take up to 10 minutes to test for rhythmicity"),u.Vb(),u.Vb(),u.Vb(),u.Vb())}function Te(e,t){if(1&e){var n=u.Xb();u.Ub(0),u.Wb(1,"bd2-stat-test-options-widget",18),u.ec("options",(function(e){return u.Ac(n),u.ic(3).statTestOptions(e)})),u.Vb(),u.Rb(2,"bd2-rhythmicity-results-mdtable",19),u.Tb()}if(2&e){var r=t.ngIf,i=u.ic(3);u.Cb(2),u.oc("statTestParams",i.statTestParams)("job",r)}}function Re(e,t){if(1&e&&(u.Wb(0,"div"),u.Rb(1,"mat-divider"),u.Hc(2,_e,4,0,"div",12),u.jc(3,"async"),u.Hc(4,Ie,5,0,"div",12),u.Hc(5,Te,3,2,"ng-container",12),u.jc(6,"async"),u.Vb()),2&e){var n=u.ic().ngIf,r=u.ic();u.Cb(2),u.oc("ngIf",u.kc(3,3,r.rhythmicityJobDatasource.isReloading$)),u.Cb(2),u.oc("ngIf","SUBMITTED"===n.jobStatus.state),u.Cb(1),u.oc("ngIf",u.kc(6,5,r.rhythmicityJobDatasource.finishedJob$))}}function Oe(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",1),u.Wb(1,"div",2),u.Wb(2,"div",3),u.ec("click",(function(e){return u.Ac(n),u.ic().toggleExpanded()})),u.Wb(3,"i",4),u.Jc(4,"waves"),u.Vb(),u.Jc(5),u.jc(6,"date"),u.Rb(7,"br"),u.Jc(8),u.Vb(),u.Wb(9,"div",5),u.Jc(10),u.Wb(11,"a",6),u.ec("click",(function(e){return u.Ac(n),u.ic().refresh()})),u.Wb(12,"i",7),u.Jc(13,"refresh"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(14,"div",8),u.Wb(15,"mat-card"),u.Wb(16,"mat-card-content"),u.Wb(17,"div",9),u.Hc(18,Je,7,0,"div",10),u.Jc(19),u.Hc(20,We,3,1,"div",11),u.Vb(),u.Vb(),u.Vb(),u.Hc(21,Re,7,7,"div",12),u.Vb(),u.Vb()}if(2&e){var r=t.ngIf,i=u.ic();u.Cb(3),u.Gc("color",i.isExpanded?"green":"red")("font-size",150,"%"),u.Cb(2),u.Mc(" \xa0",i.shortUUID(r.jobId)," (",u.kc(6,13,i.toLocalDateTime(r.jobStatus.submitted)),") "),u.Cb(3),u.Mc(" ",r.parameters.METHOD," ",r.parameters.PRESET," "),u.Cb(2),u.Lc(" ",r.jobStatus.state," "),u.Cb(8),u.oc("ngIf",i.assay.security.canWrite),u.Cb(1),u.Lc(" ",r.parameters.PARAMS_SUMMARY," "),u.Cb(1),u.oc("ngIf",r.jobStatus.message&&"OK"!=r.jobStatus.message),u.Cb(1),u.oc("ngIf",i.isExpanded)}}var je,De=((je=function(){function e(t,n,r,i){_classCallCheck(this,e),this.rhythmicityService=t,this.rhythmicityJobDatasource=n,this.feedback=r,this.dialogs=i,this.deleted=new u.o,this.isExpanded=!1,this.expandedToogleStream=new l.a(!1)}return _createClass(e,[{key:"ngOnInit",value:function(){this.initSubscriptions()}},{key:"ngOnDestroy",value:function(){this.rhythmicityJobDatasource.close(),this.expandedToogleStream&&this.expandedToogleStream.complete()}},{key:"ngOnChanges",value:function(e){(e.jobId||e.assay)&&this.jobId&&this.assay&&this.rhythmicityJobDatasource.assayJob([this.assay.id,this.jobId])}},{key:"statTestOptions",value:function(e){var t=this,n=Object(b.a)(1).subscribe((function(){t.statTestParams=e,n&&n.unsubscribe()}))}},{key:"export",value:function(){var e=this;this.rhythmicityService.downloadJob(this.assay.id,this.jobId).subscribe((function(t){e.saveJobBlob(t,e.assay.id,e.jobId)}),(function(t){return e.feedback.error(t)}))}},{key:"saveJobBlob",value:function(e,t,n){h.saveAs(e,t+"_job"+this.shortUUID(n)+".rhythmicity.csv")}},{key:"refresh",value:function(){this.rhythmicityJobDatasource.refresh(),this.resultsTable&&this.resultsTable.reload()}},{key:"delete",value:function(){var e=this,t=this.assay,n=this.rhythmicityJobDatasource.currentJob;this.dialogs.confirm("Do you want to delete analysis: "+n.jobId,n.parameters.PARAMS_SUMMARY).subscribe((function(r){r&&e.doDelete(t,n.jobId)}))}},{key:"initSubscriptions",value:function(){var e=this;this.rhythmicityJobDatasource.on(!0),this.rhythmicityJobDatasource.error$.forEach((function(t){return e.feedback.error(t)}))}},{key:"doDelete",value:function(e,t){var n=this;this.rhythmicityService.deleteJob(e,t).subscribe((function(e){n.deleted.next(e),n.feedback.success("Job: "+n.shortUUID(t)+" deleted")}),(function(e){n.feedback.error(e)}))}},{key:"toggleExpanded",value:function(){this.expanded=!this.isExpanded}},{key:"toLocalDateTime",value:function(e){return d.b.deserialize(e).date}},{key:"shortUUID",value:function(e){if(e){var t=e.indexOf("-");if(t>1)return e.substring(0,t)}return e}},{key:"expanded",set:function(e){this.isExpanded=e,this.expandedToogleStream.next(e)}}]),e}()).\u0275fac=function(e){return new(e||je)(u.Qb(g),u.Qb(C),u.Qb(R.a),u.Qb(he.a))},je.\u0275cmp=u.Kb({type:je,selectors:[["bd2-rhythmicity-job-pane"]],viewQuery:function(e,t){var n;1&e&&u.Pc(de,!0),2&e&&u.wc(n=u.fc())&&(t.resultsTable=n.first)},inputs:{jobId:"jobId",assay:"assay",expanded:"expanded"},outputs:{deleted:"deleted"},features:[u.Bb([C]),u.Ab()],decls:2,vars:3,consts:[["class","card mb-2",4,"ngIf"],[1,"card","mb-2"],[1,"card-header","clearfix"],["role","button",1,"float-left",3,"click"],[1,"material-icons","bd-icon"],[1,"float-right"],["role","button","aria-label","refresh",3,"click"],[1,"material-icons","bd-icon","bd-primary"],[1,"card-body"],[1,"clearfix"],["class","float-right",4,"ngIf"],["class","text-danger","style","word-wrap: break-word;",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"text-danger",2,"word-wrap","break-word"],[1,"center-block"],[2,"margin-top","0.5em","text-align","center"],[3,"options"],[3,"statTestParams","job"]],template:function(e,t){1&e&&(u.Hc(0,Oe,22,15,"div",0),u.jc(1,"async")),2&e&&u.oc("ngIf",u.kc(1,1,t.rhythmicityJobDatasource.allJob$))},directives:[o.m,fe.a,fe.c,pe.a,me.b,Se,de],pipes:[o.b,o.e],encapsulation:2}),je),xe=n("GVyA");function He(e,t){if(1&e&&(u.Wb(0,"div"),u.Wb(1,"strong"),u.Jc(2),u.Vb(),u.Vb()),2&e){var n=u.ic(2);u.Cb(2),u.Lc("Submitted jobs: ",n.jobs.length,"")}}function Ee(e,t){1&e&&(u.Wb(0,"div"),u.Jc(1," No jobs submitted, start a new test. "),u.Vb())}var Me=function(){return["new"]};function Ae(e,t){1&e&&(u.Wb(0,"a",7),u.Jc(1," New test "),u.Vb()),2&e&&u.oc("routerLink",u.qc(1,Me))}function Ke(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div"),u.Wb(1,"bd2-rhythmicity-job-pane",8),u.ec("deleted",(function(e){return u.Ac(n),u.ic(2).remove(e)}))("finished",(function(e){return u.Ac(n),u.ic(2).refreshJob(e)})),u.Vb(),u.Vb()}if(2&e){var r=t.$implicit,i=t.index,a=u.ic(2);u.Cb(1),u.oc("assay",a.assay)("jobId",r)("expanded",a.expandAll||0==i)}}function Be(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div"),u.Wb(1,"h3"),u.Jc(2,"Rhythmicity tests"),u.Vb(),u.Rb(3,"hr"),u.Wb(4,"div",1),u.Wb(5,"div",2),u.Hc(6,He,3,1,"div",0),u.Hc(7,Ee,2,0,"div",0),u.Vb(),u.Wb(8,"div",3),u.Hc(9,Ae,2,2,"a",4),u.Wb(10,"button",5),u.ec("click",(function(e){return u.Ac(n),u.ic().refresh()})),u.Jc(11,"Refresh "),u.Vb(),u.Vb(),u.Vb(),u.Rb(12,"hr"),u.Hc(13,Ke,2,3,"div",6),u.Rb(14,"hr"),u.Vb()}if(2&e){var r=u.ic();u.Cb(6),u.oc("ngIf",r.jobs&&r.jobs.length>0),u.Cb(1),u.oc("ngIf",!r.jobs||0==r.jobs.length),u.Cb(2),u.oc("ngIf",r.assay.security.canWrite),u.Cb(1),u.oc("disabled",r.blocked),u.Cb(3),u.oc("ngForOf",r.jobsIds)}}var $e,Le=(($e=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).expandAll=!1,r.blocked=!1,r.titlePart=" Rhythm",r}return _inherits(t,e),_createClass(t,[{key:"updateModel",value:function(e){_get(_getPrototypeOf(t.prototype),"updateModel",this).call(this,e),e&&this.loadJobs(e)}},{key:"loadJobs",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.blocked=!0,this.rhythmicityService.getJobs(e).subscribe((function(r){t.jobs=r,t.refreshJobsInfo(r),t.exportURL=t.rhythmicityService.exportURL(e),n&&t.refreshPanes(),t.blocked=!1}),(function(e){t.blocked=!1,t.feedback.error(e)}))}},{key:"refreshJobsInfo",value:function(e){this.jobsIds=e.map((function(e){return e.jobId}))}},{key:"refresh",value:function(){this.loadJobs(this.assay,!0)}},{key:"refreshPanes",value:function(){this.panes&&this.panes.forEach((function(e){return e.refresh()}))}},{key:"remove",value:function(e){var t=this.jobs.findIndex((function(t){return e.jobId===t.jobId}));t>=0&&(this.jobs.splice(t,1),this.refreshJobsInfo(this.jobs))}},{key:"refreshJob",value:function(e){var t=this.jobs.findIndex((function(t){return e.jobId===t.jobId}));t>=0&&(this.jobs[t]=e,this.refreshJobsInfo(this.jobs))}},{key:"calculateQueuing",value:function(e){var t=this;return e.filter((function(e){return t.isQueueing(e.jobStatus.state)})).length}},{key:"isQueueing",value:function(e){switch(e){case"WAITING":case"PROCESSING":case"SUBMITTED":return!0;default:return!1}}},{key:"checkFinished",value:function(e){var t=this;return!!e.find((function(e){return t.isFinished(e.jobStatus.state)}))}},{key:"isFinished",value:function(e){switch(e){case"SUCCESS":case"FINISHED":case"COMPLETED":return!0;default:return!1}}}]),t}(s)).\u0275fac=function(e){return new(e||$e)(u.Qb(g),u.Qb(xe.a))},$e.\u0275cmp=u.Kb({type:$e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&u.Pc(De,!0),2&e&&u.wc(n=u.fc())&&(t.panes=n)},features:[u.zb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-body"],["class","btn btn-primary mr-1",3,"routerLink",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary",3,"disabled","click"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary","mr-1",3,"routerLink"],[3,"assay","jobId","expanded","deleted","finished"]],template:function(e,t){1&e&&u.Hc(0,Be,15,5,"div",0),2&e&&u.oc("ngIf",t.assay)},directives:[o.m,o.l,c.e,De],encapsulation:2}),$e),Ue=n("QBpm"),Ne=n("Kj3r"),ze=n("bngM"),qe=n("ZMwR"),Fe=n("naqj"),Qe=n("Tl2h"),Ge=n("wcxA");function Xe(e,t){if(1&e&&(u.Wb(0,"option",29),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n.name),u.Cb(1),u.Kc(n.label)}}function Ye(e,t){1&e&&(u.Wb(0,"div",30),u.Wb(1,"div",31),u.Jc(2," Rhythmicity tests are generally used for short, sparse timeseries. "),u.Rb(3,"br"),u.Jc(4," The current limit is 5 or 4 days of hourly sampled data for eJTK preset and BD2 preset respectivelly."),u.Rb(5,"br"),u.Jc(6," Generally the raw data are being analysed, but we also enabled a linear detrended option. "),u.Vb(),u.Vb())}function Ze(e,t){if(1&e&&(u.Wb(0,"option",29),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n.name),u.Cb(1),u.Kc(n.label)}}function et(e,t){1&e&&(u.Wb(0,"div",30),u.Wb(1,"div",31),u.Jc(2," BD2 eJTK is the BioDare2 implementation of Empirical JTK_CYCLE with asymmetry search from "),u.Wb(3,"a",32),u.Jc(4,"Alan L. Hutchison et al. 2015"),u.Vb(),u.Jc(5,". It is a classic JTK method but with p values empirically calculated against set of random noise data. "),u.Vb(),u.Vb())}function tt(e,t){if(1&e&&(u.Wb(0,"option",29),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n.name),u.Cb(1),u.Kc(n.label)}}function nt(e,t){1&e&&(u.Wb(0,"div",30),u.Wb(1,"div",31),u.Jc(2," Presets determine set of pattern curves against the comparison test is run."),u.Rb(3,"br"),u.Wb(4,"ul"),u.Wb(5,"li"),u.Jc(6,"eJTK Classic is recommended for typical omics-like data for which eJTK method was developed. "),u.Rb(7,"br"),u.Jc(8," It works well for short data (48h, 2h- 1h-sampled) when actual period is within range 22-26 hours."),u.Rb(9,"br"),u.Jc(10," The patterns are series of cosine-like waveforms with 24h period, phases by 2hours and range of asymmetries by 2h (see original paper)."),u.Rb(11,"br"),u.Vb(),u.Wb(12,"li"),u.Jc(13,"BD2 Classic can detect non 24 periods and some forms of the spikes."),u.Rb(14,"br"),u.Jc(15," As it compares against much more patterns it has a weaker power."),u.Rb(16,"br"),u.Jc(17," It should be used when there is a good reason to suspect periods outside 22-26h range."),u.Rb(18,"br"),u.Jc(19," The patterns are series of cosine-like waverforms with periods from 18-35hours, for each period there are multiple "),u.Wb(20,"b"),u.Jc(21,"circadian"),u.Vb(),u.Jc(22," phases with step 2h (so each period value generates the same number of patterns but the peaks in absolute units do not coincide) and a range of assymetries by 2h in circadian units (see original paper). The preset contains also additional some spike patterns. "),u.Vb(),u.Vb(),u.Vb(),u.Vb())}var rt,it=function(){return[10,25,50,100,200]},at=((rt=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).methodOptions=w,n.presetOptions=J,n.dataHelp=!1,n.presetsHelp=!1,n.methodHelp=!1,n.rhythmicityRequests=new u.o,n.detrendingOptions=[Qe.b.NO_DTR,Qe.b.LIN_DTR],n}return _inherits(t,e),_createClass(t,[{key:"buildMainForm",value:function(){var e=this;return this.fb.group({displayParams:this.displayParamsForm,periodScale:this.fb.group({periodMin:[18,[ye.A.required]],periodMax:[34,[ye.A.required]]},{validator:function(t){return e.validPeriodScale(t.value)}}),method:[P.BD2EJTK.name,[ye.A.required]],preset:[S.EJTK_CLASSIC.name,[ye.A.required]]})}},{key:"defaultDetrending",value:function(){return Qe.b.NO_DTR.name}},{key:"validPeriodScale",value:function(e){var t=e.periodMin,n=e.periodMax;return t<10?{validPeriodScale:"Period min must >= 10"}:n<10?{validPeriodScale:"Period max must >= 10"}:n>50?{validPeriodScale:"Period max must < 50"}:t>=n?{validPeriodScale:"Period min must be < max"}:null}},{key:"analyse",value:function(){if(!this.mainForm.invalid){var e=this.map2RhythmicityRequest(this.mainForm.value);e.isValid()&&this.rhythmicityRequests.next(e)}}},{key:"map2RhythmicityRequest",value:function(e){var t=new W;return t.detrending=Qe.b.get(e.displayParams.detrending),t.method=P.get(e.method),t.preset=S.get(e.preset),t.periodMax=e.periodScale.periodMax,t.periodMin=e.periodScale.periodMin,t.windowEnd=e.displayParams.timeScale.timeEnd,t.windowStart=e.displayParams.timeScale.timeStart,t}}]),t}(Ge.a)).\u0275fac=function(e){return new(e||rt)(u.Qb(ye.d))},rt.\u0275cmp=u.Kb({type:rt,selectors:[["bd2-rhythmicityjob-params-rform"]],inputs:{disabled:"disabled",totalTraces:"totalTraces",currentPage:"currentPage"},outputs:{displayParams:"displayParams",rhythmicityRequests:"rhythmicityRequests"},features:[u.zb],decls:61,vars:15,consts:[["role","form",1,"form-horizontal",3,"formGroup"],["formGroupName","displayParams"],["formGroupName","timeScale",1,"form-group","row"],[1,"col-sm-4"],["for","windowStart",1,"col-sm-1"],[1,"col-sm-2"],["formControlName","timeStart","id","windowStart","min","0","required","","size","5","step","any","type","number",1,"form-control"],["for","windowEnd",1,"col-sm-1"],["formControlName","timeEnd","id","windowEnd","min","0","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],[1,"form-group","row"],["for","detrending",1,"col-sm-4"],[3,"click"],[1,"material-icons","bd-icon","bd-primary"],[1,"col-sm-6"],["formControlName","detrending","id","detrending","required","",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["class","col-sm-12",4,"ngIf"],["for","method",1,"col-sm-4"],["formControlName","method","id","method","required","",1,"form-control"],["formControlName","preset","id","preset","required","",1,"form-control"],["formGroupName","periodScale",1,"form-group","row",3,"hidden"],["for","periodMin",1,"col-sm-1"],["formControlName","periodMin","id","periodMin","max","50","min","10","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],["for","periodMax",1,"col-sm-1"],["formControlName","periodMax","id","periodMax","max","50","min","10","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],[1,"col-sm-8"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["dataPaginator",""],["type","button",1,"btn","btn-primary",3,"disabled","click"],[3,"value"],[1,"col-sm-12"],["role","alert","type","info",1,"alert","alert-info"],["href"," https://doi.org/10.1371/journal.pcbi.1004094","target","_blank"]],template:function(e,t){1&e&&(u.Wb(0,"form",0),u.Wb(1,"div",1),u.Wb(2,"div",2),u.Wb(3,"label",3),u.Jc(4,"Data window"),u.Vb(),u.Wb(5,"label",4),u.Jc(6,"from:"),u.Vb(),u.Wb(7,"div",5),u.Rb(8,"input",6),u.Vb(),u.Wb(9,"label",7),u.Jc(10,"to:"),u.Vb(),u.Wb(11,"div",5),u.Rb(12,"input",8),u.Vb(),u.Vb(),u.Wb(13,"div",9),u.Wb(14,"label",10),u.Jc(15,"Input Data "),u.Wb(16,"a",11),u.ec("click",(function(e){return t.dataHelp=!t.dataHelp})),u.Wb(17,"i",12),u.Jc(18,"help"),u.Vb(),u.Vb(),u.Vb(),u.Wb(19,"div",13),u.Wb(20,"select",14),u.Hc(21,Xe,2,2,"option",15),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Hc(22,Ye,7,0,"div",16),u.Wb(23,"div",9),u.Wb(24,"label",17),u.Jc(25,"Test Method "),u.Wb(26,"a",11),u.ec("click",(function(e){return t.methodHelp=!t.methodHelp})),u.Wb(27,"i",12),u.Jc(28,"help"),u.Vb(),u.Vb(),u.Vb(),u.Wb(29,"div",13),u.Wb(30,"select",18),u.Hc(31,Ze,2,2,"option",15),u.Vb(),u.Vb(),u.Vb(),u.Hc(32,et,6,0,"div",16),u.Wb(33,"div",9),u.Wb(34,"label",17),u.Jc(35,"Analysis Presets "),u.Wb(36,"a",11),u.ec("click",(function(e){return t.presetsHelp=!t.presetsHelp})),u.Wb(37,"i",12),u.Jc(38,"help"),u.Vb(),u.Vb(),u.Vb(),u.Wb(39,"div",13),u.Wb(40,"select",19),u.Hc(41,tt,2,2,"option",15),u.Vb(),u.Vb(),u.Vb(),u.Hc(42,nt,23,0,"div",16),u.Wb(43,"div",20),u.Wb(44,"label",3),u.Jc(45,"Expected periods"),u.Vb(),u.Wb(46,"label",21),u.Jc(47,"from:"),u.Vb(),u.Wb(48,"div",5),u.Rb(49,"input",22),u.Vb(),u.Wb(50,"label",23),u.Jc(51,"to:"),u.Vb(),u.Wb(52,"div",5),u.Rb(53,"input",24),u.Vb(),u.Vb(),u.Wb(54,"div",9),u.Rb(55,"label",5),u.Wb(56,"div",25),u.Wb(57,"mat-paginator",26,27),u.ec("page",(function(e){return t.loadDataPage(e)})),u.Vb(),u.Vb(),u.Vb(),u.Wb(59,"button",28),u.ec("click",(function(e){return t.analyse()})),u.Jc(60,"Test Rhythmicity "),u.Vb(),u.Vb()),2&e&&(u.oc("formGroup",t.mainForm),u.Cb(21),u.oc("ngForOf",t.detrendingOptions),u.Cb(1),u.oc("ngIf",t.dataHelp),u.Cb(9),u.oc("ngForOf",t.methodOptions),u.Cb(1),u.oc("ngIf",t.methodHelp),u.Cb(9),u.oc("ngForOf",t.presetOptions),u.Cb(1),u.oc("ngIf",t.presetsHelp),u.Cb(1),u.oc("hidden",!0),u.Cb(14),u.oc("length",t.totalTraces)("disabled",t.disabledPagination)("pageSize",t.currentPage.pageSize)("pageIndex",t.currentPage.pageIndex)("pageSizeOptions",u.qc(14,it)),u.Cb(2),u.oc("disabled",t.disabled||t.mainForm.invalid))},directives:[ye.C,ye.q,ye.h,ye.i,ye.c,ye.u,ye.p,ye.g,ye.y,ye.z,o.l,o.m,k.a,ye.t,ye.B],encapsulation:2}),rt),ot=n("nA4b");function ct(e,t){if(1&e&&u.Rb(0,"bd2-ts-plots",3),2&e){var n=u.ic(3);u.oc("data",n.timeseries)("tracesPerPlot",n.tracesPerPlot)}}function st(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div"),u.Wb(1,"bd2-rhythmicityjob-params-rform",1),u.ec("displayParams",(function(e){return u.Ac(n),u.ic(2).emitDisplayParams(e)}))("rhythmicityRequests",(function(e){return u.Ac(n),u.ic(2).doAnalysis(e)})),u.Vb(),u.Rb(2,"hr"),u.Hc(3,ct,1,2,"bd2-ts-plots",2),u.Vb()}if(2&e){var r=u.ic(2);u.Cb(1),u.oc("disabled",r.blocked)("totalTraces",r.totalTraces)("currentPage",r.currentPage),u.Cb(2),u.oc("ngIf",r.timeseries)}}function ut(e,t){if(1&e&&(u.Wb(0,"div"),u.Wb(1,"h3"),u.Jc(2,"Start rhythmicity test"),u.Vb(),u.Rb(3,"hr"),u.Hc(4,st,4,4,"div",0),u.Vb()),2&e){var n=u.ic();u.Cb(4),u.oc("ngIf",!n.disabled)}}var lt,bt,dt=[{path:"",children:[{path:"new",component:(lt=function(e){function t(e,n,r,i,a){var o;return _classCallCheck(this,t),(o=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,i,a))).fetcher=e,o.analytics=n,o.userService=r,o.disabled=!1,o.blocked=!1,o.tracesPerPlot=5,o.totalTraces=0,o.currentPage=ze.a.firstPage(),o.titlePart=" New Test",o}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"ngOnInit",this).call(this),this.timeSeriesSubsripction=this.fetcher.seriesPackStream.pipe(Object(Ne.a)(1e3)).subscribe((function(t){var n=t.data;e.tracesPerPlot=Math.max(5,n.length/20),e.timeseries=n,e.totalTraces=t.totalTraces,e.currentPage=t.currentPage}),(function(t){console.log("Error in TS subscription: "+t),e.feedback.error(t)}))}},{key:"ngOnDestroy",value:function(){this.timeSeriesSubsripction&&this.timeSeriesSubsripction.unsubscribe(),this.fetcher.ngOnDestroy(),_get(_getPrototypeOf(t.prototype),"ngOnDestroy",this).call(this)}},{key:"emitDisplayParams",value:function(e){this.fetcher.changeDisplayParams(e)}},{key:"doAnalysis",value:function(e){var t=this;e.isValid()&&(this.blocked=!0,this.rhythmicityService.newTest(this.assay,e).subscribe((function(n){t.feedback.success("Rhythmicity test submitted"),t.analytics.rhythmicityNew(e.method.name,t.assay.id,t.userService.currentUser.login),t.refreshModel(),t.goToRhythmicityHome()}),(function(e){t.blocked=!1,t.feedback.error(e)})))}},{key:"updateModel",value:function(e){this.fetcher.experiment(e),_get(_getPrototypeOf(t.prototype),"updateModel",this).call(this,e)}}]),t}(s),lt.\u0275fac=function(e){return new(e||lt)(u.Qb(Ue.a),u.Qb(qe.a),u.Qb(Fe.a),u.Qb(g),u.Qb(xe.a))},lt.\u0275cmp=u.Kb({type:lt,selectors:[["ng-component"]],features:[u.Bb([Ue.a]),u.zb],decls:1,vars:1,consts:[[4,"ngIf"],[3,"disabled","totalTraces","currentPage","displayParams","rhythmicityRequests"],[3,"data","tracesPerPlot",4,"ngIf"],[3,"data","tracesPerPlot"]],template:function(e,t){1&e&&u.Hc(0,ut,5,1,"div",0),2&e&&u.oc("ngIf",t.assay)},directives:[o.m,at,ot.a],encapsulation:2}),lt)},{path:"",component:Le,pathMatch:"full"}]}],ht=((bt=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ob({type:bt}),bt.\u0275inj=u.Nb({factory:function(e){return new(e||bt)},imports:[[c.f.forChild(dt)],c.f]}),bt),ft=n("wMBR"),pt=n("a6j2"),mt=n("ZTEM");n.d(t,"RhythmicityModule",(function(){return vt}));var yt,vt=((yt=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ob({type:yt}),yt.\u0275inj=u.Nb({factory:function(e){return new(e||yt)},imports:[[o.c,ye.j,ye.x,ft.a,pt.a,mt.a,ht]]}),yt)}}]);