function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(s){i=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _createSuper(e){return function(){var t,n=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{ja10:function(e,t,n){"use strict";n.r(t),n.d(t,"RhythmicityModule",(function(){return Vt}));var r,i,a,o=n("ofXK"),c=n("tyNb"),s=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this,r)).rhythmicityService=e,i.titlePart=" Rhythm",i}return _createClass(n,[{key:"goToRhythmicityHome",value:function(e){var t=this.expHomePath(e);t.push("rhythmicity"),this.router.navigate(t)}}]),n}(n("yYXI").a),u=n("fXoL"),l=n("2Vo4"),b=n("PqYM"),h=n("B9cw"),d=n("Iab2"),f=n("zQ7r"),p=n("Iurr"),m=n("tu3j"),y=n("lJxs"),v=n("UsWK"),g=((i=function(){function e(t){_classCallCheck(this,e),this.BD2REST=t}return _createClass(e,[{key:"newTest",value:function(e,t){return this.BD2REST.rhythmicityNew(e.id,t)}},{key:"getJob",value:function(e,t){return this.BD2REST.rhythmicityJob(e,t)}},{key:"getJobs",value:function(e){return this.BD2REST.rhythmicityJobs(e.id).pipe(Object(y.a)((function(e){return e.data})))}},{key:"getResults",value:function(e,t){return this.BD2REST.rhythmicityResults(e,t)}},{key:"exportURL",value:function(e){return this.BD2REST.ppaExportURL(e.id)}},{key:"deleteJob",value:function(e,t){return this.BD2REST.rhythmicityDeleteJob(e.id,t)}},{key:"downloadJob",value:function(e,t){return this.BD2REST.rhythmicityExportJob(e,t)}}]),e}()).\u0275fac=function(e){return new(e||i)(u.ac(v.a))},i.\u0275prov=u.Mb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),C=((r=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _classCallCheck(this,n),(r=t.call(this,i)).rhythmicityService=e,r.finishedJob$=r.finished$,r.runningJob$=r.running$,r.allJob$=r.all$,r}return _createClass(n,[{key:"initIntervalsKeeper",value:function(){return new m.a(1e3,3e4,6e5,2)}},{key:"assayJob",value:function(e){this.input(e)}},{key:"sameInput",value:function(e,t){return e[1]===t[1]&&e[0]===t[0]}},{key:"fetchAsset",value:function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return this.rhythmicityService.getJob(n,r)}},{key:"hasFailed",value:function(e){return!!e&&!this.isFinished(e)&&!this.isRunning(e)}},{key:"isFinished",value:function(e){return!(!e||!e.jobStatus||"FINISHED"!==e.jobStatus.state&&"SUCCESS"!==e.jobStatus.state)}},{key:"isRunning",value:function(e){return!!e&&!(!e||!e.jobStatus||"SUBMITTED"!==e.jobStatus.state&&"PROCESSING"!==e.jobStatus.state)}},{key:"assetToId",value:function(e){return e.jobId}},{key:"assetToInput",value:function(e){return[e.parentId,e.jobId]}},{key:"currentJob",get:function(){return this.currentAsset}}]),n}(f.a)).\u0275fac=function(e){return new(e||r)(u.ac(g),u.ac(p.a,8))},r.\u0275prov=u.Mb({token:r,factory:r.\u0275fac}),r),k=n("M9IT"),S=n("vkgz"),J=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this._name=t,this._label=n}return _createClass(e,[{key:"toJSON",value:function(){return this.name}},{key:"name",get:function(){return this._name}},{key:"label",get:function(){return this._label}}],[{key:"get",value:function(t){return e.getValuesMap().get(t)}},{key:"getValuesMap",value:function(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}},{key:"initValuesMap",value:function(){var t=new Map;return e.values.forEach((function(e){return t.set(e.name,e)})),t}}]),e}();return e.BD2EJTK=new e("BD2EJTK","BD2 eJTK"),e.BD2JTK=new e("BD2JTK","Classic JTK"),e.values=[e.BD2JTK,e.BD2EJTK],e}(),V=[J.BD2JTK,J.BD2EJTK],w=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this._name=t,this._label=n}return _createClass(e,[{key:"toJSON",value:function(){return this.name}},{key:"name",get:function(){return this._name}},{key:"label",get:function(){return this._label}}],[{key:"get",value:function(t){return e.getValuesMap().get(t)}},{key:"getValuesMap",value:function(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}},{key:"initValuesMap",value:function(){var t=new Map;return e.values.forEach((function(e){return t.set(e.name,e)})),t}}]),e}();return e.EJTK_CLASSIC=new e("EJTK_CLASSIC","eJTK Classic"),e.BD2_CLASSIC=new e("BD2_CLASSIC","BD2 Classic"),e.BD2_SPREAD=new e("BD2_SPREAD","Period range"),e.COS_1H=new e("COS_1H","Cosine 24h 1h"),e.COS_2H=new e("COS_2H","Cosine 24h 2h"),e.COS_4H=new e("COS_4H","Cosine 24h 4h"),e.values=[e.COS_1H,e.COS_2H,e.COS_4H,e.EJTK_CLASSIC,e.BD2_CLASSIC,e.BD2_SPREAD],e}(),P=[w.COS_1H,w.COS_2H,w.COS_4H,w.EJTK_CLASSIC,w.BD2_CLASSIC],_=[w.COS_1H,w.COS_2H,w.COS_4H],W=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"isValid",value:function(){return!(this.windowStart<0||this.windowEnd<0||this.periodMin<=0||this.periodMax<=0||this.periodMin>this.periodMax||this.windowEnd>0&&this.windowStart>=this.windowEnd||null==this.method||null==this.preset||null==this.detrending)}}]),e}(),I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this.pValue=t,this.bhCorrection=n,this.showPattern=r,this.circadian=i}return _createClass(e,[{key:"clone",value:function(){return new e(this.pValue,this.bhCorrection,this.showPattern,this.circadian)}}]),e}(),T=n("8jiw"),O=((a=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _classCallCheck(this,n),(r=t.call(this,i)).rhythmicityService=e,r.results$=r.data$,r}return _createClass(n,[{key:"isClassicJob",value:function(){var e,t;return"BD2JTK"===(null===(t=null===(e=this.currentInput)||void 0===e?void 0:e.parameters)||void 0===t?void 0:t.METHOD)}},{key:"sameInput",value:function(e,t){return function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"sameJob",value:function(e,t){return!(!e||!t)&&e.jobId===t.jobId&&e.parentId===t.parentId}}]),e}().sameJob(e,t)}},{key:"assetToData",value:function(e,t){return e.results}},{key:"fetchAsset",value:function(e){var t=this;return this.rhythmicityService.getResults(e.parentId,e.jobId).pipe(Object(S.a)((function(e){return t.labelPatterns(e)})))}},{key:"sortingKey",value:function(e){switch(e.active){case"label":return function(e){return e.label};case"id":return function(e){return+e.id};case"empp":return function(e){return+e.result.empP};case"emppbh":return function(e){return+e.result.empPBH};case"p":return function(e){return+e.result.p};case"pbh":return function(e){return+e.result.pBH};case"tau":return function(e){return+e.result.tau};case"period":return function(e){return e.result.pattern.period};case"peak":return function(e){return e.result.pattern.peak};case"trough":return function(e){return e.result.pattern.trough};default:return console.error("Not implemented sorting for "+e.active),function(e){return 0}}}},{key:"processData",value:function(e,t){return t?(this.rankResults(e,t.pValue,t.bhCorrection,this.isClassicJob()),e):e}},{key:"labelPatterns",value:function(e){var t=this;e.results.forEach((function(e){e.result.patternLabel=t.describePattern(e.result),e.result.pattern.shapeLabel=t.patternToShape(e.result.pattern)}))}},{key:"describePattern",value:function(e){var t=e.pattern,n=Math.round(10*t.period)/10,r=Math.round(100*t.peak)/100,i=Math.round(100*t.trough)/100;return"".concat(this.patternToShape(t),"\t").concat(n,"\t").concat(r,"\t").concat(i)}},{key:"patternToShape",value:function(e){switch(e.waveform){case"ASYM_COSINE":return.5===e.leftPortion?"COS":"ACOS";case"ASYM_COS_SPIKE":return"SPIKE";case"ASYM_COS_SPIKE_NEG":return"NPIKE";default:return e.waveform}}},{key:"rankResults",value:function(e,t,n,r){e.forEach((function(e){var i,a=e.result;i=r?n?a.pBH:a.p:n?a.empPBH:a.empP,a.rhythmic=i<t}))}}]),n}(T.a)).\u0275fac=function(e){return new(e||a)(u.ac(g),u.ac(p.a,8))},a.\u0275prov=u.Mb({token:a,factory:a.\u0275fac}),a),D=n("6tuW"),R=n("+0xr"),j=n("Dh3D"),H=n("bv9b");function x(e,t){1&e&&u.Rb(0,"mat-progress-bar",28)}function E(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"Id"),u.Vb())}function M(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(n.id)}}function A(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"Label"),u.Vb())}function K(e,t){if(1&e&&(u.Wb(0,"td",31),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(n.label)}}function B(e,t){1&e&&(u.Wb(0,"th",32),u.Jc(1,"Rhythmic"),u.Vb())}function $(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Gb("bold",n.result.rhythmic),u.Cb(1),u.Kc(n.result.rhythmic)}}function L(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"emp-p"),u.Vb())}function U(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.empP,"1.0-5"))}}function N(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"BH emp-p"),u.Vb())}function F(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.empPBH,"1.0-5"))}}function z(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"Tau"),u.Vb())}function q(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.tau,"1.0-2"))}}function Q(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"p"),u.Vb())}function G(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.p,"1.0-5"))}}function X(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"BH p"),u.Vb())}function Y(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.pBH,"1.0-5"))}}function Z(e,t){1&e&&(u.Wb(0,"th",32),u.Jc(1,"Pattern"),u.Vb())}function ee(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(n.result.patternLabel)}}function te(e,t){1&e&&(u.Wb(0,"th",32),u.Jc(1,"P.Shape"),u.Vb())}function ne(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(n.result.pattern.shapeLabel)}}function re(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"P.Period"),u.Vb())}function ie(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.pattern.period,"1.0-1"))}}function ae(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"P.Peak"),u.Vb())}function oe(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.pattern.peak,"1.1-1"))}}function ce(e,t){1&e&&(u.Wb(0,"th",32),u.Jc(1,"P.Peak"),u.Vb())}function se(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,24*n.result.pattern.peak/n.result.pattern.period,"1.1-1"))}}function ue(e,t){1&e&&(u.Wb(0,"th",29),u.Jc(1,"P.Trough"),u.Vb())}function le(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,n.result.pattern.trough,"1.1-1"))}}function be(e,t){1&e&&(u.Wb(0,"th",32),u.Jc(1,"P.Trough"),u.Vb())}function he(e,t){if(1&e&&(u.Wb(0,"td",30),u.Jc(1),u.jc(2,"number"),u.Vb()),2&e){var n=t.$implicit;u.Cb(1),u.Kc(u.lc(2,1,24*n.result.pattern.trough/n.result.pattern.period,"1.1-1"))}}function de(e,t){1&e&&u.Rb(0,"tr",33)}function fe(e,t){1&e&&u.Rb(0,"tr",34)}var pe,me=function(){return[10,25,50,100,250]},ye=((pe=function(){function e(t,n){_classCallCheck(this,e),this.fetcher=t,this.feedback=n,this.normEmpPColumns=["id","label","rhythmic","empp","tau"],this.normClsPColumns=["id","label","rhythmic","p","tau"],this.bhEmpPColumns=["id","label","rhythmic","emppbh","tau"],this.bhClsPColumns=["id","label","rhythmic","pbh","tau"],this.patternColumns=["shape","period","peak","trough"],this.patternColumnsC=["shape","period","peakc","troughc"],this.displayedColumns=this.normEmpPColumns,this.disablePaginator=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.fetcher.error$.subscribe((function(t){return e.feedback.error(t)}));var t=new k.d;t.pageSize=25,t.pageIndex=0,this.fetcher.page(t),this.fetcher.on(!0)}},{key:"ngOnDestroy",value:function(){this.fetcher.close()}},{key:"ngAfterViewInit",value:function(){}},{key:"reload",value:function(){this.fetcher.refresh()}},{key:"sortData",value:function(e){this.fetcher.sort(e)}},{key:"loadPage",value:function(e){this.fetcher.page(e)}},{key:"job",set:function(e){e&&this.fetcher.input(e)}},{key:"statTestParams",set:function(e){if(e){this.fetcher.params(e);var t=e.bhCorrection?this.bhEmpPColumns:this.normEmpPColumns;this.fetcher.isClassicJob()&&(t=e.bhCorrection?this.bhClsPColumns:this.normClsPColumns),e.showPattern&&(t=t.concat(e.circadian?this.patternColumnsC:this.patternColumns)),this.displayedColumns=t}}}]),e}()).\u0275fac=function(e){return new(e||pe)(u.Qb(O),u.Qb(D.a))},pe.\u0275cmp=u.Kb({type:pe,selectors:[["bd2-rhythmicity-results-mdtable"]],inputs:{job:"job",statTestParams:"statTestParams"},features:[u.Bb([O])],decls:55,vars:18,consts:[[1,"mat-elevation-z8"],["mode","indeterminate",4,"ngIf"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["paginator",""],["mat-table","","matSort","","aria-label","Results","matSort","","matSortActive","id","matSortDirection","asc",1,"full-width-table",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","label"],["mat-cell","","class","word_wrapping","style","max-width: 100px",4,"matCellDef"],["matColumnDef","rhythmic"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"bold",4,"matCellDef"],["matColumnDef","empp"],["matColumnDef","emppbh"],["matColumnDef","tau"],["matColumnDef","p"],["matColumnDef","pbh"],["matColumnDef","pattern"],["matColumnDef","shape"],["matColumnDef","period"],["matColumnDef","peak"],["matColumnDef","peakc"],["matColumnDef","trough"],["matColumnDef","troughc"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["paginator2",""],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",1,"word_wrapping",2,"max-width","100px"],["mat-header-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,t){1&e&&(u.Wb(0,"div",0),u.Hc(1,x,1,0,"mat-progress-bar",1),u.jc(2,"async"),u.Wb(3,"mat-paginator",2,3),u.ec("page",(function(e){return t.loadPage(e)})),u.Vb(),u.Wb(5,"table",4),u.ec("matSortChange",(function(e){return t.sortData(e)})),u.Ub(6,5),u.Hc(7,E,2,0,"th",6),u.Hc(8,M,2,1,"td",7),u.Tb(),u.Ub(9,8),u.Hc(10,A,2,0,"th",6),u.Hc(11,K,2,1,"td",9),u.Tb(),u.Ub(12,10),u.Hc(13,B,2,0,"th",11),u.Hc(14,$,2,3,"td",12),u.Tb(),u.Ub(15,13),u.Hc(16,L,2,0,"th",6),u.Hc(17,U,3,4,"td",7),u.Tb(),u.Ub(18,14),u.Hc(19,N,2,0,"th",6),u.Hc(20,F,3,4,"td",7),u.Tb(),u.Ub(21,15),u.Hc(22,z,2,0,"th",6),u.Hc(23,q,3,4,"td",7),u.Tb(),u.Ub(24,16),u.Hc(25,Q,2,0,"th",6),u.Hc(26,G,3,4,"td",7),u.Tb(),u.Ub(27,17),u.Hc(28,X,2,0,"th",6),u.Hc(29,Y,3,4,"td",7),u.Tb(),u.Ub(30,18),u.Hc(31,Z,2,0,"th",11),u.Hc(32,ee,2,1,"td",7),u.Tb(),u.Ub(33,19),u.Hc(34,te,2,0,"th",11),u.Hc(35,ne,2,1,"td",7),u.Tb(),u.Ub(36,20),u.Hc(37,re,2,0,"th",6),u.Hc(38,ie,3,4,"td",7),u.Tb(),u.Ub(39,21),u.Hc(40,ae,2,0,"th",6),u.Hc(41,oe,3,4,"td",7),u.Tb(),u.Ub(42,22),u.Hc(43,ce,2,0,"th",11),u.Hc(44,se,3,4,"td",7),u.Tb(),u.Ub(45,23),u.Hc(46,ue,2,0,"th",6),u.Hc(47,le,3,4,"td",7),u.Tb(),u.Ub(48,24),u.Hc(49,be,2,0,"th",11),u.Hc(50,he,3,4,"td",7),u.Tb(),u.Hc(51,de,1,0,"tr",25),u.Hc(52,fe,1,0,"tr",26),u.Vb(),u.Wb(53,"mat-paginator",2,27),u.ec("page",(function(e){return t.loadPage(e)})),u.Vb(),u.Vb()),2&e&&(u.Cb(1),u.oc("ngIf",u.kc(2,14,t.fetcher.isBusy$)),u.Cb(2),u.oc("length",t.fetcher.dataLength)("disabled",t.disablePaginator)("pageSize",(null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageSize)||25)("pageIndex",null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageIndex)("pageSizeOptions",u.qc(16,me)),u.Cb(2),u.oc("dataSource",t.fetcher.results$),u.Cb(46),u.oc("matHeaderRowDef",t.displayedColumns),u.Cb(1),u.oc("matRowDefColumns",t.displayedColumns),u.Cb(1),u.oc("length",t.fetcher.dataLength)("disabled",t.disablePaginator)("pageSize",(null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageSize)||25)("pageIndex",null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageIndex)("pageSizeOptions",u.qc(17,me)))},directives:[o.m,k.a,R.n,j.a,R.c,R.i,R.b,R.k,R.m,H.a,R.h,j.b,R.a,R.j,R.l],pipes:[o.b,o.f],styles:[".full-width-table[_ngcontent-%COMP%] {\n      width: 100%;\n    }"]}),pe),ve=n("BOp5"),ge=n("9+85"),Ce=n("Wp6s"),ke=n("f0Cb"),Se=n("Xa2L"),Je=n("3Pt+"),Ve=n("kmnG"),we=n("QibW");function Pe(e,t){if(1&e&&(u.Wb(0,"mat-radio-button",5),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n),u.Cb(1),u.Kc(n)}}var _e,We,Ie=((_e=function(){function e(){_classCallCheck(this,e),this.values=[1e-4,.001,.005,.01,.05,.1],this.pvalue=.001,this.pvalue$=new u.o}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.pvalue$.emit(this.pvalue)}},{key:"selected",value:function(e){this.pvalue$.emit(e.value)}}]),e}()).\u0275fac=function(e){return new(e||_e)},_e.\u0275cmp=u.Kb({type:_e,selectors:[["bd2-pvalue-form"]],outputs:{pvalue$:"pvalue$"},decls:8,vars:2,consts:[[1,"form-inline"],[1,"mx-auto","text-center"],["id","pvalues-label",1,"mb-1"],["aria-label","Select p-value","aria-labelledby","pvalues-label",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(u.Wb(0,"form",0),u.Wb(1,"div",1),u.Wb(2,"mat-label",2),u.Wb(3,"strong"),u.Jc(4,"p-value threshold:"),u.Vb(),u.Vb(),u.Wb(5,"div"),u.Wb(6,"mat-radio-group",3),u.ec("change",(function(e){return t.selected(e)})),u.Hc(7,Pe,2,2,"mat-radio-button",4),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e&&(u.Cb(6),u.oc("value",t.pvalue),u.Cb(1),u.oc("ngForOf",t.values))},directives:[Je.C,Je.q,Je.r,Ve.g,we.b,o.l,we.a],styles:[".mat-radio-button[_ngcontent-%COMP%]  {\n      margin-right: 15px;\n    }"]}),_e),Te=n("1jcm"),Oe=((We=function(){function e(){_classCallCheck(this,e),this.options=new u.o,this.currentOptions=new I(0,!1,!1,!1)}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"pValue",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.pValue=e,this.options.next(this.currentOptions)}},{key:"bhCorrection",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.bhCorrection=e,this.options.next(this.currentOptions)}},{key:"circadian",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.circadian=e,this.options.next(this.currentOptions)}},{key:"showPattern",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.showPattern=e,this.options.next(this.currentOptions)}}]),e}()).\u0275fac=function(e){return new(e||We)},We.\u0275cmp=u.Kb({type:We,selectors:[["bd2-stat-test-options-widget"]],outputs:{options:"options"},decls:14,vars:1,consts:[[3,"pvalue$"],[2,"margin-top","0.5em","text-align","center"],[3,"change"],["pattern",""],[3,"disabled","change"]],template:function(e,t){if(1&e&&(u.Wb(0,"mat-card"),u.Wb(1,"mat-card-content"),u.Wb(2,"section"),u.Wb(3,"bd2-pvalue-form",0),u.ec("pvalue$",(function(e){return t.pValue(e)})),u.Vb(),u.Vb(),u.Wb(4,"section",1),u.Wb(5,"mat-slide-toggle",2),u.ec("change",(function(e){return t.bhCorrection(e.checked)})),u.Jc(6,"Benjamini Hochberg correction"),u.Vb(),u.Vb(),u.Wb(7,"section",1),u.Wb(8,"mat-slide-toggle",2,3),u.ec("change",(function(e){return t.showPattern(e.checked)})),u.Jc(10,"show pattern"),u.Vb(),u.Jc(11," \xa0 "),u.Wb(12,"mat-slide-toggle",4),u.ec("change",(function(e){return t.circadian(e.checked)})),u.Jc(13,"circadian unit"),u.Vb(),u.Vb(),u.Vb(),u.Vb()),2&e){var n=u.xc(9);u.Cb(12),u.oc("disabled",!n.checked)}},directives:[Ce.a,Ce.c,Ie,Te.a],encapsulation:2}),We);function De(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",5),u.Wb(1,"button",13),u.ec("click",(function(){return u.Ac(n),u.ic(2).delete()})),u.Wb(2,"i",4),u.Jc(3,"delete_forever"),u.Vb(),u.Vb(),u.Wb(4,"button",14),u.ec("click",(function(){return u.Ac(n),u.ic(2).export()})),u.Wb(5,"i",4),u.Jc(6,"save_alt"),u.Vb(),u.Vb(),u.Vb()}}function Re(e,t){if(1&e&&(u.Wb(0,"div",15),u.Rb(1,"br"),u.Jc(2),u.Vb()),2&e){var n=u.ic().ngIf;u.Cb(2),u.Lc("ERROR: ",n.jobStatus.message," ")}}function je(e,t){1&e&&(u.Wb(0,"div"),u.Wb(1,"mat-card"),u.Wb(2,"mat-card-content"),u.Rb(3,"mat-spinner",16),u.Vb(),u.Vb(),u.Vb())}function He(e,t){1&e&&(u.Wb(0,"div"),u.Wb(1,"mat-card"),u.Wb(2,"mat-card-content"),u.Wb(3,"div",17),u.Jc(4,"It may take up to 10 minutes to test for rhythmicity"),u.Vb(),u.Vb(),u.Vb(),u.Vb())}function xe(e,t){if(1&e){var n=u.Xb();u.Ub(0),u.Wb(1,"bd2-stat-test-options-widget",18),u.ec("options",(function(e){return u.Ac(n),u.ic(3).statTestOptions(e)})),u.Vb(),u.Rb(2,"bd2-rhythmicity-results-mdtable",19),u.Tb()}if(2&e){var r=t.ngIf,i=u.ic(3);u.Cb(2),u.oc("statTestParams",i.statTestParams)("job",r)}}function Ee(e,t){if(1&e&&(u.Wb(0,"div"),u.Rb(1,"mat-divider"),u.Hc(2,je,4,0,"div",12),u.jc(3,"async"),u.Hc(4,He,5,0,"div",12),u.Hc(5,xe,3,2,"ng-container",12),u.jc(6,"async"),u.Vb()),2&e){var n=u.ic().ngIf,r=u.ic();u.Cb(2),u.oc("ngIf",u.kc(3,3,r.rhythmicityJobDatasource.isReloading$)),u.Cb(2),u.oc("ngIf","SUBMITTED"===n.jobStatus.state),u.Cb(1),u.oc("ngIf",u.kc(6,5,r.rhythmicityJobDatasource.finishedJob$))}}function Me(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",1),u.Wb(1,"div",2),u.Wb(2,"div",3),u.ec("click",(function(){return u.Ac(n),u.ic().toggleExpanded()})),u.Wb(3,"i",4),u.Jc(4,"waves"),u.Vb(),u.Jc(5),u.jc(6,"date"),u.Rb(7,"br"),u.Jc(8),u.Vb(),u.Wb(9,"div",5),u.Jc(10),u.Wb(11,"a",6),u.ec("click",(function(){return u.Ac(n),u.ic().refresh()})),u.Wb(12,"i",7),u.Jc(13,"refresh"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(14,"div",8),u.Wb(15,"mat-card"),u.Wb(16,"mat-card-content"),u.Wb(17,"div",9),u.Hc(18,De,7,0,"div",10),u.Jc(19),u.Hc(20,Re,3,1,"div",11),u.Vb(),u.Vb(),u.Vb(),u.Hc(21,Ee,7,7,"div",12),u.Vb(),u.Vb()}if(2&e){var r=t.ngIf,i=u.ic();u.Cb(3),u.Gc("color",i.isExpanded?"green":"red")("font-size",150,"%"),u.Cb(2),u.Mc(" \xa0",i.shortUUID(r.jobId)," (",u.kc(6,13,i.toLocalDateTime(r.jobStatus.submitted)),") "),u.Cb(3),u.Mc(" ",i.friendlyMethod(r.parameters.METHOD),"; \xa0 waveforms: ",r.parameters.PRESET," "),u.Cb(2),u.Lc(" ",r.jobStatus.state," "),u.Cb(8),u.oc("ngIf",i.assay.security.canWrite),u.Cb(1),u.Lc(" ",r.parameters.PARAMS_SUMMARY," "),u.Cb(1),u.oc("ngIf",r.jobStatus.message&&"OK"!=r.jobStatus.message),u.Cb(1),u.oc("ngIf",i.isExpanded)}}var Ae,Ke=((Ae=function(){function e(t,n,r,i){_classCallCheck(this,e),this.rhythmicityService=t,this.rhythmicityJobDatasource=n,this.feedback=r,this.dialogs=i,this.deleted=new u.o,this.isExpanded=!1,this.expandedToogleStream=new l.a(!1)}return _createClass(e,[{key:"ngOnInit",value:function(){this.initSubscriptions()}},{key:"ngOnDestroy",value:function(){this.rhythmicityJobDatasource.close(),this.expandedToogleStream&&this.expandedToogleStream.complete()}},{key:"ngOnChanges",value:function(e){(e.jobId||e.assay)&&this.jobId&&this.assay&&this.rhythmicityJobDatasource.assayJob([this.assay.id,this.jobId])}},{key:"statTestOptions",value:function(e){var t=this,n=Object(b.a)(1).subscribe((function(){t.statTestParams=e,n&&n.unsubscribe()}))}},{key:"export",value:function(){var e=this;this.rhythmicityService.downloadJob(this.assay.id,this.jobId).subscribe((function(t){e.saveJobBlob(t,e.assay.id,e.jobId)}),(function(t){return e.feedback.error(t)}))}},{key:"saveJobBlob",value:function(e,t,n){d.saveAs(e,t+"_job"+this.shortUUID(n)+".rhythmicity.csv")}},{key:"refresh",value:function(){this.rhythmicityJobDatasource.refresh(),this.resultsTable&&this.resultsTable.reload()}},{key:"delete",value:function(){var e=this,t=this.assay,n=this.rhythmicityJobDatasource.currentJob;this.dialogs.confirm("Do you want to delete analysis: "+n.jobId,n.parameters.PARAMS_SUMMARY).subscribe((function(r){r&&e.doDelete(t,n.jobId)}))}},{key:"initSubscriptions",value:function(){var e=this;this.rhythmicityJobDatasource.on(!0),this.rhythmicityJobDatasource.error$.forEach((function(t){return e.feedback.error(t)}))}},{key:"doDelete",value:function(e,t){var n=this;this.rhythmicityService.deleteJob(e,t).subscribe((function(e){n.deleted.next(e),n.feedback.success("Job: "+n.shortUUID(t)+" deleted")}),(function(e){n.feedback.error(e)}))}},{key:"toggleExpanded",value:function(){this.expanded=!this.isExpanded}},{key:"toLocalDateTime",value:function(e){return h.b.deserialize(e).date}},{key:"shortUUID",value:function(e){return Object(ve.c)(e)}},{key:"friendlyMethod",value:function(e){return"BD2JTK"==e?"Classic JTK":"BD2EJTK"==e?"BD2 eJTK":e}},{key:"expanded",set:function(e){this.isExpanded=e,this.expandedToogleStream.next(e)}}]),e}()).\u0275fac=function(e){return new(e||Ae)(u.Qb(g),u.Qb(C),u.Qb(D.a),u.Qb(ge.a))},Ae.\u0275cmp=u.Kb({type:Ae,selectors:[["bd2-rhythmicity-job-pane"]],viewQuery:function(e,t){var n;1&e&&u.Pc(ye,!0),2&e&&u.wc(n=u.fc())&&(t.resultsTable=n.first)},inputs:{jobId:"jobId",assay:"assay",expanded:"expanded"},outputs:{deleted:"deleted"},features:[u.Bb([C]),u.Ab],decls:2,vars:3,consts:[["class","card mb-2",4,"ngIf"],[1,"card","mb-2"],[1,"card-header","clearfix"],["role","button",1,"float-left",3,"click"],[1,"material-icons","bd-icon"],[1,"float-right"],["role","button","aria-label","refresh",3,"click"],[1,"material-icons","bd-icon","bd-primary"],[1,"card-body"],[1,"clearfix"],["class","float-right",4,"ngIf"],["class","text-danger","style","word-wrap: break-word;",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"text-danger",2,"word-wrap","break-word"],[1,"center-block"],[2,"margin-top","0.5em","text-align","center"],[3,"options"],[3,"statTestParams","job"]],template:function(e,t){1&e&&(u.Hc(0,Me,22,15,"div",0),u.jc(1,"async")),2&e&&u.oc("ngIf",u.kc(1,1,t.rhythmicityJobDatasource.allJob$))},directives:[o.m,Ce.a,Ce.c,ke.a,Se.b,Oe,ye],pipes:[o.b,o.e],encapsulation:2}),Ae),Be=n("GVyA");function $e(e,t){if(1&e&&(u.Wb(0,"div"),u.Wb(1,"strong"),u.Jc(2),u.Vb(),u.Vb()),2&e){var n=u.ic(2);u.Cb(2),u.Lc("Submitted jobs: ",n.jobs.length,"")}}function Le(e,t){1&e&&(u.Wb(0,"div"),u.Jc(1," No jobs submitted, start a new test. "),u.Vb())}var Ue=function(){return["new"]};function Ne(e,t){1&e&&(u.Wb(0,"a",7),u.Jc(1," New test "),u.Vb()),2&e&&u.oc("routerLink",u.qc(1,Ue))}function Fe(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div"),u.Wb(1,"bd2-rhythmicity-job-pane",8),u.ec("deleted",(function(e){return u.Ac(n),u.ic(2).remove(e)}))("finished",(function(e){return u.Ac(n),u.ic(2).refreshJob(e)})),u.Vb(),u.Vb()}if(2&e){var r=t.$implicit,i=t.index,a=u.ic(2);u.Cb(1),u.oc("assay",a.assay)("jobId",r)("expanded",a.expandAll||0==i)}}function ze(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div"),u.Wb(1,"h3"),u.Jc(2,"Rhythmicity tests"),u.Vb(),u.Rb(3,"hr"),u.Wb(4,"div",1),u.Wb(5,"div",2),u.Hc(6,$e,3,1,"div",0),u.Hc(7,Le,2,0,"div",0),u.Vb(),u.Wb(8,"div",3),u.Hc(9,Ne,2,2,"a",4),u.Wb(10,"button",5),u.ec("click",(function(){return u.Ac(n),u.ic().refresh()})),u.Jc(11,"Refresh "),u.Vb(),u.Vb(),u.Vb(),u.Rb(12,"hr"),u.Hc(13,Fe,2,3,"div",6),u.Rb(14,"hr"),u.Vb()}if(2&e){var r=u.ic();u.Cb(6),u.oc("ngIf",r.jobs&&r.jobs.length>0),u.Cb(1),u.oc("ngIf",!r.jobs||0==r.jobs.length),u.Cb(2),u.oc("ngIf",r.assay.security.canWrite),u.Cb(1),u.oc("disabled",r.blocked),u.Cb(3),u.oc("ngForOf",r.jobsIds)}}var qe,Qe=((qe=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this,e,r)).expandAll=!1,i.blocked=!1,i.titlePart=" Rhythm",i}return _createClass(n,[{key:"updateModel",value:function(e){_get(_getPrototypeOf(n.prototype),"updateModel",this).call(this,e),e&&this.loadJobs(e)}},{key:"loadJobs",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.blocked=!0,this.rhythmicityService.getJobs(e).subscribe((function(r){t.jobs=r,t.refreshJobsInfo(r),t.exportURL=t.rhythmicityService.exportURL(e),n&&t.refreshPanes(),t.blocked=!1}),(function(e){t.blocked=!1,t.feedback.error(e)}))}},{key:"refreshJobsInfo",value:function(e){this.jobsIds=e.map((function(e){return e.jobId}))}},{key:"refresh",value:function(){this.loadJobs(this.assay,!0)}},{key:"refreshPanes",value:function(){this.panes&&this.panes.forEach((function(e){return e.refresh()}))}},{key:"remove",value:function(e){var t=this.jobs.findIndex((function(t){return e.jobId===t.jobId}));t>=0&&(this.jobs.splice(t,1),this.refreshJobsInfo(this.jobs))}},{key:"refreshJob",value:function(e){var t=this.jobs.findIndex((function(t){return e.jobId===t.jobId}));t>=0&&(this.jobs[t]=e,this.refreshJobsInfo(this.jobs))}},{key:"calculateQueuing",value:function(e){var t=this;return e.filter((function(e){return t.isQueueing(e.jobStatus.state)})).length}},{key:"isQueueing",value:function(e){switch(e){case"WAITING":case"PROCESSING":case"SUBMITTED":return!0;default:return!1}}},{key:"checkFinished",value:function(e){var t=this;return!!e.find((function(e){return t.isFinished(e.jobStatus.state)}))}},{key:"isFinished",value:function(e){switch(e){case"SUCCESS":case"FINISHED":case"COMPLETED":return!0;default:return!1}}}]),n}(s)).\u0275fac=function(e){return new(e||qe)(u.Qb(g),u.Qb(Be.a))},qe.\u0275cmp=u.Kb({type:qe,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&u.Pc(Ke,!0),2&e&&u.wc(n=u.fc())&&(t.panes=n)},features:[u.zb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-body"],["class","btn btn-primary mr-1",3,"routerLink",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary",3,"disabled","click"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary","mr-1",3,"routerLink"],[3,"assay","jobId","expanded","deleted","finished"]],template:function(e,t){1&e&&u.Hc(0,ze,15,5,"div",0),2&e&&u.oc("ngIf",t.assay)},directives:[o.m,o.l,c.e,Ke],encapsulation:2}),qe),Ge=n("QBpm"),Xe=n("Kj3r"),Ye=n("bngM"),Ze=n("ZMwR"),et=n("naqj"),tt=n("Tl2h"),nt=n("wcxA");function rt(e,t){if(1&e&&(u.Wb(0,"option",29),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n.name),u.Cb(1),u.Kc(n.label)}}function it(e,t){1&e&&(u.Wb(0,"div",30),u.Wb(1,"div",31),u.Jc(2," Rhythmicity tests are generally used for short, sparse timeseries. "),u.Rb(3,"br"),u.Jc(4," The current limit is 5 or 4 days of hourly sampled data for eJTK preset and BD2 preset respectivelly."),u.Rb(5,"br"),u.Jc(6," Generally the raw data are being analysed, but we also enabled a linear detrended option. "),u.Vb(),u.Vb())}function at(e,t){if(1&e&&(u.Wb(0,"option",29),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n.name),u.Cb(1),u.Kc(n.label)}}function ot(e,t){1&e&&(u.Wb(0,"div",30),u.Wb(1,"div",31),u.Wb(2,"p"),u.Wb(3,"b"),u.Jc(4,"Classic JTK"),u.Vb(),u.Jc(5," is the implementation of JTK_CYCLE from "),u.Wb(6,"a",32),u.Jc(7,"Michael E. Hughes et al. 2010"),u.Vb(),u.Jc(8," a standard method for detecting rhythmicity in genome-scale datasets. "),u.Rb(9,"br"),u.Jc(10,"The method is fast but it is reliable only when it tests against small set of patterns, we provide patterns of 24h cosines with different phases."),u.Vb(),u.Wb(11,"p"),u.Wb(12,"b"),u.Jc(13,"BD2 eJTK"),u.Vb(),u.Jc(14," is the BioDare2 implementation of Empirical JTK_CYCLE with asymmetry search from "),u.Wb(15,"a",33),u.Jc(16,"Alan L. Hutchison et al. 2015"),u.Vb(),u.Jc(17,". It is similar to the classic JTK method but with p values empirically calculated against set of random noise data. "),u.Rb(18,"br"),u.Jc(19,"This modification permits using larger sets of test patterns and it provides better accuracy. However, this method is much slower so it can only analyze timeseries only up to 5 days of data (though the Classic JTK method was never intended to be used with such a long data)."),u.Vb(),u.Vb(),u.Vb())}function ct(e,t){if(1&e&&(u.Wb(0,"option",29),u.Jc(1),u.Vb()),2&e){var n=t.$implicit;u.oc("value",n.name),u.Cb(1),u.Kc(n.label)}}function st(e,t){1&e&&(u.Wb(0,"div",30),u.Wb(1,"div",31),u.Jc(2," Presets determine set of pattern curves against the comparison test is run."),u.Rb(3,"br"),u.Wb(4,"ul"),u.Wb(5,"li"),u.Jc(6,"Cosine 24h 1/2/4h are set of cosine curves of 24h periods, and phases spread every 1, 2, or 4 hours. To be used mainly with Classic JTK."),u.Vb(),u.Wb(7,"li"),u.Jc(8,"eJTK Classic is recommended for typical omics-like data for which eJTK method was developed. "),u.Rb(9,"br"),u.Jc(10," It works well for short data (48h, 2h- 1h-sampled) when actual period is within range 22-26 hours."),u.Rb(11,"br"),u.Jc(12," The patterns are series of cosine-like waveforms with 24h period, phases by 2hours and range of asymmetries by 2h (see original paper)."),u.Rb(13,"br"),u.Vb(),u.Wb(14,"li"),u.Jc(15,"BD2 Classic can detect non 24 periods and some forms of the spikes."),u.Rb(16,"br"),u.Jc(17," As it compares against much more patterns it has a weaker power."),u.Rb(18,"br"),u.Jc(19," It should be used when there is a good reason to suspect periods outside 22-26h range."),u.Rb(20,"br"),u.Jc(21," The patterns are series of cosine-like waverforms with periods from 18-35hours, for each period there are multiple "),u.Wb(22,"b"),u.Jc(23,"circadian"),u.Vb(),u.Jc(24," phases with step 2h (so each period value generates the same number of patterns but the peaks in absolute units do not coincide) and a range of assymetries by 2h in circadian units (see original paper). The preset contains also additional some spike patterns. "),u.Vb(),u.Vb(),u.Vb(),u.Vb())}var ut,lt=function(){return[10,25,50,100,200]},bt=((ut=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).methodOptions=V,r.presetOptions=P,r.dataHelp=!1,r.presetsHelp=!1,r.methodHelp=!1,r.rhythmicityRequests=new u.o,r.detrendingOptions=[tt.b.NO_DTR,tt.b.LIN_DTR],r.methodForm=r.mainForm.get("method"),r.presetForm=r.mainForm.get("preset"),r}return _createClass(n,[{key:"buildMainForm",value:function(){var e=this;return this.fb.group({displayParams:this.displayParamsForm,periodScale:this.fb.group({periodMin:[18,[Je.A.required]],periodMax:[34,[Je.A.required]]},{validator:function(t){return e.validPeriodScale(t.value)}}),method:[J.BD2EJTK.name,[Je.A.required]],preset:[w.EJTK_CLASSIC.name,[Je.A.required]]})}},{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.methodForm.valueChanges.subscribe((function(t){return e.setPresetOptions(t)}))}},{key:"ngOnDestroy",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this)}},{key:"setPresetOptions",value:function(e){e===J.BD2EJTK.name?(this.presetOptions=P,this.presetForm.setValue(w.EJTK_CLASSIC.name)):e===J.BD2JTK.name?(this.presetOptions=_,this.presetForm.setValue(w.COS_2H.name)):this.presetOptions=[]}},{key:"defaultDetrending",value:function(){return tt.b.NO_DTR.name}},{key:"validPeriodScale",value:function(e){var t=e.periodMin,n=e.periodMax;return t<10?{validPeriodScale:"Period min must >= 10"}:n<10?{validPeriodScale:"Period max must >= 10"}:n>50?{validPeriodScale:"Period max must < 50"}:t>=n?{validPeriodScale:"Period min must be < max"}:null}},{key:"analyse",value:function(){if(!this.mainForm.invalid){var e=this.map2RhythmicityRequest(this.mainForm.value);e.isValid()&&this.rhythmicityRequests.next(e)}}},{key:"map2RhythmicityRequest",value:function(e){var t=new W;return t.detrending=tt.b.get(e.displayParams.detrending),t.method=J.get(e.method),t.preset=w.get(e.preset),t.periodMax=e.periodScale.periodMax,t.periodMin=e.periodScale.periodMin,t.windowEnd=e.displayParams.timeScale.timeEnd,t.windowStart=e.displayParams.timeScale.timeStart,t}}]),n}(nt.a)).\u0275fac=function(e){return new(e||ut)(u.Qb(Je.d))},ut.\u0275cmp=u.Kb({type:ut,selectors:[["bd2-rhythmicityjob-params-rform"]],inputs:{disabled:"disabled",totalTraces:"totalTraces",currentPage:"currentPage"},outputs:{displayParams:"displayParams",rhythmicityRequests:"rhythmicityRequests"},features:[u.zb],decls:61,vars:15,consts:[["role","form",1,"form-horizontal",3,"formGroup"],["formGroupName","displayParams"],["formGroupName","timeScale",1,"form-group","row"],[1,"col-sm-4"],["for","windowStart",1,"col-sm-1"],[1,"col-sm-2"],["formControlName","timeStart","id","windowStart","min","0","required","","size","5","step","any","type","number",1,"form-control"],["for","windowEnd",1,"col-sm-1"],["formControlName","timeEnd","id","windowEnd","min","0","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],[1,"form-group","row"],["for","detrending",1,"col-sm-4"],[3,"click"],[1,"material-icons","bd-icon","bd-primary"],[1,"col-sm-6"],["formControlName","detrending","id","detrending","required","",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["class","col-sm-12",4,"ngIf"],["for","method",1,"col-sm-4"],["formControlName","method","id","method","required","",1,"form-control"],["formControlName","preset","id","preset","required","",1,"form-control"],["formGroupName","periodScale",1,"form-group","row",3,"hidden"],["for","periodMin",1,"col-sm-1"],["formControlName","periodMin","id","periodMin","max","50","min","10","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],["for","periodMax",1,"col-sm-1"],["formControlName","periodMax","id","periodMax","max","50","min","10","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],[1,"col-sm-8"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["dataPaginator",""],["type","button",1,"btn","btn-primary",3,"disabled","click"],[3,"value"],[1,"col-sm-12"],["role","alert","type","info",1,"alert","alert-info"],["href","https://dx.doi.org/10.1177%2F0748730410379711"],["href"," https://doi.org/10.1371/journal.pcbi.1004094","target","_blank"]],template:function(e,t){1&e&&(u.Wb(0,"form",0),u.Wb(1,"div",1),u.Wb(2,"div",2),u.Wb(3,"label",3),u.Jc(4,"Data window"),u.Vb(),u.Wb(5,"label",4),u.Jc(6,"from:"),u.Vb(),u.Wb(7,"div",5),u.Rb(8,"input",6),u.Vb(),u.Wb(9,"label",7),u.Jc(10,"to:"),u.Vb(),u.Wb(11,"div",5),u.Rb(12,"input",8),u.Vb(),u.Vb(),u.Wb(13,"div",9),u.Wb(14,"label",10),u.Jc(15,"Input Data "),u.Wb(16,"a",11),u.ec("click",(function(){return t.dataHelp=!t.dataHelp})),u.Wb(17,"i",12),u.Jc(18,"help"),u.Vb(),u.Vb(),u.Vb(),u.Wb(19,"div",13),u.Wb(20,"select",14),u.Hc(21,rt,2,2,"option",15),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Hc(22,it,7,0,"div",16),u.Wb(23,"div",9),u.Wb(24,"label",17),u.Jc(25,"Test Method "),u.Wb(26,"a",11),u.ec("click",(function(){return t.methodHelp=!t.methodHelp})),u.Wb(27,"i",12),u.Jc(28,"help"),u.Vb(),u.Vb(),u.Vb(),u.Wb(29,"div",13),u.Wb(30,"select",18),u.Hc(31,at,2,2,"option",15),u.Vb(),u.Vb(),u.Vb(),u.Hc(32,ot,20,0,"div",16),u.Wb(33,"div",9),u.Wb(34,"label",17),u.Jc(35,"Analysis Presets "),u.Wb(36,"a",11),u.ec("click",(function(){return t.presetsHelp=!t.presetsHelp})),u.Wb(37,"i",12),u.Jc(38,"help"),u.Vb(),u.Vb(),u.Vb(),u.Wb(39,"div",13),u.Wb(40,"select",19),u.Hc(41,ct,2,2,"option",15),u.Vb(),u.Vb(),u.Vb(),u.Hc(42,st,25,0,"div",16),u.Wb(43,"div",20),u.Wb(44,"label",3),u.Jc(45,"Expected periods"),u.Vb(),u.Wb(46,"label",21),u.Jc(47,"from:"),u.Vb(),u.Wb(48,"div",5),u.Rb(49,"input",22),u.Vb(),u.Wb(50,"label",23),u.Jc(51,"to:"),u.Vb(),u.Wb(52,"div",5),u.Rb(53,"input",24),u.Vb(),u.Vb(),u.Wb(54,"div",9),u.Rb(55,"label",5),u.Wb(56,"div",25),u.Wb(57,"mat-paginator",26,27),u.ec("page",(function(e){return t.loadDataPage(e)})),u.Vb(),u.Vb(),u.Vb(),u.Wb(59,"button",28),u.ec("click",(function(){return t.analyse()})),u.Jc(60,"Test Rhythmicity "),u.Vb(),u.Vb()),2&e&&(u.oc("formGroup",t.mainForm),u.Cb(21),u.oc("ngForOf",t.detrendingOptions),u.Cb(1),u.oc("ngIf",t.dataHelp),u.Cb(9),u.oc("ngForOf",t.methodOptions),u.Cb(1),u.oc("ngIf",t.methodHelp),u.Cb(9),u.oc("ngForOf",t.presetOptions),u.Cb(1),u.oc("ngIf",t.presetsHelp),u.Cb(1),u.oc("hidden",!0),u.Cb(14),u.oc("length",t.totalTraces)("disabled",t.disabledPagination)("pageSize",t.currentPage.pageSize)("pageIndex",t.currentPage.pageIndex)("pageSizeOptions",u.qc(14,lt)),u.Cb(2),u.oc("disabled",t.disabled||t.mainForm.invalid))},directives:[Je.C,Je.q,Je.h,Je.i,Je.c,Je.u,Je.p,Je.g,Je.y,Je.z,o.l,o.m,k.a,Je.t,Je.B],encapsulation:2}),ut),ht=n("nA4b");function dt(e,t){if(1&e&&u.Rb(0,"bd2-ts-plots",3),2&e){var n=u.ic(3);u.oc("data",n.timeseries)("tracesPerPlot",n.tracesPerPlot)}}function ft(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div"),u.Wb(1,"bd2-rhythmicityjob-params-rform",1),u.ec("displayParams",(function(e){return u.Ac(n),u.ic(2).emitDisplayParams(e)}))("rhythmicityRequests",(function(e){return u.Ac(n),u.ic(2).doAnalysis(e)})),u.Vb(),u.Rb(2,"hr"),u.Hc(3,dt,1,2,"bd2-ts-plots",2),u.Vb()}if(2&e){var r=u.ic(2);u.Cb(1),u.oc("disabled",r.blocked)("totalTraces",r.totalTraces)("currentPage",r.currentPage),u.Cb(2),u.oc("ngIf",r.timeseries)}}function pt(e,t){if(1&e&&(u.Wb(0,"div"),u.Wb(1,"h3"),u.Jc(2,"Start rhythmicity test"),u.Vb(),u.Rb(3,"hr"),u.Hc(4,ft,4,4,"div",0),u.Vb()),2&e){var n=u.ic();u.Cb(4),u.oc("ngIf",!n.disabled)}}var mt,yt,vt,gt=[{path:"",children:[{path:"new",component:(mt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,a,o){var c;return _classCallCheck(this,n),(c=t.call(this,a,o)).fetcher=e,c.analytics=r,c.userService=i,c.disabled=!1,c.blocked=!1,c.tracesPerPlot=5,c.totalTraces=0,c.currentPage=Ye.a.firstPage(),c.titlePart=" New Test",c}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.timeSeriesSubsripction=this.fetcher.seriesPackStream.pipe(Object(Xe.a)(1e3)).subscribe((function(t){var n=t.data;e.tracesPerPlot=Math.max(5,n.length/20),e.timeseries=n,e.totalTraces=t.totalTraces,e.currentPage=t.currentPage}),(function(t){console.log("Error in TS subscription: "+t),e.feedback.error(t)}))}},{key:"ngOnDestroy",value:function(){this.timeSeriesSubsripction&&this.timeSeriesSubsripction.unsubscribe(),this.fetcher.ngOnDestroy(),_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this)}},{key:"emitDisplayParams",value:function(e){this.fetcher.changeDisplayParams(e)}},{key:"doAnalysis",value:function(e){var t=this;e.isValid()&&(this.blocked=!0,this.rhythmicityService.newTest(this.assay,e).subscribe((function(n){t.feedback.success("Rhythmicity test submitted"),t.analytics.rhythmicityNew(e.method.name,t.assay.id,t.userService.currentUser.login),t.refreshModel(),t.goToRhythmicityHome()}),(function(e){t.blocked=!1,t.feedback.error(e)})))}},{key:"updateModel",value:function(e){this.fetcher.experiment(e),_get(_getPrototypeOf(n.prototype),"updateModel",this).call(this,e)}}]),n}(s),mt.\u0275fac=function(e){return new(e||mt)(u.Qb(Ge.a),u.Qb(Ze.a),u.Qb(et.a),u.Qb(g),u.Qb(Be.a))},mt.\u0275cmp=u.Kb({type:mt,selectors:[["ng-component"]],features:[u.Bb([Ge.a]),u.zb],decls:1,vars:1,consts:[[4,"ngIf"],[3,"disabled","totalTraces","currentPage","displayParams","rhythmicityRequests"],[3,"data","tracesPerPlot",4,"ngIf"],[3,"data","tracesPerPlot"]],template:function(e,t){1&e&&u.Hc(0,pt,5,1,"div",0),2&e&&u.oc("ngIf",t.assay)},directives:[o.m,bt,ht.a],encapsulation:2}),mt)},{path:"",component:Qe,pathMatch:"full"}]}],Ct=((yt=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ob({type:yt}),yt.\u0275inj=u.Nb({factory:function(e){return new(e||yt)},imports:[[c.f.forChild(gt)],c.f]}),yt),kt=n("wMBR"),St=n("a6j2"),Jt=n("ZTEM"),Vt=((vt=function e(){_classCallCheck(this,e)}).\u0275mod=u.Ob({type:vt}),vt.\u0275inj=u.Nb({factory:function(e){return new(e||vt)},imports:[[o.c,Je.j,Je.x,kt.a,St.a,Jt.a,Ct]]}),vt)}}]);