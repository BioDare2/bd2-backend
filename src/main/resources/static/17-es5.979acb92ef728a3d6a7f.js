!function(){function e(t,n,r){return(e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(t,n,r||t)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(s){i=!0,a=s}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var i=b(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{ja10:function(n,i,c){"use strict";c.r(i),c.d(i,"RhythmicityModule",(function(){return Bt}));var u,l,d,h=c("ofXK"),f=c("tyNb"),p=c("yYXI"),m=c("fXoL"),y=c("FjDX"),v=c("GVyA"),g=((u=function(e){o(n,e);var t=s(n);function n(e,i){var a;return r(this,n),(a=t.call(this,i)).rhythmicityService=e,a.titlePart=" Rhythm",a}return a(n,[{key:"goToRhythmicityHome",value:function(e){var t=this.expHomePath(e);t.push("rhythmicity"),this.router.navigate(t)}}]),n}(p.a)).\u0275fac=function(e){return new(e||u)(m.Nb(y.a),m.Nb(v.a))},u.\u0275dir=m.Ib({type:u,features:[m.yb]}),u),S=c("2Vo4"),T=c("PqYM"),D=c("B9cw"),k=c("Iab2"),B=c("7jps"),w=c("zQ7r"),P=c("Iurr"),j=c("tu3j"),O=((l=function(e){o(i,e);var n=s(i);function i(e){var t,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r(this,i),(t=n.call(this,a)).rhythmicityService=e,t.finishedJob$=t.finished$,t.runningJob$=t.running$,t.allJob$=t.all$,t}return a(i,[{key:"initIntervalsKeeper",value:function(){return new j.a(1e3,3e4,6e5,2)}},{key:"assayJob",value:function(e){this.input(e)}},{key:"sameInput",value:function(e,t){return e[1]===t[1]&&e[0]===t[0]}},{key:"fetchAsset",value:function(e){var n=t(e,2),r=n[0],i=n[1];return this.rhythmicityService.getJob(r,i)}},{key:"hasFailed",value:function(e){return B.e.hasFailed(e)}},{key:"isFinished",value:function(e){return B.e.isFinished(e)}},{key:"isRunning",value:function(e){return B.e.isRunning(e)}},{key:"assetToId",value:function(e){return e.jobId}},{key:"assetToInput",value:function(e){return[e.parentId,e.jobId]}},{key:"currentJob",get:function(){return this.currentAsset}}]),i}(w.a)).\u0275fac=function(e){return new(e||l)(m.Xb(y.a),m.Xb(P.a,8))},l.\u0275prov=m.Jb({token:l,factory:l.\u0275fac}),l),I=c("M9IT"),C=c("vkgz"),x=c("8jiw"),E=((d=function(e){o(n,e);var t=s(n);function n(e){var i,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r(this,n),(i=t.call(this,a)).rhythmicityService=e,i.results$=i.data$,i}return a(n,[{key:"isClassicJob",value:function(){var e,t;return"BD2JTK"===(null===(t=null===(e=this.currentInput)||void 0===e?void 0:e.parameters)||void 0===t?void 0:t.METHOD)}},{key:"sameInput",value:function(e,t){return B.e.sameJob(e,t)}},{key:"assetToData",value:function(e,t){return e.results}},{key:"fetchAsset",value:function(e){var t=this;return this.rhythmicityService.getResults(e.parentId,e.jobId).pipe(Object(C.a)((function(e){return t.labelPatterns(e)})))}},{key:"sortingKey",value:function(e){switch(e.active){case"label":return function(e){return e.label};case"id":return function(e){return+e.id};case"empp":return function(e){return+e.result.empP};case"emppbh":return function(e){return+e.result.empPBH};case"p":return function(e){return+e.result.p};case"pbh":return function(e){return+e.result.pBH};case"tau":return function(e){return+e.result.tau};case"period":return function(e){return e.result.pattern.period};case"peak":return function(e){return e.result.pattern.peak};case"trough":return function(e){return e.result.pattern.trough};default:return console.error("Not implemented sorting for "+e.active),function(e){return 0}}}},{key:"processData",value:function(e,t){return t?(this.rankResults(e,t.pValue,t.bhCorrection,this.isClassicJob()),e):e}},{key:"labelPatterns",value:function(e){var t=this;e.results.forEach((function(e){e.result.patternLabel=t.describePattern(e.result),e.result.pattern.shapeLabel=t.patternToShape(e.result.pattern)}))}},{key:"describePattern",value:function(e){var t=e.pattern,n=Math.round(10*t.period)/10,r=Math.round(100*t.peak)/100,i=Math.round(100*t.trough)/100;return"".concat(this.patternToShape(t),"\t").concat(n,"\t").concat(r,"\t").concat(i)}},{key:"patternToShape",value:function(e){switch(e.waveform){case"ASYM_COSINE":return.5===e.leftPortion?"COS":"ACOS";case"ASYM_COS_SPIKE":return"SPIKE";case"ASYM_COS_SPIKE_NEG":return"NPIKE";default:return e.waveform}}},{key:"rankResults",value:function(e,t,n,r){e.forEach((function(e){var i,a=e.result;i=r?n?a.pBH:a.p:n?a.empPBH:a.empP,a.rhythmic=i<t}))}}]),n}(x.a)).\u0275fac=function(e){return new(e||d)(m.Xb(y.a),m.Xb(P.a,8))},d.\u0275prov=m.Jb({token:d,factory:d.\u0275fac}),d),R=c("6tuW"),J=c("+0xr"),M=c("Dh3D"),$=c("bv9b");function H(e,t){1&e&&m.Ob(0,"mat-progress-bar",28)}function N(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"Id"),m.Sb())}function A(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(n.id)}}function F(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"Label"),m.Sb())}function _(e,t){if(1&e&&(m.Tb(0,"td",31),m.Dc(1),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(n.label)}}function K(e,t){1&e&&(m.Tb(0,"th",32),m.Dc(1,"Rhythmic"),m.Sb())}function z(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.Sb()),2&e){var n=t.$implicit;m.Fb("bold",n.result.rhythmic),m.Bb(1),m.Ec(n.result.rhythmic)}}function L(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"emp-p"),m.Sb())}function Q(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,n.result.empP,"1.0-5"))}}function q(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"BH emp-p"),m.Sb())}function U(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,n.result.empPBH,"1.0-5"))}}function Z(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"Tau"),m.Sb())}function G(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,n.result.tau,"1.0-2"))}}function V(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"p"),m.Sb())}function X(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,n.result.p,"1.0-5"))}}function Y(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"BH p"),m.Sb())}function W(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,n.result.pBH,"1.0-5"))}}function ee(e,t){1&e&&(m.Tb(0,"th",32),m.Dc(1,"Pattern"),m.Sb())}function te(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(n.result.patternLabel)}}function ne(e,t){1&e&&(m.Tb(0,"th",32),m.Dc(1,"P.Shape"),m.Sb())}function re(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(n.result.pattern.shapeLabel)}}function ie(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"P.Period"),m.Sb())}function ae(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,n.result.pattern.period,"1.0-1"))}}function oe(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"P.Peak"),m.Sb())}function ce(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,n.result.pattern.peak,"1.1-1"))}}function se(e,t){1&e&&(m.Tb(0,"th",32),m.Dc(1,"P.Peak"),m.Sb())}function ue(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,24*n.result.pattern.peak/n.result.pattern.period,"1.1-1"))}}function be(e,t){1&e&&(m.Tb(0,"th",29),m.Dc(1,"P.Trough"),m.Sb())}function le(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,n.result.pattern.trough,"1.1-1"))}}function de(e,t){1&e&&(m.Tb(0,"th",32),m.Dc(1,"P.Trough"),m.Sb())}function he(e,t){if(1&e&&(m.Tb(0,"td",30),m.Dc(1),m.ec(2,"number"),m.Sb()),2&e){var n=t.$implicit;m.Bb(1),m.Ec(m.gc(2,1,24*n.result.pattern.trough/n.result.pattern.period,"1.1-1"))}}function fe(e,t){1&e&&m.Ob(0,"tr",33)}function pe(e,t){1&e&&m.Ob(0,"tr",34)}var me,ye=function(){return[10,25,50,100,250]},ve=((me=function(){function e(t,n){r(this,e),this.fetcher=t,this.feedback=n,this.normEmpPColumns=["id","label","rhythmic","empp","tau"],this.normClsPColumns=["id","label","rhythmic","p","tau"],this.bhEmpPColumns=["id","label","rhythmic","emppbh","tau"],this.bhClsPColumns=["id","label","rhythmic","pbh","tau"],this.patternColumns=["shape","period","peak","trough"],this.patternColumnsC=["shape","period","peakc","troughc"],this.displayedColumns=this.normEmpPColumns,this.disablePaginator=!1}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.fetcher.error$.subscribe((function(t){return e.feedback.error(t)}));var t=new I.d;t.pageSize=25,t.pageIndex=0,this.fetcher.page(t),this.fetcher.on(!0)}},{key:"ngOnDestroy",value:function(){this.fetcher.close()}},{key:"ngAfterViewInit",value:function(){}},{key:"reload",value:function(){this.fetcher.refresh()}},{key:"sortData",value:function(e){this.fetcher.sort(e)}},{key:"loadPage",value:function(e){this.fetcher.page(e)}},{key:"job",set:function(e){e&&this.fetcher.input(e)}},{key:"statTestParams",set:function(e){if(e){this.fetcher.params(e);var t=e.bhCorrection?this.bhEmpPColumns:this.normEmpPColumns;this.fetcher.isClassicJob()&&(t=e.bhCorrection?this.bhClsPColumns:this.normClsPColumns),e.showPattern&&(t=t.concat(e.circadian?this.patternColumnsC:this.patternColumns)),this.displayedColumns=t}}}]),e}()).\u0275fac=function(e){return new(e||me)(m.Nb(E),m.Nb(R.a))},me.\u0275cmp=m.Hb({type:me,selectors:[["bd2-rhythmicity-results-mdtable"]],inputs:{job:"job",statTestParams:"statTestParams"},features:[m.Ab([E])],decls:55,vars:18,consts:[[1,"mat-elevation-z8"],["mode","indeterminate",4,"ngIf"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["paginator",""],["mat-table","","matSort","","aria-label","Results","matSort","","matSortActive","id","matSortDirection","asc",1,"full-width-table",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","label"],["mat-cell","","class","word_wrapping","style","max-width: 100px",4,"matCellDef"],["matColumnDef","rhythmic"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"bold",4,"matCellDef"],["matColumnDef","empp"],["matColumnDef","emppbh"],["matColumnDef","tau"],["matColumnDef","p"],["matColumnDef","pbh"],["matColumnDef","pattern"],["matColumnDef","shape"],["matColumnDef","period"],["matColumnDef","peak"],["matColumnDef","peakc"],["matColumnDef","trough"],["matColumnDef","troughc"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["paginator2",""],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",1,"word_wrapping",2,"max-width","100px"],["mat-header-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,t){1&e&&(m.Tb(0,"div",0),m.Bc(1,H,1,0,"mat-progress-bar",1),m.ec(2,"async"),m.Tb(3,"mat-paginator",2,3),m.Zb("page",(function(e){return t.loadPage(e)})),m.Sb(),m.Tb(5,"table",4),m.Zb("matSortChange",(function(e){return t.sortData(e)})),m.Rb(6,5),m.Bc(7,N,2,0,"th",6),m.Bc(8,A,2,1,"td",7),m.Qb(),m.Rb(9,8),m.Bc(10,F,2,0,"th",6),m.Bc(11,_,2,1,"td",9),m.Qb(),m.Rb(12,10),m.Bc(13,K,2,0,"th",11),m.Bc(14,z,2,3,"td",12),m.Qb(),m.Rb(15,13),m.Bc(16,L,2,0,"th",6),m.Bc(17,Q,3,4,"td",7),m.Qb(),m.Rb(18,14),m.Bc(19,q,2,0,"th",6),m.Bc(20,U,3,4,"td",7),m.Qb(),m.Rb(21,15),m.Bc(22,Z,2,0,"th",6),m.Bc(23,G,3,4,"td",7),m.Qb(),m.Rb(24,16),m.Bc(25,V,2,0,"th",6),m.Bc(26,X,3,4,"td",7),m.Qb(),m.Rb(27,17),m.Bc(28,Y,2,0,"th",6),m.Bc(29,W,3,4,"td",7),m.Qb(),m.Rb(30,18),m.Bc(31,ee,2,0,"th",11),m.Bc(32,te,2,1,"td",7),m.Qb(),m.Rb(33,19),m.Bc(34,ne,2,0,"th",11),m.Bc(35,re,2,1,"td",7),m.Qb(),m.Rb(36,20),m.Bc(37,ie,2,0,"th",6),m.Bc(38,ae,3,4,"td",7),m.Qb(),m.Rb(39,21),m.Bc(40,oe,2,0,"th",6),m.Bc(41,ce,3,4,"td",7),m.Qb(),m.Rb(42,22),m.Bc(43,se,2,0,"th",11),m.Bc(44,ue,3,4,"td",7),m.Qb(),m.Rb(45,23),m.Bc(46,be,2,0,"th",6),m.Bc(47,le,3,4,"td",7),m.Qb(),m.Rb(48,24),m.Bc(49,de,2,0,"th",11),m.Bc(50,he,3,4,"td",7),m.Qb(),m.Bc(51,fe,1,0,"tr",25),m.Bc(52,pe,1,0,"tr",26),m.Sb(),m.Tb(53,"mat-paginator",2,27),m.Zb("page",(function(e){return t.loadPage(e)})),m.Sb(),m.Sb()),2&e&&(m.Bb(1),m.jc("ngIf",m.fc(2,14,t.fetcher.isBusy$)),m.Bb(2),m.jc("length",t.fetcher.dataLength)("disabled",t.disablePaginator)("pageSize",(null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageSize)||25)("pageIndex",null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageIndex)("pageSizeOptions",m.lc(16,ye)),m.Bb(2),m.jc("dataSource",t.fetcher.results$),m.Bb(46),m.jc("matHeaderRowDef",t.displayedColumns),m.Bb(1),m.jc("matRowDefColumns",t.displayedColumns),m.Bb(1),m.jc("length",t.fetcher.dataLength)("disabled",t.disablePaginator)("pageSize",(null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageSize)||25)("pageIndex",null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageIndex)("pageSizeOptions",m.lc(17,ye)))},directives:[h.m,I.a,J.n,M.a,J.c,J.i,J.b,J.k,J.m,$.a,J.h,M.b,J.a,J.j,J.l],pipes:[h.b,h.f],styles:[".full-width-table[_ngcontent-%COMP%] {\n      width: 100%;\n    }"]}),me),ge=c("BOp5"),Se=c("9+85"),Te=c("Wp6s"),De=c("f0Cb"),ke=c("Xa2L"),Be=c("3Pt+"),we=c("kmnG"),Pe=c("QibW");function je(e,t){if(1&e&&(m.Tb(0,"mat-radio-button",5),m.Dc(1),m.Sb()),2&e){var n=t.$implicit;m.jc("value",n),m.Bb(1),m.Ec(n)}}var Oe,Ie,Ce=((Oe=function(){function e(){r(this,e),this.values=[1e-4,.001,.005,.01,.05,.1],this.pvalue=.001,this.pvalue$=new m.o}return a(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.pvalue$.emit(this.pvalue)}},{key:"selected",value:function(e){this.pvalue$.emit(e.value)}}]),e}()).\u0275fac=function(e){return new(e||Oe)},Oe.\u0275cmp=m.Hb({type:Oe,selectors:[["bd2-pvalue-form"]],outputs:{pvalue$:"pvalue$"},decls:8,vars:2,consts:[[1,"form-inline"],[1,"mx-auto","text-center"],["id","pvalues-label",1,"mb-1"],["aria-label","Select p-value","aria-labelledby","pvalues-label",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(m.Tb(0,"form",0),m.Tb(1,"div",1),m.Tb(2,"mat-label",2),m.Tb(3,"strong"),m.Dc(4,"p-value threshold:"),m.Sb(),m.Sb(),m.Tb(5,"div"),m.Tb(6,"mat-radio-group",3),m.Zb("change",(function(e){return t.selected(e)})),m.Bc(7,je,2,2,"mat-radio-button",4),m.Sb(),m.Sb(),m.Sb(),m.Sb()),2&e&&(m.Bb(6),m.jc("value",t.pvalue),m.Bb(1),m.jc("ngForOf",t.values))},directives:[Be.D,Be.r,Be.s,we.g,Pe.b,h.l,Pe.a],styles:[".mat-radio-button[_ngcontent-%COMP%]  {\n      margin-right: 15px;\n    }"]}),Oe),xe=c("1jcm"),Ee=((Ie=function(){function e(){r(this,e),this.options=new m.o,this.currentOptions=new B.h(0,!1,!1,!1)}return a(e,[{key:"ngOnInit",value:function(){}},{key:"pValue",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.pValue=e,this.options.next(this.currentOptions)}},{key:"bhCorrection",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.bhCorrection=e,this.options.next(this.currentOptions)}},{key:"circadian",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.circadian=e,this.options.next(this.currentOptions)}},{key:"showPattern",value:function(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.showPattern=e,this.options.next(this.currentOptions)}}]),e}()).\u0275fac=function(e){return new(e||Ie)},Ie.\u0275cmp=m.Hb({type:Ie,selectors:[["bd2-stat-test-options-widget"]],outputs:{options:"options"},decls:14,vars:1,consts:[[3,"pvalue$"],[2,"margin-top","0.5em","text-align","center"],[3,"change"],["pattern",""],[3,"disabled","change"]],template:function(e,t){if(1&e&&(m.Tb(0,"mat-card"),m.Tb(1,"mat-card-content"),m.Tb(2,"section"),m.Tb(3,"bd2-pvalue-form",0),m.Zb("pvalue$",(function(e){return t.pValue(e)})),m.Sb(),m.Sb(),m.Tb(4,"section",1),m.Tb(5,"mat-slide-toggle",2),m.Zb("change",(function(e){return t.bhCorrection(e.checked)})),m.Dc(6,"Benjamini Hochberg correction"),m.Sb(),m.Sb(),m.Tb(7,"section",1),m.Tb(8,"mat-slide-toggle",2,3),m.Zb("change",(function(e){return t.showPattern(e.checked)})),m.Dc(10,"show pattern"),m.Sb(),m.Dc(11," \xa0 "),m.Tb(12,"mat-slide-toggle",4),m.Zb("change",(function(e){return t.circadian(e.checked)})),m.Dc(13,"circadian unit"),m.Sb(),m.Sb(),m.Sb(),m.Sb()),2&e){var n=m.qc(9);m.Bb(12),m.jc("disabled",!n.checked)}},directives:[Te.a,Te.c,Ce,xe.a],encapsulation:2}),Ie);function Re(e,t){if(1&e){var n=m.Ub();m.Tb(0,"div",5),m.Tb(1,"button",13),m.Zb("click",(function(){return m.sc(n),m.dc(2).delete()})),m.Tb(2,"i",4),m.Dc(3,"delete_forever"),m.Sb(),m.Sb(),m.Tb(4,"button",14),m.Zb("click",(function(){return m.sc(n),m.dc(2).export()})),m.Tb(5,"i",4),m.Dc(6,"save_alt"),m.Sb(),m.Sb(),m.Sb()}}function Je(e,t){if(1&e&&(m.Tb(0,"div",15),m.Ob(1,"br"),m.Dc(2),m.Sb()),2&e){var n=m.dc().ngIf;m.Bb(2),m.Fc("ERROR: ",n.jobStatus.message," ")}}function Me(e,t){1&e&&(m.Tb(0,"div"),m.Tb(1,"mat-card"),m.Tb(2,"mat-card-content"),m.Ob(3,"mat-spinner",16),m.Sb(),m.Sb(),m.Sb())}function $e(e,t){1&e&&(m.Tb(0,"div"),m.Tb(1,"mat-card"),m.Tb(2,"mat-card-content"),m.Tb(3,"div",17),m.Dc(4,"It may take up to 10 minutes to test for rhythmicity"),m.Sb(),m.Sb(),m.Sb(),m.Sb())}function He(e,t){if(1&e){var n=m.Ub();m.Rb(0),m.Tb(1,"bd2-stat-test-options-widget",18),m.Zb("options",(function(e){return m.sc(n),m.dc(3).statTestOptions(e)})),m.Sb(),m.Ob(2,"bd2-rhythmicity-results-mdtable",19),m.Qb()}if(2&e){var r=t.ngIf,i=m.dc(3);m.Bb(2),m.jc("statTestParams",i.statTestParams)("job",r)}}function Ne(e,t){if(1&e&&(m.Tb(0,"div"),m.Ob(1,"mat-divider"),m.Bc(2,Me,4,0,"div",12),m.ec(3,"async"),m.Bc(4,$e,5,0,"div",12),m.Bc(5,He,3,2,"ng-container",12),m.ec(6,"async"),m.Sb()),2&e){var n=m.dc().ngIf,r=m.dc();m.Bb(2),m.jc("ngIf",m.fc(3,3,r.rhythmicityJobDatasource.isReloading$)),m.Bb(2),m.jc("ngIf","SUBMITTED"===n.jobStatus.state),m.Bb(1),m.jc("ngIf",m.fc(6,5,r.rhythmicityJobDatasource.finishedJob$))}}function Ae(e,t){if(1&e){var n=m.Ub();m.Tb(0,"div",1),m.Tb(1,"div",2),m.Tb(2,"div",3),m.Zb("click",(function(){return m.sc(n),m.dc().toggleExpanded()})),m.Tb(3,"i",4),m.Dc(4,"waves"),m.Sb(),m.Dc(5),m.ec(6,"date"),m.Ob(7,"br"),m.Dc(8),m.Sb(),m.Tb(9,"div",5),m.Dc(10),m.Tb(11,"a",6),m.Zb("click",(function(){return m.sc(n),m.dc().refresh()})),m.Tb(12,"i",7),m.Dc(13,"refresh"),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Tb(14,"div",8),m.Tb(15,"mat-card"),m.Tb(16,"mat-card-content"),m.Tb(17,"div",9),m.Bc(18,Re,7,0,"div",10),m.Dc(19),m.Bc(20,Je,3,1,"div",11),m.Sb(),m.Sb(),m.Sb(),m.Bc(21,Ne,7,7,"div",12),m.Sb(),m.Sb()}if(2&e){var r=t.ngIf,i=m.dc();m.Bb(3),m.yc("color",i.isExpanded?"green":"red")("font-size",150,"%"),m.Bb(2),m.Gc(" \xa0",i.shortUUID(r.jobId)," (",m.fc(6,13,i.toLocalDateTime(r.jobStatus.submitted)),") "),m.Bb(3),m.Gc(" ",i.friendlyMethod(r.parameters.METHOD),"; \xa0 waveforms: ",r.parameters.PRESET," "),m.Bb(2),m.Fc(" ",r.jobStatus.state," "),m.Bb(8),m.jc("ngIf",i.assay.security.canWrite),m.Bb(1),m.Fc(" ",r.parameters.PARAMS_SUMMARY," "),m.Bb(1),m.jc("ngIf",r.jobStatus.message&&"OK"!=r.jobStatus.message),m.Bb(1),m.jc("ngIf",i.isExpanded)}}var Fe,_e=((Fe=function(){function e(t,n,i,a){r(this,e),this.rhythmicityService=t,this.rhythmicityJobDatasource=n,this.feedback=i,this.dialogs=a,this.deleted=new m.o,this.isExpanded=!1,this.expandedToogleStream=new S.a(!1)}return a(e,[{key:"ngOnInit",value:function(){this.initSubscriptions()}},{key:"ngOnDestroy",value:function(){this.rhythmicityJobDatasource.close(),this.expandedToogleStream&&this.expandedToogleStream.complete()}},{key:"ngOnChanges",value:function(e){(e.jobId||e.assay)&&this.jobId&&this.assay&&this.rhythmicityJobDatasource.assayJob([this.assay.id,this.jobId])}},{key:"statTestOptions",value:function(e){var t=this,n=Object(T.a)(1).subscribe((function(){t.statTestParams=e,n&&n.unsubscribe()}))}},{key:"export",value:function(){var e=this;this.rhythmicityService.downloadJob(this.assay.id,this.jobId).subscribe((function(t){e.saveJobBlob(t,e.assay.id,e.jobId)}),(function(t){return e.feedback.error(t)}))}},{key:"saveJobBlob",value:function(e,t,n){k.saveAs(e,t+"_job"+this.shortUUID(n)+".rhythmicity.csv")}},{key:"refresh",value:function(){this.rhythmicityJobDatasource.refresh(),this.resultsTable&&this.resultsTable.reload()}},{key:"delete",value:function(){var e=this,t=this.assay,n=this.rhythmicityJobDatasource.currentJob;this.dialogs.confirm("Do you want to delete analysis: "+n.jobId,n.parameters.PARAMS_SUMMARY).subscribe((function(r){r&&e.doDelete(t,n.jobId)}))}},{key:"initSubscriptions",value:function(){var e=this;this.rhythmicityJobDatasource.on(!0),this.rhythmicityJobDatasource.error$.forEach((function(t){return e.feedback.error(t)}))}},{key:"doDelete",value:function(e,t){var n=this;this.rhythmicityService.deleteJob(e,t).subscribe((function(e){n.deleted.next(e),n.feedback.success("Job: "+n.shortUUID(t)+" deleted")}),(function(e){n.feedback.error(e)}))}},{key:"toggleExpanded",value:function(){this.expanded=!this.isExpanded}},{key:"toLocalDateTime",value:function(e){return D.b.deserialize(e).date}},{key:"shortUUID",value:function(e){return Object(ge.c)(e)}},{key:"friendlyMethod",value:function(e){return"BD2JTK"===e?"Classic JTK":"BD2EJTK"===e?"BD2 eJTK":e}},{key:"expanded",set:function(e){this.isExpanded=e,this.expandedToogleStream.next(e)}}]),e}()).\u0275fac=function(e){return new(e||Fe)(m.Nb(y.a),m.Nb(O),m.Nb(R.a),m.Nb(Se.a))},Fe.\u0275cmp=m.Hb({type:Fe,selectors:[["bd2-rhythmicity-job-pane"]],viewQuery:function(e,t){var n;1&e&&m.Ic(ve,!0),2&e&&m.pc(n=m.ac())&&(t.resultsTable=n.first)},inputs:{jobId:"jobId",assay:"assay",expanded:"expanded"},outputs:{deleted:"deleted"},features:[m.Ab([O]),m.zb],decls:2,vars:3,consts:[["class","card mb-2",4,"ngIf"],[1,"card","mb-2"],[1,"card-header","clearfix"],["role","button",1,"float-left",3,"click"],[1,"material-icons","bd-icon"],[1,"float-right"],["role","button","aria-label","refresh",3,"click"],[1,"material-icons","bd-icon","bd-primary"],[1,"card-body"],[1,"clearfix"],["class","float-right",4,"ngIf"],["class","text-danger","style","word-wrap: break-word;",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"text-danger",2,"word-wrap","break-word"],[1,"center-block"],[2,"margin-top","0.5em","text-align","center"],[3,"options"],[3,"statTestParams","job"]],template:function(e,t){1&e&&(m.Bc(0,Ae,22,15,"div",0),m.ec(1,"async")),2&e&&m.jc("ngIf",m.fc(1,1,t.rhythmicityJobDatasource.allJob$))},directives:[h.m,Te.a,Te.c,De.a,ke.b,Ee,ve],pipes:[h.b,h.e],encapsulation:2}),Fe);function Ke(e,t){if(1&e&&(m.Tb(0,"div"),m.Tb(1,"strong"),m.Dc(2),m.Sb(),m.Sb()),2&e){var n=m.dc(2);m.Bb(2),m.Fc("Submitted jobs: ",n.jobs.length,"")}}function ze(e,t){1&e&&(m.Tb(0,"div"),m.Dc(1," No jobs submitted, start a new test. "),m.Sb())}var Le=function(){return["new"]};function Qe(e,t){1&e&&(m.Tb(0,"a",7),m.Dc(1," New test "),m.Sb()),2&e&&m.jc("routerLink",m.lc(1,Le))}function qe(e,t){if(1&e){var n=m.Ub();m.Tb(0,"div"),m.Tb(1,"bd2-rhythmicity-job-pane",8),m.Zb("deleted",(function(e){return m.sc(n),m.dc(2).remove(e)}))("finished",(function(e){return m.sc(n),m.dc(2).refreshJob(e)})),m.Sb(),m.Sb()}if(2&e){var r=t.$implicit,i=t.index,a=m.dc(2);m.Bb(1),m.jc("assay",a.assay)("jobId",r)("expanded",a.expandAll||0==i)}}function Ue(e,t){if(1&e){var n=m.Ub();m.Tb(0,"div"),m.Tb(1,"h3"),m.Dc(2,"Rhythmicity tests"),m.Sb(),m.Ob(3,"hr"),m.Tb(4,"div",1),m.Tb(5,"div",2),m.Bc(6,Ke,3,1,"div",0),m.Bc(7,ze,2,0,"div",0),m.Sb(),m.Tb(8,"div",3),m.Bc(9,Qe,2,2,"a",4),m.Tb(10,"button",5),m.Zb("click",(function(){return m.sc(n),m.dc().refresh()})),m.Dc(11,"Refresh "),m.Sb(),m.Sb(),m.Sb(),m.Ob(12,"hr"),m.Bc(13,qe,2,3,"div",6),m.Ob(14,"hr"),m.Sb()}if(2&e){var r=m.dc();m.Bb(6),m.jc("ngIf",r.jobs&&r.jobs.length>0),m.Bb(1),m.jc("ngIf",!r.jobs||0==r.jobs.length),m.Bb(2),m.jc("ngIf",r.assay.security.canWrite),m.Bb(1),m.jc("disabled",r.blocked),m.Bb(3),m.jc("ngForOf",r.jobsIds)}}var Ze,Ge=((Ze=function(t){o(i,t);var n=s(i);function i(e,t){var a;return r(this,i),(a=n.call(this,e,t)).expandAll=!1,a.blocked=!1,a.titlePart=" Rhythm",a}return a(i,[{key:"updateModel",value:function(t){e(b(i.prototype),"updateModel",this).call(this,t),t&&this.loadJobs(t)}},{key:"loadJobs",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.blocked=!0,this.rhythmicityService.getJobs(e).subscribe((function(r){t.jobs=r,t.refreshJobsInfo(r),t.exportURL=t.rhythmicityService.exportURL(e),n&&t.refreshPanes(),t.blocked=!1}),(function(e){t.blocked=!1,t.feedback.error(e)}))}},{key:"refreshJobsInfo",value:function(e){this.jobsIds=e.map((function(e){return e.jobId}))}},{key:"refresh",value:function(){this.loadJobs(this.assay,!0)}},{key:"refreshPanes",value:function(){this.panes&&this.panes.forEach((function(e){return e.refresh()}))}},{key:"remove",value:function(e){var t=this.jobs.findIndex((function(t){return e.jobId===t.jobId}));t>=0&&(this.jobs.splice(t,1),this.refreshJobsInfo(this.jobs))}},{key:"refreshJob",value:function(e){var t=this.jobs.findIndex((function(t){return e.jobId===t.jobId}));t>=0&&(this.jobs[t]=e,this.refreshJobsInfo(this.jobs))}},{key:"calculateQueuing",value:function(e){var t=this;return e.filter((function(e){return t.isQueueing(e.jobStatus.state)})).length}},{key:"isQueueing",value:function(e){switch(e){case"WAITING":case"PROCESSING":case"SUBMITTED":return!0;default:return!1}}},{key:"checkFinished",value:function(e){var t=this;return!!e.find((function(e){return t.isFinished(e.jobStatus.state)}))}},{key:"isFinished",value:function(e){switch(e){case"SUCCESS":case"FINISHED":case"COMPLETED":return!0;default:return!1}}}]),i}(g)).\u0275fac=function(e){return new(e||Ze)(m.Nb(y.a),m.Nb(v.a))},Ze.\u0275cmp=m.Hb({type:Ze,selectors:[["ng-component"]],viewQuery:function(e,t){var n;1&e&&m.Ic(_e,!0),2&e&&m.pc(n=m.ac())&&(t.panes=n)},features:[m.yb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-body"],["class","btn btn-primary mr-1",3,"routerLink",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary",3,"disabled","click"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary","mr-1",3,"routerLink"],[3,"assay","jobId","expanded","deleted","finished"]],template:function(e,t){1&e&&m.Bc(0,Ue,15,5,"div",0),2&e&&m.jc("ngIf",t.assay)},directives:[h.m,h.l,f.e,_e],encapsulation:2}),Ze),Ve=c("QBpm"),Xe=c("Kj3r"),Ye=c("bngM"),We=c("ZMwR"),et=c("naqj"),tt=c("Tl2h"),nt=c("wcxA");function rt(e,t){if(1&e&&(m.Tb(0,"option",29),m.Dc(1),m.Sb()),2&e){var n=t.$implicit;m.jc("value",n.name),m.Bb(1),m.Ec(n.label)}}function it(e,t){1&e&&(m.Tb(0,"div",30),m.Tb(1,"div",31),m.Dc(2," Rhythmicity tests are generally used for short, sparse timeseries. "),m.Ob(3,"br"),m.Dc(4," The current limit is 5 or 4 days of hourly sampled data for eJTK preset and BD2 preset respectivelly."),m.Ob(5,"br"),m.Dc(6," Generally the raw data are being analysed, but we also enabled a linear detrended option. "),m.Sb(),m.Sb())}function at(e,t){if(1&e&&(m.Tb(0,"option",29),m.Dc(1),m.Sb()),2&e){var n=t.$implicit;m.jc("value",n.name),m.Bb(1),m.Ec(n.label)}}function ot(e,t){1&e&&(m.Tb(0,"div",30),m.Tb(1,"div",31),m.Tb(2,"p"),m.Tb(3,"b"),m.Dc(4,"Classic JTK"),m.Sb(),m.Dc(5," is the implementation of JTK_CYCLE from "),m.Tb(6,"a",32),m.Dc(7,"Michael E. Hughes et al. 2010"),m.Sb(),m.Dc(8," a standard method for detecting rhythmicity in genome-scale datasets. "),m.Ob(9,"br"),m.Dc(10,"The method is fast but it is reliable only when it tests against small set of patterns, we provide patterns of 24h cosines with different phases."),m.Sb(),m.Tb(11,"p"),m.Tb(12,"b"),m.Dc(13,"BD2 eJTK"),m.Sb(),m.Dc(14," is the BioDare2 implementation of Empirical JTK_CYCLE with asymmetry search from "),m.Tb(15,"a",33),m.Dc(16,"Alan L. Hutchison et al. 2015"),m.Sb(),m.Dc(17,". It is similar to the classic JTK method but with p values empirically calculated against set of random noise data. "),m.Ob(18,"br"),m.Dc(19,"This modification permits using larger sets of test patterns and it provides better accuracy. However, this method is much slower so it can only analyze timeseries only up to 5 days of data (though the Classic JTK method was never intended to be used with such a long data)."),m.Sb(),m.Sb(),m.Sb())}function ct(e,t){if(1&e&&(m.Tb(0,"option",29),m.Dc(1),m.Sb()),2&e){var n=t.$implicit;m.jc("value",n.name),m.Bb(1),m.Ec(n.label)}}function st(e,t){1&e&&(m.Tb(0,"div",30),m.Tb(1,"div",31),m.Dc(2," Presets determine set of pattern curves against the comparison test is run."),m.Ob(3,"br"),m.Tb(4,"ul"),m.Tb(5,"li"),m.Dc(6,"Cosine 24h 1/2/4h are set of cosine curves of 24h periods, and phases spread every 1, 2, or 4 hours. To be used mainly with Classic JTK."),m.Sb(),m.Tb(7,"li"),m.Dc(8,"eJTK Classic is recommended for typical omics-like data for which eJTK method was developed. "),m.Ob(9,"br"),m.Dc(10," It works well for short data (48h, 2h- 1h-sampled) when actual period is within range 22-26 hours."),m.Ob(11,"br"),m.Dc(12," The patterns are series of cosine-like waveforms with 24h period, phases by 2hours and range of asymmetries by 2h (see original paper)."),m.Ob(13,"br"),m.Sb(),m.Tb(14,"li"),m.Dc(15,"BD2 Classic can detect non 24 periods and some forms of the spikes."),m.Ob(16,"br"),m.Dc(17," As it compares against much more patterns it has a weaker power."),m.Ob(18,"br"),m.Dc(19," It should be used when there is a good reason to suspect periods outside 22-26h range."),m.Ob(20,"br"),m.Dc(21," The patterns are series of cosine-like waverforms with periods from 18-35hours, for each period there are multiple "),m.Tb(22,"b"),m.Dc(23,"circadian"),m.Sb(),m.Dc(24," phases with step 2h (so each period value generates the same number of patterns but the peaks in absolute units do not coincide) and a range of assymetries by 2h in circadian units (see original paper). The preset contains also additional some spike patterns. "),m.Sb(),m.Sb(),m.Sb(),m.Sb())}var ut,bt=function(){return[10,25,50,100,200]},lt=((ut=function(t){o(i,t);var n=s(i);function i(e){var t;return r(this,i),(t=n.call(this,e)).methodOptions=B.d,t.presetOptions=B.b,t.dataHelp=!1,t.presetsHelp=!1,t.methodHelp=!1,t.rhythmicityRequests=new m.o,t.detrendingOptions=[tt.b.NO_DTR,tt.b.LIN_DTR],t.methodForm=t.mainForm.get("method"),t.presetForm=t.mainForm.get("preset"),t}return a(i,[{key:"buildMainForm",value:function(){var e=this;return this.fb.group({displayParams:this.displayParamsForm,periodScale:this.fb.group({periodMin:[18,[Be.B.required]],periodMax:[34,[Be.B.required]]},{validator:function(t){return e.validPeriodScale(t.value)}}),method:[B.f.BD2EJTK.name,[Be.B.required]],preset:[B.a.EJTK_CLASSIC.name,[Be.B.required]]})}},{key:"ngOnInit",value:function(){var t=this;e(b(i.prototype),"ngOnInit",this).call(this),this.methodForm.valueChanges.subscribe((function(e){return t.setPresetOptions(e)}))}},{key:"ngOnDestroy",value:function(){e(b(i.prototype),"ngOnDestroy",this).call(this)}},{key:"setPresetOptions",value:function(e){e===B.f.BD2EJTK.name?(this.presetOptions=B.b,this.presetForm.setValue(B.a.EJTK_CLASSIC.name)):e===B.f.BD2JTK.name?(this.presetOptions=B.c,this.presetForm.setValue(B.a.COS_2H.name)):this.presetOptions=[]}},{key:"defaultDetrending",value:function(){return tt.b.NO_DTR.name}},{key:"validPeriodScale",value:function(e){var t=e.periodMin,n=e.periodMax;return t<10?{validPeriodScale:"Period min must >= 10"}:n<10?{validPeriodScale:"Period max must >= 10"}:n>50?{validPeriodScale:"Period max must < 50"}:t>=n?{validPeriodScale:"Period min must be < max"}:null}},{key:"analyse",value:function(){if(!this.mainForm.invalid){var e=this.map2RhythmicityRequest(this.mainForm.value);e.isValid()&&this.rhythmicityRequests.next(e)}}},{key:"map2RhythmicityRequest",value:function(e){var t=new B.g;return t.detrending=tt.b.get(e.displayParams.detrending),t.method=B.f.get(e.method),t.preset=B.a.get(e.preset),t.periodMax=e.periodScale.periodMax,t.periodMin=e.periodScale.periodMin,t.windowEnd=e.displayParams.timeScale.timeEnd,t.windowStart=e.displayParams.timeScale.timeStart,t}}]),i}(nt.a)).\u0275fac=function(e){return new(e||ut)(m.Nb(Be.e))},ut.\u0275cmp=m.Hb({type:ut,selectors:[["bd2-rhythmicityjob-params-rform"]],inputs:{disabled:"disabled",totalTraces:"totalTraces",currentPage:"currentPage"},outputs:{displayParams:"displayParams",rhythmicityRequests:"rhythmicityRequests"},features:[m.yb],decls:61,vars:15,consts:[["role","form",1,"form-horizontal",3,"formGroup"],["formGroupName","displayParams"],["formGroupName","timeScale",1,"form-group","row"],[1,"col-sm-4"],["for","windowStart",1,"col-sm-1"],[1,"col-sm-2"],["formControlName","timeStart","id","windowStart","min","0","required","","size","5","step","any","type","number",1,"form-control"],["for","windowEnd",1,"col-sm-1"],["formControlName","timeEnd","id","windowEnd","min","0","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],[1,"form-group","row"],["for","detrending",1,"col-sm-4"],[3,"click"],[1,"material-icons","bd-icon","bd-primary"],[1,"col-sm-6"],["formControlName","detrending","id","detrending","required","",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["class","col-sm-12",4,"ngIf"],["for","method",1,"col-sm-4"],["formControlName","method","id","method","required","",1,"form-control"],["formControlName","preset","id","preset","required","",1,"form-control"],["formGroupName","periodScale",1,"form-group","row",3,"hidden"],["for","periodMin",1,"col-sm-1"],["formControlName","periodMin","id","periodMin","max","50","min","10","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],["for","periodMax",1,"col-sm-1"],["formControlName","periodMax","id","periodMax","max","50","min","10","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],[1,"col-sm-8"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["dataPaginator",""],["type","button",1,"btn","btn-primary",3,"disabled","click"],[3,"value"],[1,"col-sm-12"],["role","alert","type","info",1,"alert","alert-info"],["href","https://dx.doi.org/10.1177%2F0748730410379711"],["href"," https://doi.org/10.1371/journal.pcbi.1004094","target","_blank"]],template:function(e,t){1&e&&(m.Tb(0,"form",0),m.Tb(1,"div",1),m.Tb(2,"div",2),m.Tb(3,"label",3),m.Dc(4,"Data window"),m.Sb(),m.Tb(5,"label",4),m.Dc(6,"from:"),m.Sb(),m.Tb(7,"div",5),m.Ob(8,"input",6),m.Sb(),m.Tb(9,"label",7),m.Dc(10,"to:"),m.Sb(),m.Tb(11,"div",5),m.Ob(12,"input",8),m.Sb(),m.Sb(),m.Tb(13,"div",9),m.Tb(14,"label",10),m.Dc(15,"Input Data "),m.Tb(16,"a",11),m.Zb("click",(function(){return t.dataHelp=!t.dataHelp})),m.Tb(17,"i",12),m.Dc(18,"help"),m.Sb(),m.Sb(),m.Sb(),m.Tb(19,"div",13),m.Tb(20,"select",14),m.Bc(21,rt,2,2,"option",15),m.Sb(),m.Sb(),m.Sb(),m.Sb(),m.Bc(22,it,7,0,"div",16),m.Tb(23,"div",9),m.Tb(24,"label",17),m.Dc(25,"Test Method "),m.Tb(26,"a",11),m.Zb("click",(function(){return t.methodHelp=!t.methodHelp})),m.Tb(27,"i",12),m.Dc(28,"help"),m.Sb(),m.Sb(),m.Sb(),m.Tb(29,"div",13),m.Tb(30,"select",18),m.Bc(31,at,2,2,"option",15),m.Sb(),m.Sb(),m.Sb(),m.Bc(32,ot,20,0,"div",16),m.Tb(33,"div",9),m.Tb(34,"label",17),m.Dc(35,"Analysis Presets "),m.Tb(36,"a",11),m.Zb("click",(function(){return t.presetsHelp=!t.presetsHelp})),m.Tb(37,"i",12),m.Dc(38,"help"),m.Sb(),m.Sb(),m.Sb(),m.Tb(39,"div",13),m.Tb(40,"select",19),m.Bc(41,ct,2,2,"option",15),m.Sb(),m.Sb(),m.Sb(),m.Bc(42,st,25,0,"div",16),m.Tb(43,"div",20),m.Tb(44,"label",3),m.Dc(45,"Expected periods"),m.Sb(),m.Tb(46,"label",21),m.Dc(47,"from:"),m.Sb(),m.Tb(48,"div",5),m.Ob(49,"input",22),m.Sb(),m.Tb(50,"label",23),m.Dc(51,"to:"),m.Sb(),m.Tb(52,"div",5),m.Ob(53,"input",24),m.Sb(),m.Sb(),m.Tb(54,"div",9),m.Ob(55,"label",5),m.Tb(56,"div",25),m.Tb(57,"mat-paginator",26,27),m.Zb("page",(function(e){return t.loadDataPage(e)})),m.Sb(),m.Sb(),m.Sb(),m.Tb(59,"button",28),m.Zb("click",(function(){return t.analyse()})),m.Dc(60,"Test Rhythmicity "),m.Sb(),m.Sb()),2&e&&(m.jc("formGroup",t.mainForm),m.Bb(21),m.jc("ngForOf",t.detrendingOptions),m.Bb(1),m.jc("ngIf",t.dataHelp),m.Bb(9),m.jc("ngForOf",t.methodOptions),m.Bb(1),m.jc("ngIf",t.methodHelp),m.Bb(9),m.jc("ngForOf",t.presetOptions),m.Bb(1),m.jc("ngIf",t.presetsHelp),m.Bb(1),m.jc("hidden",!0),m.Bb(14),m.jc("length",t.totalTraces)("disabled",t.disabledPagination)("pageSize",t.currentPage.pageSize)("pageIndex",t.currentPage.pageIndex)("pageSizeOptions",m.lc(14,bt)),m.Bb(2),m.jc("disabled",t.disabled||t.mainForm.invalid))},directives:[Be.D,Be.r,Be.i,Be.j,Be.d,Be.v,Be.q,Be.h,Be.z,Be.A,h.l,h.m,I.a,Be.u,Be.C],encapsulation:2}),ut),dt=c("nA4b");function ht(e,t){if(1&e&&m.Ob(0,"bd2-ts-plots",3),2&e){var n=m.dc(3);m.jc("data",n.timeseries)("tracesPerPlot",n.tracesPerPlot)}}function ft(e,t){if(1&e){var n=m.Ub();m.Tb(0,"div"),m.Tb(1,"bd2-rhythmicityjob-params-rform",1),m.Zb("displayParams",(function(e){return m.sc(n),m.dc(2).emitDisplayParams(e)}))("rhythmicityRequests",(function(e){return m.sc(n),m.dc(2).doAnalysis(e)})),m.Sb(),m.Ob(2,"hr"),m.Bc(3,ht,1,2,"bd2-ts-plots",2),m.Sb()}if(2&e){var r=m.dc(2);m.Bb(1),m.jc("disabled",r.blocked)("totalTraces",r.totalTraces)("currentPage",r.currentPage),m.Bb(2),m.jc("ngIf",r.timeseries)}}function pt(e,t){if(1&e&&(m.Tb(0,"div"),m.Tb(1,"h3"),m.Dc(2,"Start rhythmicity test"),m.Sb(),m.Ob(3,"hr"),m.Bc(4,ft,4,4,"div",0),m.Sb()),2&e){var n=m.dc();m.Bb(4),m.jc("ngIf",!n.disabled)}}var mt,yt,vt,gt=[{path:"",children:[{path:"new",component:(mt=function(t){o(i,t);var n=s(i);function i(e,t,a,o,c){var s;return r(this,i),(s=n.call(this,o,c)).fetcher=e,s.analytics=t,s.userService=a,s.disabled=!1,s.blocked=!1,s.tracesPerPlot=5,s.totalTraces=0,s.currentPage=Ye.a.firstPage(),s.titlePart=" New Test",s}return a(i,[{key:"ngOnInit",value:function(){var t=this;e(b(i.prototype),"ngOnInit",this).call(this),this.timeSeriesSubsripction=this.fetcher.seriesPackStream.pipe(Object(Xe.a)(1e3)).subscribe((function(e){var n=e.data;t.tracesPerPlot=Math.max(5,n.length/20),t.timeseries=n,t.totalTraces=e.totalTraces,t.currentPage=e.currentPage}),(function(e){console.log("Error in TS subscription: "+e),t.feedback.error(e)}))}},{key:"ngOnDestroy",value:function(){this.timeSeriesSubsripction&&this.timeSeriesSubsripction.unsubscribe(),this.fetcher.ngOnDestroy(),e(b(i.prototype),"ngOnDestroy",this).call(this)}},{key:"emitDisplayParams",value:function(e){this.fetcher.changeDisplayParams(e)}},{key:"doAnalysis",value:function(e){var t=this;e.isValid()&&(this.blocked=!0,this.rhythmicityService.newTest(this.assay,e).subscribe((function(n){t.feedback.success("Rhythmicity test submitted"),t.analytics.rhythmicityNew(e.method.name,t.assay.id,t.userService.currentUser.login),t.refreshModel(),t.goToRhythmicityHome()}),(function(e){t.blocked=!1,t.feedback.error(e)})))}},{key:"updateModel",value:function(t){this.fetcher.experiment(t),e(b(i.prototype),"updateModel",this).call(this,t)}}]),i}(g),mt.\u0275fac=function(e){return new(e||mt)(m.Nb(Ve.a),m.Nb(We.a),m.Nb(et.a),m.Nb(y.a),m.Nb(v.a))},mt.\u0275cmp=m.Hb({type:mt,selectors:[["ng-component"]],features:[m.Ab([Ve.a]),m.yb],decls:1,vars:1,consts:[[4,"ngIf"],[3,"disabled","totalTraces","currentPage","displayParams","rhythmicityRequests"],[3,"data","tracesPerPlot",4,"ngIf"],[3,"data","tracesPerPlot"]],template:function(e,t){1&e&&m.Bc(0,pt,5,1,"div",0),2&e&&m.jc("ngIf",t.assay)},directives:[h.m,lt,dt.a],encapsulation:2}),mt)},{path:"",component:Ge,pathMatch:"full"}]}],St=((yt=function e(){r(this,e)}).\u0275mod=m.Lb({type:yt}),yt.\u0275inj=m.Kb({factory:function(e){return new(e||yt)},imports:[[f.f.forChild(gt)],f.f]}),yt),Tt=c("wMBR"),Dt=c("a6j2"),kt=c("ZTEM"),Bt=((vt=function e(){r(this,e)}).\u0275mod=m.Lb({type:vt}),vt.\u0275inj=m.Kb({factory:function(e){return new(e||vt)},imports:[[h.c,Be.k,Be.y,Tt.a,Dt.a,kt.a,St]]}),vt)}}])}();