"use strict";(self.webpackChunkbiodare2_ui=self.webpackChunkbiodare2_ui||[]).push([[175],{6175:(xe,w,o)=>{o.r(w),o.d(w,{AccountModule:()=>be});var l=o(6814),m=o(1896),v=o(553),e=o(5879),p=o(4294),a=o(6223),T=o(5619);let y=(()=>{class r{constructor(t){this.scriptLoaded=!1,this.readySubject=new T.X(!1),window.reCaptchaOnloadCallback=()=>t.run(this.onloadCallback.bind(this))}getReady(t){if(!this.scriptLoaded){this.scriptLoaded=!0;const s=document.body,n=document.createElement("script");n.innerHTML="",n.src="https://www.google.com/recaptcha/api.js?onload=reCaptchaOnloadCallback&render=explicit"+(t?"&hl="+t:""),n.async=!0,n.defer=!0,s.appendChild(n)}return this.readySubject.asObservable()}onloadCallback(){this.readySubject.next(!0)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(e.R0b))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const N=["target"];let Z=(()=>{class r{constructor(t,s){this._zone=t,this._captchaService=s,this.site_key=null,this.theme="light",this.type="image",this.size="normal",this.tabindex=0,this.language=null,this.captchaResponse=new e.vpe,this.captchaExpired=new e.vpe,this.widgetId=null}ngOnInit(){this._captchaService.getReady(this.language).subscribe(t=>{t&&(this.widgetId=window.grecaptcha.render(this.targetRef.nativeElement,{sitekey:this.site_key,theme:this.theme,type:this.type,size:this.size,tabindex:this.tabindex,callback:s=>this._zone.run(this.recaptchaCallback.bind(this,s)),"expired-callback":()=>this._zone.run(this.recaptchaExpiredCallback.bind(this))}))})}reset(){null!==this.widgetId&&window.grecaptcha.reset(this.widgetId)}getResponse(){return this.widgetId?window.grecaptcha.getResponse(this.targetRef.nativeElement):null}recaptchaCallback(t){this.captchaResponse.emit(t)}recaptchaExpiredCallback(){this.captchaExpired.emit()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(e.R0b),e.Y36(y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["bd2-recaptcha"]],viewQuery:function(t,s){if(1&t&&e.Gf(N,7),2&t){let n;e.iGM(n=e.CRH())&&(s.targetRef=n.first)}},inputs:{site_key:"site_key",theme:"theme",type:"type",size:"size",tabindex:"tabindex",language:"language"},outputs:{captchaResponse:"captchaResponse",captchaExpired:"captchaExpired"},decls:2,vars:0,consts:[["target",""]],template:function(t,s){1&t&&e._UZ(0,"div",null,0)},encapsulation:2}),r})();const U=["recaptcha"];function I(r,i){if(1&r&&(e.TgZ(0,"div",3),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.msg," ")}}function k(r,i){if(1&r&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.errMsg," ")}}function P(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"form",null,5)(2,"div",6)(3,"label",7),e._uU(4,"Login or email"),e.qZA(),e.TgZ(5,"input",8),e.NdJ("ngModelChange",function(n){e.CHM(t);const c=e.oxw();return e.KtG(c.identifier=n)}),e.qZA()(),e.TgZ(6,"div",6)(7,"bd2-recaptcha",9,10),e.NdJ("captchaResponse",function(n){e.CHM(t);const c=e.oxw();return e.KtG(c.captcha(n))})("captchaExpired",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.captchaExpired())}),e.qZA(),e.TgZ(9,"div",11),e._uU(10," Captcha selection is needed "),e.qZA()(),e.TgZ(11,"button",12),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.request())}),e._uU(12,"Send "),e.qZA()()}if(2&r){const t=e.MAs(1),s=e.oxw();e.xp6(5),e.Q6J("ngModel",s.identifier),e.xp6(2),e.Q6J("site_key",s.captchaSiteKey),e.xp6(2),e.Q6J("hidden",!s.missingCaptcha),e.xp6(2),e.Q6J("disabled",!t.valid)}}let J=(()=>{class r{constructor(t){this.userService=t,this.requested=!1,this.captchaSiteKey=v.N.captchaSiteKey}ngOnInit(){}captcha(t){this.gRecaptchaResponse=t,t&&(this.missingCaptcha=!1)}captchaExpired(){this.gRecaptchaResponse=null}request(){!this.identifier||""===this.identifier.trim()||(this.msg=void 0,this.errMsg=void 0,this.userService.requestReset(this.identifier,this.gRecaptchaResponse).then(t=>{this.msg="Reset link was sent to "+t,this.requested=!0}).catch(t=>{this.errMsg=t.message?t.message:t,this.gRecaptchaResponse=null,this.recaptcha&&this.recaptcha.reset()}))}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.K))},r.\u0275cmp=e.Xpm({type:r,selectors:[["bd2-reset-request"]],viewQuery:function(t,s){if(1&t&&e.Gf(U,5),2&t){let n;e.iGM(n=e.CRH())&&(s.recaptcha=n.first)}},decls:6,vars:3,consts:[["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-success"],[1,"alert","alert-danger"],["reminderForm","ngForm"],[1,"form-group"],["for","identifier"],["type","text","required","","id","identifier","name","identifier",1,"form-control",3,"ngModel","ngModelChange"],[3,"site_key","captchaResponse","captchaExpired"],["recaptcha",""],[1,"alert","alert-danger",3,"hidden"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,s){1&t&&(e.TgZ(0,"div")(1,"h3"),e._uU(2,"Forgotten password"),e.qZA(),e.YNc(3,I,2,1,"div",0),e.YNc(4,k,2,1,"div",1),e.YNc(5,P,13,4,"form",2),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",s.msg),e.xp6(1),e.Q6J("ngIf",s.errMsg),e.xp6(1),e.Q6J("ngIf",!s.requested))},dependencies:[l.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.On,a.F,Z],encapsulation:2}),r})();const M=/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/,K=/^[a-z]+$/,O=/^[A-Z]+$/,L=/^[0-9]+$/;function C(r){return!!(!r||r.length<8||K.test(r)||O.test(r)||L.test(r))}function b(r){return C(r)?{"password-weak":!0}:null}function x(r){return r.password===r.password2?null:{"password-mismatch":!0}}function R(r){return function Q(r){return r=r?r.toLocaleLowerCase():"",!!M.test(r)}(r)?null:{pattern:"Not valid email format"}}function j(r,i){if(1&r&&(e.TgZ(0,"div",3),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.msg," ")}}function H(r,i){if(1&r&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.errMsg," ")}}function X(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"form",null,5)(2,"div",6)(3,"label",7),e._uU(4,"Password"),e.qZA(),e.TgZ(5,"input",8,9),e.NdJ("ngModelChange",function(n){e.CHM(t);const c=e.oxw(2);return e.KtG(c.password=n)}),e.qZA(),e.TgZ(7,"div",10),e._uU(8," Password must be at least 8 long, containing a digit or symbol or capital letter "),e.qZA()(),e.TgZ(9,"div",6)(10,"label",11),e._uU(11,"Repeat password"),e.qZA(),e.TgZ(12,"input",12,13),e.NdJ("ngModelChange",function(n){e.CHM(t);const c=e.oxw(2);return e.KtG(c.password2=n)}),e.qZA(),e.TgZ(14,"div",10),e._uU(15," Passwords do not match "),e.qZA()(),e.TgZ(16,"button",14),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.reset())}),e._uU(17,"Reset "),e.qZA()()}if(2&r){const t=e.MAs(1),s=e.MAs(6),n=e.MAs(13),c=e.oxw(2);e.xp6(5),e.Q6J("ngModel",c.password),e.xp6(2),e.Q6J("hidden",s.pristine||!c.weakPassword()),e.xp6(5),e.Q6J("ngModel",c.password2),e.xp6(2),e.Q6J("hidden",n.pristine||c.matching()),e.xp6(2),e.Q6J("disabled",!t.form.valid||c.passwordProblem())}}function $(r,i){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,X,18,5,"form",2),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.requested)}}let D=(()=>{class r{constructor(t,s){this.userService=t,this.route=s,this.requested=!1}ngOnInit(){this.token=this.route.snapshot.queryParamMap.get("token"),this.token||(this.errMsg="Missing reset token")}reset(){this.token&&this.userService.resetPassword(this.password,this.token).then(t=>{this.msg="You can sign in with new password and login "+t,this.requested=!0}).catch(t=>{this.errMsg=t.message?t.message:t})}weakPassword(){return C(this.password)}matching(){return this.password===this.password2}passwordProblem(){return!(!this.weakPassword()&&this.matching())}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.K),e.Y36(m.gz))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],decls:6,vars:3,consts:[["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-success"],[1,"alert","alert-danger"],["resetForm","ngForm"],[1,"form-group"],["for","password"],["type","password","required","","minlength","8","id","password","placeholder","new password","name","fPassword",1,"form-control",3,"ngModel","ngModelChange"],["fPassword","ngModel"],[1,"alert","alert-danger",3,"hidden"],["for","password2"],["type","password","id","password2","required","","placeholder","password","name","fPassword2",1,"form-control",3,"ngModel","ngModelChange"],["fPassword2","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,s){1&t&&(e.TgZ(0,"div")(1,"h3"),e._uU(2,"Password reset"),e.qZA(),e.YNc(3,j,2,1,"div",0),e.YNc(4,H,2,1,"div",1),e.YNc(5,$,2,1,"div",2),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",s.msg),e.xp6(1),e.Q6J("ngIf",s.errMsg),e.xp6(1),e.Q6J("ngIf",s.token))},dependencies:[l.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.wO,a.On,a.F],encapsulation:2}),r})();var h=o(1574);function B(r,i){1&r&&(e.TgZ(0,"div",1),e._uU(1,"Use the activation link that was sent in the email"),e.qZA())}let W=(()=>{class r{constructor(t,s,n,c){this.route=t,this.router=s,this.userService=n,this.feedback=c}ngOnInit(){this.token=this.route.snapshot.queryParamMap.get("token"),this.token&&this.userService.activate(this.token).then(t=>{this.feedback.success("Your account has been activated, use: "+t.login+" to sign in"),this.router.navigate(["/login"])}).catch(t=>{this.feedback.error(t),this.router.navigate(["/login"])})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.gz),e.Y36(m.F0),e.Y36(p.K),e.Y36(h.T))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],decls:1,vars:1,consts:[["class","alert alert-danger danger",4,"ngIf"],[1,"alert","alert-danger","danger"]],template:function(t,s){1&t&&e.YNc(0,B,2,0,"div",0),2&t&&e.Q6J("ngIf",!s.token)},dependencies:[l.O5],encapsulation:2}),r})();var g=o(2096),q=o(7398),A=o(6306),V=o(481),u=o(7452),d=o(6005),f=o(9548),_=o(5877);const ee=["recaptcha"];function te(r,i){if(1&r&&(e.TgZ(0,"div",3)(1,"h4"),e._uU(2,"Your registration was successful."),e.qZA(),e._uU(3," We have sent you the activation link to "),e.TgZ(4,"strong"),e._uU(5),e.qZA(),e._uU(6,", please use that link before logging in "),e.qZA()),2&r){const t=e.oxw();e.xp6(5),e.Oqu(t.registeredMsg)}}function re(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Alphanumerical login, min length 5, only numbers, small letters and ._"),e.qZA())}function se(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Such login already exists"),e.qZA())}function ae(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Not valid email format"),e.qZA())}function ne(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Address is already being used"),e.qZA())}function ie(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Academic email is required for the registration. Contact us if your email is not recognized as academic. "),e.qZA())}function oe(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Passwords do not match"),e.qZA())}function ce(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"div",4)(1,"form",5,6)(3,"div",7)(4,"mat-form-field",8)(5,"mat-label",9),e._uU(6,"Login"),e.qZA(),e._UZ(7,"input",10),e.TgZ(8,"mat-hint"),e._uU(9,"Alphanumerical login, min length 5"),e.qZA(),e.YNc(10,re,2,0,"mat-error",11),e.YNc(11,se,2,0,"mat-error",11),e.qZA()(),e.TgZ(12,"div",7)(13,"mat-form-field",8)(14,"mat-label",12),e._uU(15,"Email"),e.qZA(),e._UZ(16,"input",13),e.YNc(17,ae,2,0,"mat-error",11),e.YNc(18,ne,2,0,"mat-error",11),e.YNc(19,ie,2,0,"mat-error",11),e.qZA()(),e.TgZ(20,"div",14)(21,"div",7)(22,"mat-form-field",8)(23,"mat-label",15),e._uU(24,"Password"),e.qZA(),e._UZ(25,"input",16),e.TgZ(26,"mat-hint"),e._uU(27,"Password must be at least 8 long, containing a digit or symbol or capital letter"),e.qZA(),e.TgZ(28,"mat-error"),e._uU(29,"Password must be at least 8 long, containing a digit or symbol or capital letter"),e.qZA()()(),e.TgZ(30,"div",7)(31,"mat-form-field",8)(32,"mat-label",17),e._uU(33,"Repeat password"),e.qZA(),e._UZ(34,"input",18),e.YNc(35,oe,2,0,"mat-error",11),e.qZA()()(),e.TgZ(36,"div",7)(37,"mat-form-field",8)(38,"mat-label",19),e._uU(39,"First Name"),e.qZA(),e._UZ(40,"input",20),e.qZA()(),e.TgZ(41,"div",7)(42,"mat-form-field",8)(43,"mat-label",21),e._uU(44,"Family Name"),e.qZA(),e._UZ(45,"input",22),e.qZA()(),e.TgZ(46,"div",7)(47,"mat-form-field",8)(48,"mat-label",23),e._uU(49,"Institution"),e.qZA(),e._UZ(50,"input",24),e.qZA()(),e.TgZ(51,"div",7)(52,"bd2-recaptcha",25,26),e.NdJ("captchaExpired",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.captchaExpired())})("captchaResponse",function(n){e.CHM(t);const c=e.oxw();return e.KtG(c.captcha(n))}),e.qZA(),e.TgZ(54,"div",27),e._uU(55," Captcha selection is needed "),e.qZA()(),e.TgZ(56,"div",7)(57,"mat-checkbox",28),e._uU(58," I agree to conditions of "),e.TgZ(59,"span",29)(60,"a",30),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.helpDialog.show("service"))}),e._uU(61,"service"),e.qZA()(),e._uU(62,". And I understand that unless changed my data will be shared 3 years after their registration. "),e.qZA()(),e.TgZ(63,"button",31),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.register())}),e._uU(64," Register "),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.userForm),e.xp6(9),e.Q6J("ngIf",t.userNameField.errors&&!t.userNameField.errors["login-taken"]),e.xp6(1),e.Q6J("ngIf",t.userNameField.errors&&t.userNameField.errors["login-taken"]),e.xp6(6),e.Q6J("ngIf",t.emailField.errors&&t.emailField.errors.pattern),e.xp6(1),e.Q6J("ngIf",t.emailField.errors&&t.emailField.errors["email-taken"]),e.xp6(1),e.Q6J("ngIf",t.emailField.errors&&t.emailField.errors["email-nonacademic"]),e.xp6(16),e.Q6J("ngIf",t.passwordsGroup.errors),e.xp6(17),e.Q6J("site_key",t.captchaSiteKey),e.xp6(2),e.Q6J("hidden",!t.missingCaptcha),e.xp6(9),e.Q6J("disabled",t.blocked||t.userForm.invalid)}}let de=(()=>{class r{constructor(t,s,n,c){this.userService=t,this.feedback=s,this.fb=n,this.helpDialog=c,this.blocked=!1,this.missingCaptcha=!1,this.captchaSiteKey=v.N.captchaSiteKey}ngOnInit(){this.userForm=this.fb.group({username:[void 0,{validators:[a.kI.required],asyncValidators:t=>this.availableLogin(t.value),updateOn:"blur"}],email:[void 0,{validators:[a.kI.required,t=>R(t.value)],asyncValidators:t=>this.suitableEmail(t.value),updateOn:"blur"}],passwords:this.fb.group({password:[void 0,[a.kI.required,t=>b(t.value)]],password2:[void 0,[a.kI.required]]},{validator:t=>x(t.value)}),firstName:[void 0,[a.kI.required]],lastName:[void 0,[a.kI.required]],institution:[void 0,[a.kI.required]],terms:[void 0,[a.kI.required]]}),this.userNameField=this.userForm.get("username"),this.emailField=this.userForm.get("email"),this.passwordField=this.userForm.get("passwords.password"),this.password2Field=this.userForm.get("passwords.password2"),this.passwordsGroup=this.userForm.get("passwords")}captcha(t){this.gRecaptchaResponse=t,t&&(this.missingCaptcha=!1)}captchaExpired(){this.gRecaptchaResponse=null}availableLogin(t){return!t||t.length<5?(0,g.of)({"too-short":!0}):this.userService.availableLogin(t).pipe((0,q.U)(s=>s?null:{"login-taken":"User "+t+" already exists"}),(0,A.K)(s=>(this.feedback.error(s),(0,g.of)({"cannot-connect":!0}))))}suitableEmail(t){return this.userService.suitableEmail(t).pipe((0,q.U)(s=>{if(s.isFree&&s.isAcademic)return null;const n={};return s.isFree||(n["email-taken"]="Email: "+t+" is already being used"),s.isAcademic||(n["email-nonacademic"]="Academic email is required for the registration. Contact us if your email is not recognized as academic."),n}),(0,A.K)(s=>(this.feedback.error(s),(0,g.of)({"cannot-connect":!0}))))}register(){if(this.userForm.valid){if(!this.gRecaptchaResponse&&!this.emailField.value.endsWith(".cn")&&!this.emailField.value.endsWith(".tw"))return void(this.missingCaptcha=!0);const t=this.makeUserData(this.userForm.value);this.triggerRegistration(t)}}makeUserData(t){return{login:t.username,password:t.passwords.password,email:t.email,firstName:t.firstName,lastName:t.lastName,institution:t.institution,terms:t.terms,g_recaptcha_response:this.gRecaptchaResponse}}triggerRegistration(t){this.userService.register(t).then(s=>{this.registered=!0,this.registeredMsg=s.email,this.feedback.success("Registration successful")}).catch(s=>{this.feedback.error(s),this.gRecaptchaResponse=void 0,this.recaptcha&&this.recaptcha.reset()})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.K),e.Y36(h.T),e.Y36(a.QS),e.Y36(V.l))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],viewQuery:function(t,s){if(1&t&&e.Gf(ee,5),2&t){let n;e.iGM(n=e.CRH())&&(s.recaptcha=n.first)}},decls:7,vars:2,consts:[[1,"mb-2"],["class","alert alert-success",4,"ngIf"],["class","mb-4",4,"ngIf"],[1,"alert","alert-success"],[1,"mb-4"],[3,"formGroup"],["registrationForm",""],[1,"form-group"],[1,"w-100"],["for","username"],["matInput","","formControlName","username","id","username","minlength","5","pattern","[0-9|a-z|\\._]+","placeholder","choose login","required","","type","text",1,""],[4,"ngIf"],["for","email"],["matInput","","formControlName","email","id","email","placeholder","your email","required","","type","text",1,""],["formGroupName","passwords"],["for","password"],["matInput","","formControlName","password","id","password","minlength","8","placeholder","password","required","","type","password",1,""],["for","password2"],["matInput","","formControlName","password2","id","password2","minlength","8","placeholder","password","required","","type","password",1,""],["for","firstName"],["matInput","","formControlName","firstName","id","firstName","minlength","2","placeholder","e.g. Charles","required","","type","text",1,""],["for","lastName"],["matInput","","formControlName","lastName","id","lastName","minlength","2","placeholder","e.g. Darwin","required","","type","text",1,""],["for","institution"],["matInput","","formControlName","institution","id","institution","minlength","3","placeholder","e.g. University of Edinburgh","required","","type","text",1,""],[3,"site_key","captchaExpired","captchaResponse"],["recaptcha",""],[1,"alert","alert-danger",3,"hidden"],["formControlName","terms","id","terms","required","","type","checkbox"],[2,"font-weight","bold","text-decoration","underline"],["role","button",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"]],template:function(t,s){1&t&&(e.TgZ(0,"mat-card",0)(1,"mat-card-title")(2,"h2"),e._uU(3,"User registration"),e.qZA()(),e.TgZ(4,"mat-card-content"),e.YNc(5,te,7,1,"div",1),e.YNc(6,ce,65,10,"div",2),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngIf",s.registered),e.xp6(1),e.Q6J("ngIf",!s.registered))},dependencies:[l.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.wO,a.c5,a.sg,a.u,a.x0,Z,u.a8,u.dn,u.n5,d.TO,d.KE,d.bx,d.hX,f.Nt,_.oG,_.e_],encapsulation:2}),r})();var F=o(9080);function ue(r,i){1&r&&(e.TgZ(0,"div",21),e._uU(1,"Account has been updated"),e.qZA())}function le(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"mat-card",1)(1,"mat-card-title")(2,"h2"),e._uU(3),e.qZA()(),e.TgZ(4,"mat-card-content"),e.YNc(5,ue,2,0,"div",2),e.TgZ(6,"form",3,4)(8,"div",5)(9,"mat-form-field",6)(10,"mat-label",7),e._uU(11,"Login"),e.qZA(),e._UZ(12,"input",8),e.qZA()(),e.TgZ(13,"div",5)(14,"a",9),e._uU(15,"Change password"),e.qZA()(),e.TgZ(16,"div",5)(17,"mat-form-field",6)(18,"mat-label",10),e._uU(19,"Email"),e.qZA(),e._UZ(20,"input",11),e.TgZ(21,"mat-error"),e._uU(22,"Not valid email format"),e.qZA()()(),e.TgZ(23,"div",5)(24,"mat-form-field",6)(25,"mat-label",12),e._uU(26,"First Name"),e.qZA(),e._UZ(27,"input",13),e.qZA()(),e.TgZ(28,"div",5)(29,"mat-form-field",6)(30,"mat-label",14),e._uU(31,"Family Name"),e.qZA(),e._UZ(32,"input",15),e.qZA()(),e.TgZ(33,"div",5)(34,"mat-form-field",6)(35,"mat-label",16),e._uU(36,"Institution"),e.qZA(),e._UZ(37,"input",17),e.qZA()(),e.TgZ(38,"div",5)(39,"mat-form-field",6)(40,"mat-label",18),e._uU(41,"Current password"),e.qZA(),e._UZ(42,"input",19),e.qZA()(),e.TgZ(43,"button",20),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.save())}),e._uU(44," Update "),e.qZA()()()()}if(2&r){const t=e.oxw();e.xp6(3),e.hij("Edit user: ",t.user.name,""),e.xp6(2),e.Q6J("ngIf",t.updated),e.xp6(1),e.Q6J("formGroup",t.userForm),e.xp6(37),e.Q6J("disabled",t.userForm.invalid)}}function pe(r,i){1&r&&(e.TgZ(0,"div",18),e._uU(1,"Password has been updated"),e.qZA())}function he(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1,"Passwords do not match"),e.qZA())}function fe(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"mat-card",1)(1,"mat-card-title")(2,"h2"),e._uU(3),e.qZA()(),e.TgZ(4,"mat-card-content"),e.YNc(5,pe,2,0,"div",2),e.TgZ(6,"form",3,4)(8,"div",5)(9,"mat-form-field",6)(10,"mat-label",7),e._uU(11,"Login"),e.qZA(),e._UZ(12,"input",8),e.qZA()(),e.TgZ(13,"div",9)(14,"div",5)(15,"mat-form-field",6)(16,"mat-label",10),e._uU(17,"Password"),e.qZA(),e._UZ(18,"input",11),e.TgZ(19,"mat-hint"),e._uU(20,"Password must be at least 8 long, containing a digit or symbol or capital letter"),e.qZA(),e.TgZ(21,"mat-error"),e._uU(22,"Password must be at least 8 long, containing a digit or symbol or capital letter"),e.qZA()()(),e.TgZ(23,"div",5)(24,"mat-form-field",6)(25,"mat-label",12),e._uU(26,"Repeat password"),e.qZA(),e._UZ(27,"input",13),e.YNc(28,he,2,0,"mat-error",14),e.qZA()()(),e.TgZ(29,"div",5)(30,"mat-form-field",6)(31,"mat-label",15),e._uU(32,"Current password"),e.qZA(),e._UZ(33,"input",16),e.qZA()(),e.TgZ(34,"button",17),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.save())}),e._uU(35," Update "),e.qZA()()()()}if(2&r){const t=e.oxw();e.xp6(3),e.hij("Change password for ",t.user.name,""),e.xp6(2),e.Q6J("ngIf",t.updated),e.xp6(1),e.Q6J("formGroup",t.userForm),e.xp6(22),e.Q6J("ngIf",t.passwordsGroup.errors),e.xp6(6),e.Q6J("disabled",t.userForm.invalid)}}const ge=[{path:"",children:[{path:"edit",component:(()=>{class r{constructor(t,s,n){this.userService=t,this.feedback=s,this.fb=n,this.updated=!1}ngOnInit(){this.user=this.userService.currentUser,this.userForm=this.fb.group({username:[{value:this.user.login,disabled:!0},[a.kI.required],[]],email:[this.user.email,[a.kI.required,t=>R(t.value)],[]],firstName:[this.user.firstName,[a.kI.required]],lastName:[this.user.lastName,[a.kI.required]],institution:[this.user.institution,[a.kI.required]],currentPassword:[void 0,[a.kI.required]]}),this.userNameField=this.userForm.get("username"),this.emailField=this.userForm.get("email"),this.currentPasswordField=this.userForm.get("currentPassword")}save(){if(!this.userForm.valid)return;const t=this.userForm.value,s={login:this.user.login,currentPassword:t.currentPassword,email:t.email,firstName:t.firstName,lastName:t.lastName,institution:t.institution};this.updated=!1,this.userService.update(s).subscribe(n=>{this.user=n,this.currentPasswordField.reset(),this.feedback.success("User: "+n.login+" has been updated"),this.updated=!0,(0,F.H)(5e3).subscribe(()=>this.updated=!1)},n=>{this.feedback.error(n),this.currentPasswordField.reset()})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.K),e.Y36(h.T),e.Y36(a.QS))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],decls:1,vars:1,consts:[["class","mb-2",4,"ngIf"],[1,"mb-2"],["class","alert alert-success",4,"ngIf"],[3,"formGroup"],["registrationForm",""],[1,"form-group"],[1,"w-100"],["for","username"],["matInput","","formControlName","username","id","username","required","","type","text",1,""],["routerLink","/account/password"],["for","email"],["matInput","","formControlName","email","id","email","placeholder","your email","required","","type","text",1,""],["for","firstName"],["matInput","","formControlName","firstName","id","firstName","minlength","2","placeholder","e.g. Charles","required","","type","text",1,""],["for","lastName"],["matInput","","formControlName","lastName","id","lastName","minlength","2","placeholder","e.g. Darwin","required","","type","text",1,""],["for","institution"],["matInput","","formControlName","institution","id","institution","placeholder","e.g. University of Edinburgh","required","","type","text",1,""],["for","cPassword"],["matInput","","formControlName","currentPassword","id","cPassword","placeholder","current password","required","","type","password",1,""],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"alert","alert-success"]],template:function(t,s){1&t&&e.YNc(0,le,45,4,"mat-card",0),2&t&&e.Q6J("ngIf",s.user&&!s.user.anonymous)},dependencies:[l.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.wO,a.sg,a.u,m.rH,u.a8,u.dn,u.n5,d.TO,d.KE,d.hX,f.Nt],encapsulation:2}),r})()},{path:"password",component:(()=>{class r{constructor(t,s,n){this.userService=t,this.feedback=s,this.fb=n,this.updated=!1}ngOnInit(){this.user=this.userService.currentUser,this.userForm=this.fb.group({username:[{value:this.user.login,disabled:!0},[a.kI.required],[]],passwords:this.fb.group({password:[void 0,[a.kI.required,t=>b(t.value)]],password2:[void 0,[a.kI.required]]},{validator:t=>x(t.value)}),currentPassword:[void 0,[a.kI.required]]}),this.passwordsGroup=this.userForm.get("passwords")}save(){if(!this.userForm.valid)return;const t=this.userForm.value,s={login:this.user.login,currentPassword:t.currentPassword,password:t.passwords.password};this.updated=!1,this.userService.passwordUpdate(s).subscribe(n=>{this.user=n,this.userForm.reset(),this.feedback.success("User: "+n.login+" password has been updated"),this.updated=!0,(0,F.H)(5e3).subscribe(()=>this.updated=!1)},n=>{this.userForm.reset(),this.feedback.error(n)})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.K),e.Y36(h.T),e.Y36(a.QS))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],decls:1,vars:1,consts:[["class","mb-2",4,"ngIf"],[1,"mb-2"],["class","alert alert-success",4,"ngIf"],[3,"formGroup"],["registrationForm",""],[1,"form-group"],[1,"w-100"],["for","username"],["matInput","","formControlName","username","id","username","required","","type","text",1,""],["formGroupName","passwords"],["for","password"],["matInput","","formControlName","password","id","password","minlength","8","placeholder","password","required","","type","password",1,""],["for","password2"],["matInput","","formControlName","password2","id","password2","minlength","8","placeholder","password","required","","type","password",1,""],[4,"ngIf"],["for","cPassword"],["matInput","","formControlName","currentPassword","id","cPassword","placeholder","current password","required","","type","password",1,""],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"alert","alert-success"]],template:function(t,s){1&t&&e.YNc(0,fe,36,5,"mat-card",0),2&t&&e.Q6J("ngIf",s.user&&!s.user.anonymous)},dependencies:[l.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.wO,a.sg,a.u,a.x0,u.a8,u.dn,u.n5,d.TO,d.KE,d.bx,d.hX,f.Nt],encapsulation:2}),r})()},{path:"register",component:de},{path:"activate",component:W},{path:"remind",component:J},{path:"reset",component:D}]}];let _e=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[m.Bz.forChild(ge),m.Bz]}),r})(),we=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({}),r})();var ve=o(8066),Ze=o(2468),Ce=o(4692);let be=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[l.ez,a.u5,a.UX,we,ve.i,_e,u.QW,Ze.t,d.lN,Ce.Ps,f.c,_.p9]}),r})()}}]);