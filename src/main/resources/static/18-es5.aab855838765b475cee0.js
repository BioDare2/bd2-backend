function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=_superPropBase(t,e);if(i){var a=Object.getOwnPropertyDescriptor(i,e);return a.get?a.get.call(n):a.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,a=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(c){a=!0,r=c}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _createForOfIteratorHelper(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(t);if(e){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{QftV:function(t,e,n){"use strict";n.r(e),n.d(e,"TsHeatmapModule",(function(){return Je}));var i=n("ofXK"),a=n("3Pt+"),r=n("M9IT"),o=n("tyNb"),s=n("yYXI"),c=n("Kj3r"),l=n("bngM"),h=n("QBpm"),u=n("Iab2"),f=n("e8YO"),g=n("K5d1"),p=n("fXoL"),d=n("vejM"),b=n("ZMwR"),m=n("GVyA"),y=n("wcxA"),v=n("Tl2h"),x=n("1jcm"),k=n("8LU1"),w=n("bTqV");function C(t,e){if(1&t&&(p.Wb(0,"option",16),p.Gc(1),p.Vb()),2&t){var n=e.$implicit;p.oc("value",n),p.Cb(1),p.Ic(" ",n,"")}}function S(t,e){if(1&t){var n=p.Xb();p.Wb(0,"div"),p.Wb(1,"select",14),p.ec("ngModelChange",(function(t){return p.xc(n),p.ic()._changePageSize(t)})),p.Ec(2,C,2,2,"option",15),p.Vb(),p.Vb()}if(2&t){var i=p.ic();p.Cb(1),p.oc("ngModel",i.pageSize),p.Cb(1),p.oc("ngForOf",i._displayedPageSizeOptions)}}function O(t,e){if(1&t&&(p.Wb(0,"div",17),p.Gc(1),p.Vb()),2&t){var n=p.ic();p.Cb(1),p.Ic("",n.pageSize," ")}}var M,_=((M=function(){function t(e){_classCallCheck(this,t),this._changeDetectorRef=e,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this.disabled=!1,this.page=new p.o,this.getRangeLabel=function(t,e,n){if(0==n||0==e)return"0 of "+n;var i=t*e;return"".concat(i+1," \u2013 ").concat(i<(n=Math.max(n,0))?Math.min(i+e,n):i+e," of ").concat(n)}}return _createClass(t,[{key:"ngOnInit",value:function(){this._updateDisplayedPageSizeOptions()}},{key:"nextPage",value:function(){if(this.hasNextPage()){var t=this.pageIndex;this.pageIndex++,this._emitPageEvent(t)}}},{key:"previousPage",value:function(){if(this.hasPreviousPage()){var t=this.pageIndex;this.pageIndex--,this._emitPageEvent(t)}}},{key:"hasPreviousPage",value:function(){return this.pageIndex>=1&&0!=this.pageSize}},{key:"hasNextPage",value:function(){var t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}},{key:"getNumberOfPages",value:function(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}},{key:"_nextButtonsDisabled",value:function(){return this.disabled||!this.hasNextPage()}},{key:"_previousButtonsDisabled",value:function(){return this.disabled||!this.hasPreviousPage()}},{key:"_updateDisplayedPageSizeOptions",value:function(){this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((function(t,e){return t-e})),this._changeDetectorRef.markForCheck()}},{key:"_changePageSize",value:function(t){var e=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(e)}},{key:"_emitPageEvent",value:function(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}},{key:"pageIndex",get:function(){return this._pageIndex},set:function(t){this._pageIndex=Math.max(Object(k.f)(t),0),this._changeDetectorRef.markForCheck()}},{key:"length",get:function(){return this._length},set:function(t){this._length=Object(k.f)(t),this._changeDetectorRef.markForCheck()}},{key:"pageSize",get:function(){return this._pageSize},set:function(t){this._pageSize=Math.max(Object(k.f)(t),0),this._updateDisplayedPageSizeOptions()}},{key:"pageSizeOptions",get:function(){return this._pageSizeOptions},set:function(t){this._pageSizeOptions=(t||[]).map((function(t){return Object(k.f)(t)})),this._updateDisplayedPageSizeOptions()}}]),t}()).\u0275fac=function(t){return new(t||M)(p.Qb(p.h))},M.\u0275cmp=p.Kb({type:M,selectors:[["bd2-simple-paginator"]],inputs:{pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",disabled:"disabled"},outputs:{page:"page"},decls:17,vars:7,consts:[[1,"mat-paginator"],[1,"mat-paginator-outer-container"],[1,"mat-paginator-container"],[1,"mat-paginator-page-size"],[1,"mat-paginator-page-size-label"],[4,"ngIf"],["class","mat-paginator-page-size-value",4,"ngIf"],[1,"mat-paginator-range-actions"],[1,"mat-paginator-range-label"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-previous",3,"disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-next",3,"disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["required","",1,"mat-paginator-page-size-select",2,"font-size","12px",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-paginator-page-size-value"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"div",3),p.Wb(4,"div",4),p.Gc(5," Items per page: "),p.Vb(),p.Ec(6,S,3,2,"div",5),p.Ec(7,O,2,1,"div",6),p.Vb(),p.Wb(8,"div",7),p.Wb(9,"div",8),p.Gc(10),p.Vb(),p.Wb(11,"button",9),p.ec("click",(function(){return e.previousPage()})),p.hc(),p.Wb(12,"svg",10),p.Rb(13,"path",11),p.Vb(),p.Vb(),p.gc(),p.Wb(14,"button",12),p.ec("click",(function(){return e.nextPage()})),p.hc(),p.Wb(15,"svg",10),p.Rb(16,"path",13),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&t&&(p.Cb(6),p.oc("ngIf",e._displayedPageSizeOptions.length>1),p.Cb(1),p.oc("ngIf",e._displayedPageSizeOptions.length<=1),p.Cb(3),p.Ic(" ",e.getRangeLabel(e.pageIndex,e.pageSize,e.length)," "),p.Cb(1),p.oc("disabled",e._previousButtonsDisabled()),p.Db("aria-label","previous page"),p.Cb(3),p.oc("disabled",e._nextButtonsDisabled()),p.Db("aria-label","next page"))},directives:[i.m,w.a,a.z,a.y,a.p,a.s,i.l,a.t,a.B],styles:[".mat-paginator-icon[_ngcontent-%COMP%] {\n        width: 28px;\n        fill: currentColor;\n\n      }\n\n      .mat-paginator-range-actions[_ngcontent-%COMP%] {\n        display: flex;\n        align-items: center;\n      }\n\n      .mat-paginator[_ngcontent-%COMP%] {\n        display: block;\n      }\n\n      .mat-paginator-outer-container[_ngcontent-%COMP%] {\n        display: flex;\n      }\n\n      .mat-paginator-container[_ngcontent-%COMP%] {\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        min-height: 56px;\n        padding: 0 8px;\n        flex-wrap: wrap-reverse;\n        width: 100%;\n      }\n\n      .mat-paginator-page-size[_ngcontent-%COMP%] {\n        display: flex;\n        align-items: baseline;\n        margin-right: 8px;\n      }\n\n      .mat-paginator-page-size-label[_ngcontent-%COMP%] {\n        margin: 0 4px;\n      }\n\n      .mat-paginator-page-size-select[_ngcontent-%COMP%] {\n        margin: 6px 4px 0 4px;\n        width: 70px;\n\n      }\n\n      .mat-paginator-range-label[_ngcontent-%COMP%] {\n        margin:  0 32px 0 24px;\n      }"],changeDetection:0}),M);function P(t,e){if(1&t&&(p.Wb(0,"option",28),p.Gc(1),p.Vb()),2&t){var n=e.$implicit;p.oc("value",n.name),p.Cb(1),p.Hc(n.label)}}function W(t,e){if(1&t&&(p.Wb(0,"option",28),p.Gc(1),p.Vb()),2&t){var n=e.$implicit;p.oc("value",n.name),p.Cb(1),p.Hc(n.label)}}function I(t,e){if(1&t&&(p.Wb(0,"option",28),p.Gc(1),p.Vb()),2&t){var n=e.$implicit;p.oc("value",n.name),p.Cb(1),p.Hc(n.label)}}var B,D=function(){return[10,25,50,100,200,500]},V=((B=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var i;_classCallCheck(this,n),(i=e.call(this,t)).alignOptions=[new v.e("NONE","none"),new v.e("MEAN","mean")];var a=i.normalisationOptions.find((function(t){return"RANGE"===t.name}));return i.displayParamsForm.get("normalisation").setValue(null==a?void 0:a.name),i.displayParamsForm.get("hourly").setValue(!0),i}return n}(y.a)).\u0275fac=function(t){return new(t||B)(p.Qb(a.d))},B.\u0275cmp=p.Kb({type:B,selectors:[["bd2-heatmap-display-params-rform"]],inputs:{disabled:"disabled",totalTraces:"totalTraces",currentPage:"currentPage"},outputs:{displayParams:"displayParams"},features:[p.zb],decls:46,vars:10,consts:[["role","form",1,"form-horizontal","container",3,"formGroup"],[1,"row"],[1,"col-md-8","col-sm-10"],["formGroupName","timeScale",1,"form-group","row"],[1,"col-md-3","col-sm-3"],["for","timeStart",1,"col-md-1","col-sm-2"],["type","number","step","any","min","0","size","5","id","timeStart","required","","formControlName","timeStart",1,"form-control"],["for","timeEnd",1,"col-md-1","col-sm-1"],["type","number","step","any","min","0","size","5","required","","id","timeEnd","formControlName","timeEnd",1,"form-control"],[1,"col-md-2","col-sm-4"],["formControlName","hourly",1,"mr-3"],[1,"form-group","row"],["for","detrending",1,"col-sm-2"],[1,"col-sm-3"],["required","","id","detrending","formControlName","detrending",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-1"],["for","align",1,"col-sm-1"],["required","","id","align","formControlName","align",1,"form-control"],[1,"col-sm-2"],["for","normalisation"],["required","","id","normalisation","formControlName","normalisation",1,"form-control"],[1,"col-sm"],["formControlName","trimFirst",1,"mr-3"],["formControlName","log2"],[1,"col-sm-8"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["dataPaginator",""],[3,"value"]],template:function(t,e){1&t&&(p.Wb(0,"form",0),p.Wb(1,"div",1),p.Wb(2,"div",2),p.Wb(3,"div",3),p.Wb(4,"label",4),p.Gc(5,"Time range"),p.Vb(),p.Wb(6,"label",5),p.Gc(7,"from:"),p.Vb(),p.Wb(8,"div",4),p.Rb(9,"input",6),p.Vb(),p.Wb(10,"label",7),p.Gc(11,"to:"),p.Vb(),p.Wb(12,"div",4),p.Rb(13,"input",8),p.Vb(),p.Vb(),p.Vb(),p.Wb(14,"div",9),p.Wb(15,"mat-slide-toggle",10),p.Gc(16,"hourly"),p.Vb(),p.Vb(),p.Vb(),p.Wb(17,"div",11),p.Wb(18,"label",12),p.Gc(19,"Detrending"),p.Vb(),p.Wb(20,"div",13),p.Wb(21,"select",14),p.Ec(22,P,2,2,"option",15),p.Vb(),p.Vb(),p.Rb(23,"div",16),p.Wb(24,"label",17),p.Gc(25,"Align"),p.Vb(),p.Wb(26,"div",13),p.Wb(27,"select",18),p.Ec(28,W,2,2,"option",15),p.Vb(),p.Vb(),p.Vb(),p.Wb(29,"div",11),p.Wb(30,"div",19),p.Wb(31,"label",20),p.Gc(32,"Normalize"),p.Vb(),p.Vb(),p.Wb(33,"div",13),p.Wb(34,"select",21),p.Ec(35,I,2,2,"option",15),p.Vb(),p.Vb(),p.Wb(36,"div",22),p.Wb(37,"mat-slide-toggle",23),p.Gc(38,"within range"),p.Vb(),p.Wb(39,"mat-slide-toggle",24),p.Gc(40,"log2 transf."),p.Vb(),p.Vb(),p.Vb(),p.Wb(41,"div",11),p.Rb(42,"label",19),p.Wb(43,"div",25),p.Wb(44,"bd2-simple-paginator",26,27),p.ec("page",(function(t){return e.loadDataPage(t)})),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&t&&(p.oc("formGroup",e.mainForm),p.Cb(22),p.oc("ngForOf",e.detrendingOptions),p.Cb(6),p.oc("ngForOf",e.alignOptions),p.Cb(7),p.oc("ngForOf",e.normalisationOptions),p.Cb(9),p.oc("length",e.totalTraces)("disabled",e.disabledPagination)("pageSize",e.currentPage.pageSize)("pageIndex",e.currentPage.pageIndex)("pageSizeOptions",p.qc(9,D)))},directives:[a.C,a.q,a.h,a.i,a.u,a.c,a.y,a.p,a.g,x.a,a.z,i.l,_,a.t,a.B],encapsulation:2}),B),T=n("7EHt"),N=n("117B"),z=n("XNiG"),R=n("PqYM"),A=Math.sqrt(50),E=Math.sqrt(10),F=Math.sqrt(2);function H(t,e,n){var i=(e-t)/Math.max(0,n),a=Math.floor(Math.log(i)/Math.LN10),r=i/Math.pow(10,a);return a>=0?(r>=A?10:r>=E?5:r>=F?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(r>=A?10:r>=E?5:r>=F?2:1)}var j,G,L=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},$=(1===(j=L).length&&(G=j,j=function(t,e){return L(G(t),e)}),{left:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var a=n+i>>>1;j(t[a],e)<0?n=a+1:i=a}return n},right:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var a=n+i>>>1;j(t[a],e)>0?i=a:n=a+1}return n}}).right,q=n("6h3Y"),K=n("4xfg"),Q=n("WFeF"),Z=function(t){return+t},Y=[0,1];function X(t){return t}function U(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function J(t,e,n){var i=t[0],a=t[1],r=e[0],o=e[1];return a<i?(i=U(a,i),r=n(o,r)):(i=U(i,a),r=n(r,o)),function(t){return r(i(t))}}function tt(t,e,n){var i=Math.min(t.length,e.length)-1,a=new Array(i),r=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)a[o]=U(t[o],t[o+1]),r[o]=n(e[o],e[o+1]);return function(e){var n=$(t,e,1,i)-1;return r[n](a[n](e))}}function et(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function nt(){return function(){var t,e,n,i,a,r,o=Y,s=Y,c=q.a,l=X;function h(){var t,e,n,c=Math.min(o.length,s.length);return l!==X&&((t=o[0])>(e=o[c-1])&&(n=t,t=e,e=n),l=function(n){return Math.max(t,Math.min(e,n))}),i=c>2?tt:J,a=r=null,u}function u(e){return isNaN(e=+e)?n:(a||(a=i(o.map(t),s,c)))(t(l(e)))}return u.invert=function(n){return l(e((r||(r=i(s,o.map(t),K.a)))(n)))},u.domain=function(t){return arguments.length?(o=Array.from(t,Z),h()):o.slice()},u.range=function(t){return arguments.length?(s=Array.from(t),h()):s.slice()},u.rangeRound=function(t){return s=Array.from(t),c=Q.a,h()},u.clamp=function(t){return arguments.length?(l=!!t||X,h()):l!==X},u.interpolate=function(t){return arguments.length?(c=t,h()):c},u.unknown=function(t){return arguments.length?(n=t,u):n},function(n,i){return t=n,e=i,h()}}()(X,X)}function it(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var at=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rt(t){if(!(e=at.exec(t)))throw new Error("invalid format: "+t);var e;return new ot({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ot(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}rt.prototype=ot.prototype,ot.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var st,ct,lt,ht,ut=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]},ft=function(t){return(t=ut(Math.abs(t)))?t[1]:NaN},gt=function(t,e){var n=ut(t,e);if(!n)return t+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")},pt={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return gt(100*t,e)},r:gt,s:function(t,e){var n=ut(t,e);if(!n)return t+"";var i=n[0],a=n[1],r=a-(st=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=i.length;return r===o?i:r>o?i+new Array(r-o+1).join("0"):r>0?i.slice(0,r)+"."+i.slice(r):"0."+new Array(1-r).join("0")+ut(t,Math.max(0,e+r-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},dt=function(t){return t},bt=Array.prototype.map,mt=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function yt(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var i,a,r,o,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((i=e<t)&&(a=t,t=e,e=a),0===(o=H(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),r=new Array(a=Math.ceil(e-t+1));++s<a;)r[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),r=new Array(a=Math.ceil(t-e+1));++s<a;)r[s]=(t-s)/o;return i&&r.reverse(),r}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return function(t,e,n,i){var a,r=function(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),r=i/a;return r>=A?a*=10:r>=E?a*=5:r>=F&&(a*=2),e<t?-a:a}(t,e,n);switch((i=rt(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(a=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ft(e)/3)))-ft(Math.abs(t)))}(r,o))||(i.precision=a),ht(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(a=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ft(e)-ft(t))+1}(r,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=a-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(a=function(t){return Math.max(0,-ft(Math.abs(t)))}(r))||(i.precision=a-2*("%"===i.type))}return lt(i)}(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,a=e(),r=0,o=a.length-1,s=a[r],c=a[o];return c<s&&(i=s,s=c,c=i,i=r,r=o,o=i),(i=H(s,c,n))>0?i=H(s=Math.floor(s/i)*i,c=Math.ceil(c/i)*i,n):i<0&&(i=H(s=Math.ceil(s*i)/i,c=Math.floor(c*i)/i,n)),i>0?(a[r]=Math.floor(s/i)*i,a[o]=Math.ceil(c/i)*i,e(a)):i<0&&(a[r]=Math.ceil(s*i)/i,a[o]=Math.floor(c*i)/i,e(a)),t},t}function vt(){var t=nt();return t.copy=function(){return et(t,vt())},it.apply(t,arguments),yt(t)}ct=function(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?dt:(e=bt.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var a=t.length,r=[],o=0,s=e[0],c=0;a>0&&s>0&&(c+s+1>i&&(s=Math.max(1,i-c)),r.push(t.substring(a-=s,a+s)),!((c+=s+1)>i));)s=e[o=(o+1)%e.length];return r.reverse().join(n)}),a=void 0===t.currency?"":t.currency[0]+"",r=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?dt:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(bt.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"-":t.minus+"",h=void 0===t.nan?"NaN":t.nan+"";function u(t){var e=(t=rt(t)).fill,n=t.align,u=t.sign,f=t.symbol,g=t.zero,p=t.width,d=t.comma,b=t.precision,m=t.trim,y=t.type;"n"===y?(d=!0,y="g"):pt[y]||(void 0===b&&(b=12),m=!0,y="g"),(g||"0"===e&&"="===n)&&(g=!0,e="0",n="=");var v="$"===f?a:"#"===f&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===f?r:/[%p]/.test(y)?c:"",k=pt[y],w=/[defgprs%]/.test(y);function C(t){var a,r,c,f=v,C=x;if("c"===y)C=k(t)+C,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?h:k(Math.abs(t),b),m&&(t=function(t){t:for(var e,n=t.length,i=1,a=-1;i<n;++i)switch(t[i]){case".":a=e=i;break;case"0":0===a&&(a=i),e=i;break;default:if(!+t[i])break t;a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(e+1):t}(t)),S&&0==+t&&"+"!==u&&(S=!1),f=(S?"("===u?u:l:"-"===u||"("===u?"":u)+f,C=("s"===y?mt[8+st/3]:"")+C+(S&&"("===u?")":""),w)for(a=-1,r=t.length;++a<r;)if(48>(c=t.charCodeAt(a))||c>57){C=(46===c?o+t.slice(a+1):t.slice(a))+C,t=t.slice(0,a);break}}d&&!g&&(t=i(t,1/0));var O=f.length+t.length+C.length,M=O<p?new Array(p-O+1).join(e):"";switch(d&&g&&(t=i(M+t,M.length?p-C.length:1/0),M=""),n){case"<":t=f+t+C+M;break;case"=":t=f+M+t+C;break;case"^":t=M.slice(0,O=M.length>>1)+f+t+C+M.slice(O);break;default:t=M+f+t+C}return s(t)}return b=void 0===b?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b)),C.toString=function(){return t+""},C}return{format:u,formatPrefix:function(t,e){var n=u(((t=rt(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(ft(e)/3))),a=Math.pow(10,-i),r=mt[8+i/3];return function(t){return n(a*t)+r}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),lt=ct.format,ht=ct.formatPrefix;var xt=function(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;for(var i=-1,a=0|Math.max(0,Math.ceil((e-t)/n)),r=new Array(a);++i<a;)r[i]=t+i*n;return r},kt=Symbol("implicit");function wt(){var t=new Map,e=[],n=[],i=kt;function a(a){var r=a+"",o=t.get(r);if(!o){if(i!==kt)return i;t.set(r,o=e.push(a))}return n[(o-1)%n.length]}return a.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;var i,r=_createForOfIteratorHelper(n);try{for(r.s();!(i=r.n()).done;){var o=i.value,s=o+"";t.has(s)||t.set(s,e.push(o))}}catch(c){r.e(c)}finally{r.f()}return a},a.range=function(t){return arguments.length?(n=Array.from(t),a):n.slice()},a.unknown=function(t){return arguments.length?(i=t,a):i},a.copy=function(){return wt(e,n).unknown(i)},it.apply(a,arguments),a}var Ct=n("FmoU"),St=n("CKiT"),Ot=n("lJxs"),Mt=n("vkgz");function _t(t,e){if(1&t&&(p.hc(),p.Wb(0,"svg",2),p.Wb(1,"defs"),p.Wb(2,"filter",3),p.Rb(3,"feDropShadow",4),p.Vb(),p.Wb(4,"pattern",5),p.Rb(5,"line",6),p.Vb(),p.Vb(),p.Wb(6,"g",7),p.Rb(7,"g",8),p.Rb(8,"g",9),p.Rb(9,"g",10),p.Rb(10,"g",11),p.Rb(11,"g",12),p.Vb(),p.Vb()),2&t){var n=p.ic();p.Db("viewBox",n.graphic.viewBox),p.Cb(6),p.Db("transform",n.graphic.mainPaneTransform),p.Cb(1),p.oc("graphic",n.graphic),p.Cb(1),p.oc("graphic",n.graphic),p.Cb(1),p.oc("graphic",n.graphic)("series",n.series),p.Cb(1),p.oc("graphic",n.graphic)("data",n.series)("alwaysOn",n.labelsAlwaysOn),p.Cb(1),p.oc("graphic",n.graphic)}}var Pt=["text"],Wt=["bd2hm-tooltip",""];function It(t,e){if(1&t&&(p.hc(),p.Wb(0,"g",1),p.Wb(1,"g"),p.Rb(2,"rect"),p.Wb(3,"text",null,2),p.Wb(5,"tspan",3),p.Gc(6),p.Vb(),p.Wb(7,"tspan",4),p.Gc(8),p.Vb(),p.Vb(),p.Vb(),p.Vb()),2&t){var n=p.ic();p.Db("display",n.show?void 0:"none")("transform",n.position),p.Cb(1),p.Db("opacity",n.ready?1:0),p.Cb(1),p.Db("x",n.textBX)("width",n.textBWidth)("y",n.textBY)("height",n.textBHeight),p.Cb(4),p.Hc(n.label),p.Cb(2),p.Hc(n.values)}}var Bt=["bd2hm-labels",""];function Dt(t,e){if(1&t&&(p.hc(),p.Rb(0,"g",3)),2&t){var n=e.$implicit,i=p.ic(2);p.oc("serie",n)("yStart",i.yStart(n))("maxHeight",i.maxHeight())("alwaysOn",i.alwaysOn)}}function Vt(t,e){if(1&t&&(p.hc(),p.Wb(0,"g",1),p.Ec(1,Dt,1,4,"g",2),p.Vb()),2&t){var n=p.ic();p.Cb(1),p.oc("ngForOf",n.data)("ngForTrackBy",n.trackByIndex)}}var Tt=["bd2hm-label-box",""];function Nt(t,e){if(1&t&&(p.hc(),p.Wb(0,"text",9),p.Gc(1),p.Vb()),2&t){var n=p.ic(2);p.Db("y",n.yMiddle)("font-size",n.fontSize()),p.Cb(1),p.Hc(n.serie.label)}}function zt(t,e){if(1&t){var n=p.Xb();p.hc(),p.Wb(0,"g",1),p.Ec(1,Nt,2,3,"text",2),p.Wb(2,"g",3),p.ec("mouseout",(function(){return p.xc(n),p.ic().toggleLabel(!1)}))("mouseover",(function(){return p.xc(n),p.ic().toggleLabel(!0)})),p.Rb(3,"rect",4),p.Wb(4,"g",5),p.Rb(5,"rect",6),p.Wb(6,"text",7,8),p.Gc(8),p.Vb(),p.Vb(),p.Vb(),p.Vb()}if(2&t){var i=p.ic();p.Cb(1),p.oc("ngIf",i.alwaysOn),p.Cb(2),p.Db("y",i.triggerY)("height",i.triggerHeight)("fill",i.color),p.Cb(1),p.Db("opacity",i.ready?1:0)("display",i.toggled?void 0:"none"),p.Cb(1),p.Db("width",i.textBWidth)("y",i.textBY)("height",i.textBHeight),p.Cb(1),p.Db("y",i.yMiddle),p.Cb(2),p.Hc(i.serie.label)}}var Rt=["bd2hm-serie-row",""];function At(t,e){if(1&t&&(p.hc(),p.Rb(0,"g",3)),2&t){var n=e.$implicit,i=p.ic(2);p.oc("point",n)("xScale",i.graphic.xScale)("yPosition",i.yPosition)("yHeight",i.yHeight)("colorScale",i.graphic.colorScale)("label",i.serie.label)}}function Et(t,e){if(1&t&&(p.hc(),p.Wb(0,"g",1),p.Ec(1,At,1,6,"g",2),p.Vb()),2&t){var n=p.ic();p.Cb(1),p.oc("ngForOf",n.serie.data)("ngForTrackBy",n.trackByIndex)}}var Ft=["box"],Ht=["bd2hm-data-point-box",""];function jt(t,e){if(1&t&&(p.hc(),p.Rb(0,"rect",null,1)),2&t){var n=p.ic();p.Db("x",n.xPosition)("y",n.yPosition)("width",n.xWidth)("height",n.yHeight)("fill",n.colorScale(n.point.y))("stroke",n.colorScale(n.point.y))}}var Gt=["bd2hm-series-box",""];function Lt(t,e){if(1&t&&(p.hc(),p.Rb(0,"g",1)),2&t){var n=e.$implicit,i=p.ic();p.oc("graphic",i.graphic)("serie",n)}}var $t=["bd2hm-pane-back",""],qt=["bd2hm-axis-box",""];function Kt(t,e){if(1&t&&(p.hc(),p.Wb(0,"g",1),p.Rb(1,"g",2),p.Rb(2,"g",3),p.Rb(3,"g",4),p.Rb(4,"g",5),p.Vb()),2&t){var n=p.ic();p.Cb(1),p.oc("top",!0)("xScale",n.graphic.xScale)("yPosition",0)("xDomain",n.graphic.xDomain),p.Cb(1),p.oc("top",!1)("xScale",n.graphic.xScale)("yPosition",n.graphic.workspaceHeight)("xDomain",n.graphic.xDomain),p.Cb(1),p.oc("left",!0)("yScale",n.graphic.yScale)("xPosition",0),p.Cb(1),p.oc("left",!1)("yScale",n.graphic.yScale)("xPosition",n.graphic.workspaceWidth)}}var Qt=["bd2hm-y-axis",""],Zt=["bd2hm-vtick-mark",""];function Yt(t,e){if(1&t&&(p.hc(),p.Rb(0,"line",2)),2&t){var n=p.ic();p.Db("x1",n.tick.x)("x2",n.tick.x)("y2",n.marky2)}}function Xt(t,e){if(1&t&&(p.hc(),p.Wb(0,"text"),p.Gc(1),p.Vb()),2&t){var n=p.ic();p.Db("x",n.tick.x)("y",n.texty2)("dy",n.textdy),p.Cb(1),p.Hc(n.tick.label)}}var Ut=["bd2hm-num-x-axis",""];function Jt(t,e){1&t&&(p.hc(),p.Rb(0,"g",3)),2&t&&p.oc("tick",e.$implicit)}var te,ee,ne,ie,ae,re,oe,se,ce,le,he,ue,fe,ge,pe,de,be,me,ye=function t(){_classCallCheck(this,t),this.vMargin=25,this.hMargin=20,this.smallRowWidth=6,this.midRowWidth=12,this.bigRowWidth=25,this.rowGap=.05},ve=function t(){_classCallCheck(this,t)},xe=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];_classCallCheck(this,t),this.x=e,this.y=n,this.label=i,this.top=a,this.left=r},ke=function t(e,n,i,a){_classCallCheck(this,t),this.x=e,this.y=n,this.left=i,this.right=a,this.width=a-i},we=function t(){_classCallCheck(this,t)},Ce=((te=function(){function t(){_classCallCheck(this,t),this.request$=new z.a}return _createClass(t,[{key:"showTooltip",value:function(t,e,n){this.request$.next([!0,t,e,n])}},{key:"hideTooltip",value:function(t,e){this.request$.next([!1,void 0,t,e])}},{key:"ngOnDestroy",value:function(){this.request$.complete()}}]),t}()).\u0275fac=function(t){return new(t||te)},te.\u0275prov=p.Mb({token:te,factory:te.\u0275fac}),te),Se=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"seriesToBoxes",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.map((function(t){return e.serieToBoxes(t,n)}))}},{key:"serieToBoxes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object.assign(new we,t);return n.data=e?this.pointsToAsymBoxes(t.data):this.pointsToSymBoxes(t.data),n}},{key:"pointsToAsymBoxes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(!t||0===t.length)return[];if(1===t.length){var n=t[0];return[new ke(n.x,n.y,n.x-e,n.x+e)]}var i=[],a=t[0];i.push(new ke(a.x,a.y,(3*a.x-t[1].x)/2,(a.x+t[1].x)/2));for(var r=1;r<t.length-1;r++)i.push(this.asymBoxFromPoints(t[r],t[r-1],t[r+1]));var o=t[t.length-1];return i.push(new ke(o.x,o.y,(t[t.length-2].x+o.x)/2,(3*o.x-t[t.length-2].x)/2)),i}},{key:"asymBoxFromPoints",value:function(t,e,n){return new ke(t.x,t.y,(e.x+t.x)/2,(t.x+n.x)/2)}},{key:"pointsToSymBoxes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(!t||0===t.length)return[];if(1===t.length){var n=t[0];return[new ke(n.x,n.y,n.x-e,n.x+e)]}var i=[],a=t[0];i.push(new ke(a.x,a.y,(3*a.x-t[1].x)/2,(a.x+t[1].x)/2));for(var r=1;r<t.length-1;r++)i.push(this.symBoxFromPoints(t[r],t[r-1],t[r+1]));var o=t[t.length-1];return i.push(new ke(o.x,o.y,(t[t.length-2].x+o.x)/2,(3*o.x-t[t.length-2].x)/2)),i}},{key:"symBoxFromPoints",value:function(t,e,n){var i=Math.min(t.x-e.x,n.x-t.x)/2;return new ke(t.x,t.y,t.x-i,t.x+i)}}]),t}(),Oe=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"prepareGraphicContext",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new ve;return this.calculateDimensions(i,t,e),this.addPaneAttributes(i,e),this.addScales(i,t,e,n),this.addFormatters(i,t),i.labelsColors=this.labelsColors(t),i}},{key:"calculateDimensions",value:function(t,e,n){t.pWidth=500,t.workspaceWidth=t.pWidth-3*n.hMargin,t.workspaceHeight=this.calculateWorkspaceHeight(e,n),t.pHeight=t.workspaceHeight+2*n.vMargin}},{key:"calculateWorkspaceHeight",value:function(t,e){return t.length<=25?t.length*e.bigRowWidth:t.length<=100?t.length*e.midRowWidth:t.length*e.smallRowWidth}},{key:"addPaneAttributes",value:function(t,e){t.viewBox="0 0 500 "+t.pHeight,t.mainPaneTransform="translate(".concat(2*e.hMargin,", ").concat(e.vMargin,")")}},{key:"addScales",value:function(t,e,n,i){var a=this.timeDomain(e);t.xDomain=a;var r=this.timeMargin(e,a);a=[a[0]-r,a[1]+r],t.xScale=vt().clamp(!0).domain(a).range([0,t.workspaceWidth]);var o=e.map((function(t){return t.key}));t.yDomain=o,t.yScale=function t(){var e,n,i=wt().unknown(void 0),a=i.domain,r=i.range,o=0,s=1,c=!1,l=0,h=0,u=.5;function f(){var t=a().length,i=s<o,f=i?s:o,g=i?o:s;e=(g-f)/Math.max(1,t-l+2*h),c&&(e=Math.floor(e)),f+=(g-f-e*(t-l))*u,n=e*(1-l),c&&(f=Math.round(f),n=Math.round(n));var p=xt(t).map((function(t){return f+e*t}));return r(i?p.reverse():p)}return delete i.unknown,i.domain=function(t){return arguments.length?(a(t),f()):a()},i.range=function(t){var e;return arguments.length?(e=_slicedToArray(t,2),o=e[0],s=e[1],o=+o,s=+s,f()):[o,s]},i.rangeRound=function(t){var e;return e=_slicedToArray(t,2),o=e[0],s=e[1],o=+o,s=+s,c=!0,f()},i.bandwidth=function(){return n},i.step=function(){return e},i.round=function(t){return arguments.length?(c=!!t,f()):c},i.padding=function(t){return arguments.length?(l=Math.min(1,h=+t),f()):l},i.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),f()):l},i.paddingOuter=function(t){return arguments.length?(h=+t,f()):h},i.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),f()):u},i.copy=function(){return t(a(),[o,s]).round(c).paddingInner(l).paddingOuter(h).align(u)},it.apply(f(),arguments)}().paddingInner(n.rowGap).paddingOuter(0).domain(o).range([0,t.workspaceHeight]),t.colorScale=this.heatmapScale(e,i)}},{key:"addFormatters",value:function(t,e){var n=this.timeDomain(e);t.domainFormatter=this.formatForDomain(n);var i=this.valuesRange(e);t.valuesFormatter=this.formatForDomain(i)}},{key:"timeMargin",value:function(t,e){var n=e[0],i=.5;return t.filter((function(t){return t.data&&t.data.length>0&&t.data[0].x===n})).forEach((function(t){var e=t.data[0];e instanceof ke&&(i=Math.max(i,e.x-e.left))})),i}},{key:"timeDomain",value:function(t){var e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.forEach((function(t){t.data&&t.data.length>0&&(e=Math.min(e,t.data[0].x),n=Math.max(n,t.data[t.data.length-1].x))})),e=isFinite(e)?e:0,n=isFinite(n)?n:1,[e,n]}},{key:"heatmapScale",value:function(t,e){var n=this.valuesRange(t);if(e){var i=Math.max(Math.abs(n[0]),Math.abs(n[1]));n=[-i,i]}var a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#d62728",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"white",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#1f77b4",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1,a=vt().domain([-1,0,1]).range([Object(Ct.g)(t),Object(Ct.g)(e),Object(Ct.g)(n)]);return xt(-1,1+i,i).map((function(t){return Object(Ct.g)(a(t)).hex()}))}();return function t(){var e,n=0,i=1,a=1,r=[.5],o=[0,1];function s(t){return t<=t?o[$(r,t,0,a)]:e}function c(){var t=-1;for(r=new Array(a);++t<a;)r[t]=((t+1)*i-(t-a)*n)/(a+1);return s}return s.domain=function(t){var e;return arguments.length?(e=_slicedToArray(t,2),n=e[0],i=e[1],n=+n,i=+i,c()):[n,i]},s.range=function(t){return arguments.length?(a=(o=Array.from(t)).length-1,c()):o.slice()},s.invertExtent=function(t){var e=o.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,r[0]]:e>=a?[r[a-1],i]:[r[e-1],r[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return r.slice()},s.copy=function(){return t().domain([n,i]).range(o).unknown(e)},it.apply(yt(s),arguments)}().domain(n).range(a)}},{key:"valuesRange",value:function(t){if(0===t.length)return[NaN,NaN];var e=t[0].min,n=t[0].max;return t.forEach((function(t){e=Math.min(e,t.min),n=Math.max(n,t.max)})),[e,n]}},{key:"formatForDomain",value:function(t){var e=_slicedToArray(t,2),n=e[0],i=e[1]-n;return lt(i<1?".2~e":i<100?".2~f":i<1e5?"d":".2~e")}},{key:"labelsColors",value:function(t){var e=t.length;return function(t){return Object(St.a)(t/e)}}}]),t}(),Me=((me=function(){function t(e,n){_classCallCheck(this,t),this.changeDetector=e,this.tooltip=n,this.asymmetric=!1,this.middleZero=!1,this.hidden=!1,this.labelsAlwaysOn=!0,this.lookAndFeel=new ye,this.heatmapDataUtil=new Se,this.heatmapGraphUtil=new Oe}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.tooltip&&this.tooltip.ngOnDestroy()}},{key:"ngOnChanges",value:function(t){this.data&&this.data.length>0?(this.series=this.heatmapDataUtil.seriesToBoxes(this.data,this.asymmetric),this.graphic=this.heatmapGraphUtil.prepareGraphicContext(this.series,this.lookAndFeel,this.middleZero)):(this.graphic=void 0,this.series=void 0)}}]),t}()).\u0275fac=function(t){return new(t||me)(p.Qb(p.h),p.Qb(Ce))},me.\u0275cmp=p.Kb({type:me,selectors:[["bd2-num-heatmap"]],inputs:{asymmetric:"asymmetric",middleZero:"middleZero",hidden:"hidden",labelsAlwaysOn:"labelsAlwaysOn",lookAndFeel:"lookAndFeel",data:"data"},features:[p.Bb([Ce]),p.Ab],decls:2,vars:2,consts:[[1,"bd2hm-heatmap",3,"hidden"],["width","100%",4,"ngIf"],["width","100%"],["id","bd2hm-shadow"],["dx","1","dy","1","stdDeviation","1"],["id","bd2hm-pattern-diagonal","width","10","height","10","patternTransform","rotate(45 0 0)","patternUnits","userSpaceOnUse"],["x1","0","y1","0","x2","0","y2","10",2,"stroke","lightgrey","stroke-width","1"],[1,"bd2hm-mainPane"],["bd2hm-pane-back","",1,"bd2hm-paneBack",3,"graphic"],["bd2hm-axis-box","",3,"graphic"],["bd2hm-series-box","",1,"bd2hm-seriesBox",3,"graphic","series"],["bd2hm-labels","",3,"graphic","data","alwaysOn"],["bd2hm-tooltip","",3,"graphic"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Ec(1,_t,12,10,"svg",1),p.Vb()),2&t&&(p.oc("hidden",e.hidden),p.Cb(1),p.oc("ngIf",e.graphic))},directives:function(){return[i.m,Ve,Te,De,Pe,_e]},styles:[".bd2hm-paneBack rect{fill:url(#bd2hm-pattern-diagonal)}  .bd2hm-axisWrapper line{stroke:grey}  .bd2hm-axisWrapper text{fill:grey;text-anchor:middle;font-size:9px}  .bd2hm-labels text.bd2hm-onLabel{dominant-baseline:central;fill:#000;opacity:.6}  .bd2hm-labels .bd2hm-hover text{dominant-baseline:central;fill:#fff;font-size:10px}  .bd2hm-labels .bd2hm-hover rect{fill:#000;opacity:.8;-webkit-filter:url(#bd2hm-shadow);filter:url(#bd2hm-shadow)}  .bd2hm-tooltipBox text{font-size:10px;fill:#fff}  .bd2hm-tooltipBox rect{fill:#000;opacity:.8;-webkit-filter:url(#bd2hm-shadow);filter:url(#bd2hm-shadow)}"],changeDetection:0}),me),_e=((be=function(){function t(e,n){_classCallCheck(this,t),this.tooltip=e,this.changeDetector=n,this.boxMargin=4,this.show=!1,this.ready=!1}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.subscription=this.tooltip.request$.pipe(Object(c.a)(100)).subscribe((function(e){return t.handleRequest(e)}))}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"handleRequest",value:function(t){var e=_slicedToArray(t,4),n=e[0],i=e[1],a=e[2],r=e[3];n?this.showTooltip(i,a,r):this.hideTooltip(a,r)}},{key:"showTooltip",value:function(t,e,n){var i=this;this.ready=!1,this.label=this.formatLabel(t),this.values=this.formatValues(e),this.show=!0,this.changeDetector.detectChanges(),this.updateTextBBox().subscribe((function(t){i.show&&(i.position=i.translateToDataLocation(n,i.textBWidth,i.graphic.workspaceWidth),i.ready=!0),i.changeDetector.detectChanges()}))}},{key:"translateToDataLocation",value:function(t,e,n){var i=t.x+t.width+2*this.boxMargin;return i+e>=n&&(i=t.x-e),"translate(".concat(i,", ").concat(t.y,")")}},{key:"hideTooltip",value:function(t,e){this.show=!1,this.changeDetector.detectChanges()}},{key:"formatValues",value:function(t){return"".concat(this.graphic.domainFormatter(t.x)," : ").concat(this.graphic.valuesFormatter(t.y))}},{key:"updateTextBBox",value:function(){var t=this;return Object(R.a)(0).pipe(Object(Ot.a)((function(e){return t.textBBox()})),Object(Mt.a)((function(e){return t.setTextBBox(e)})))}},{key:"setTextBBox",value:function(t){this.textBX=t.x-this.boxMargin,this.textBY=t.y-this.boxMargin,this.textBHeight=t.height+2*this.boxMargin,this.textBWidth=t.width+2*this.boxMargin}},{key:"textBBox",value:function(){return this.textNode?this.textNode.nativeElement.getBBox():{x:0,y:0,height:0,width:0}}},{key:"formatLabel",value:function(t){return t?t.length<40?t:t.substring(0,38)+"...":""}}]),t}()).\u0275fac=function(t){return new(t||be)(p.Qb(Ce),p.Qb(p.h))},be.\u0275cmp=p.Kb({type:be,selectors:[["","bd2hm-tooltip",""]],viewQuery:function(t,e){var n;1&t&&p.Mc(Pt,!0),2&t&&p.uc(n=p.fc())&&(e.textNode=n.first)},inputs:{boxMargin:"boxMargin",graphic:"graphic"},attrs:Wt,decls:1,vars:1,consts:[["class","bd2hm-tooltipBox",4,"ngIf"],[1,"bd2hm-tooltipBox"],["text",""],["x","0"],["x","0","dy","1.2em"]],template:function(t,e){1&t&&p.Ec(0,It,9,9,"g",0),2&t&&p.oc("ngIf",e.graphic)},directives:[i.m],encapsulation:2,changeDetection:0}),be),Pe=((de=function(){function t(){_classCallCheck(this,t),this.alwaysOn=!0}return _createClass(t,[{key:"trackByIndex",value:function(t,e){return t}},{key:"ngOnInit",value:function(){}},{key:"yStart",value:function(t){return this.graphic.yScale(t.key)}},{key:"maxHeight",value:function(){return this.graphic.yScale.bandwidth()}},{key:"color",value:function(t){return this.graphic.labelsColors(t)}}]),t}()).\u0275fac=function(t){return new(t||de)},de.\u0275cmp=p.Kb({type:de,selectors:[["","bd2hm-labels",""]],inputs:{alwaysOn:"alwaysOn",graphic:"graphic",data:"data"},attrs:Bt,decls:1,vars:1,consts:[["class","bd2hm-labels",4,"ngIf"],[1,"bd2hm-labels"],["bd2hm-label-box","",3,"serie","yStart","maxHeight","alwaysOn",4,"ngFor","ngForOf","ngForTrackBy"],["bd2hm-label-box","",3,"serie","yStart","maxHeight","alwaysOn"]],template:function(t,e){1&t&&p.Ec(0,Vt,2,2,"g",0),2&t&&p.oc("ngIf",e.graphic&&e.data)},directives:function(){return[i.m,i.l,We]},encapsulation:2,changeDetection:0}),de),We=((pe=function(){function t(e){_classCallCheck(this,t),this.changeDetector=e,this.alwaysOn=!0,this.color="rgb(67, 125, 179)",this.textBWidth=0,this.textBY=0,this.toggled=!1,this.ready=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){this.margin=this.marginSize(),this.triggerY=this.yStart+this.margin,this.triggerHeight=this.margin>1?this.maxHeight-2*this.margin:this.maxHeight-1,this.yMiddle=this.yStart+this.maxHeight/2}},{key:"marginSize",value:function(){return this.maxHeight>=20?4:this.maxHeight>=12?2:1}},{key:"fontSize",value:function(){return this.maxHeight>12?10:this.maxHeight>=6?this.maxHeight-3:0}},{key:"toggleLabel",value:function(t){var e=this;void 0===t&&(t=!this.toggled),this.ready=!1,this.toggled=t,this.toggled&&this.updateTextBBox().subscribe((function(t){e.toggled&&(e.ready=!0),e.changeDetector.markForCheck()}))}},{key:"updateTextBBox",value:function(){var t=this;return Object(R.a)(0).pipe(Object(Ot.a)((function(e){return t.textBBox()})),Object(Mt.a)((function(e){return t.setTextBBox(e)})))}},{key:"setTextBBox",value:function(t){this.textBY=t.y-4,this.textBHeight=t.height+8,this.textBWidth=t.x+t.width+4}},{key:"textBBox",value:function(){return this.textNode?this.textNode.nativeElement.getBBox():{x:0,y:0,height:0,width:0}}}]),t}()).\u0275fac=function(t){return new(t||pe)(p.Qb(p.h))},pe.\u0275cmp=p.Kb({type:pe,selectors:[["","bd2hm-label-box",""]],viewQuery:function(t,e){var n;1&t&&p.Mc(Pt,!0),2&t&&p.uc(n=p.fc())&&(e.textNode=n.first)},inputs:{alwaysOn:"alwaysOn",color:"color",serie:"serie",yStart:"yStart",maxHeight:"maxHeight"},features:[p.Ab],attrs:Tt,decls:1,vars:1,consts:[["class","bd2hm-label",4,"ngIf"],[1,"bd2hm-label"],["x","5","class","bd2hm-onLabel",4,"ngIf"],[3,"mouseout","mouseover"],["x","-7","width","7"],[1,"bd2hm-hover"],["x","0"],["x","5"],["text",""],["x","5",1,"bd2hm-onLabel"]],template:function(t,e){1&t&&p.Ec(0,zt,9,11,"g",0),2&t&&p.oc("ngIf",e.serie)},directives:[i.m],encapsulation:2,changeDetection:0}),pe),Ie=((ge=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"trackByIndex",value:function(t,e){return t}},{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){this.graphic&&this.serie&&(this.yPosition=this.graphic.yScale(this.serie.key),this.yHeight=this.graphic.yScale.bandwidth())}}]),t}()).\u0275fac=function(t){return new(t||ge)},ge.\u0275cmp=p.Kb({type:ge,selectors:[["","bd2hm-serie-row",""]],inputs:{graphic:"graphic",serie:"serie"},features:[p.Ab],attrs:Rt,decls:1,vars:1,consts:[["class","bd2hm-serie",4,"ngIf"],[1,"bd2hm-serie"],["bd2hm-data-point-box","",3,"point","xScale","yPosition","yHeight","colorScale","label",4,"ngFor","ngForOf","ngForTrackBy"],["bd2hm-data-point-box","",3,"point","xScale","yPosition","yHeight","colorScale","label"]],template:function(t,e){1&t&&p.Ec(0,Et,2,2,"g",0),2&t&&p.oc("ngIf",e.graphic&&e.serie)},directives:function(){return[i.m,i.l,Be]},encapsulation:2,changeDetection:0}),ge),Be=((fe=function(){function t(e,n){_classCallCheck(this,t),this.tooltip=e,this.zone=n}return _createClass(t,[{key:"ngOnChanges",value:function(t){if(this.xScale&&this.point){this.xPosition=this.xScale(this.point.left);var e=this.xScale(this.point.right)-this.xScale(this.point.left);this.xWidth=e>=2?e-1:1}}},{key:"ngAfterViewInit",value:function(){var t=this;this.boxNode&&this.prevBoxNode!==this.boxNode&&(this.removeMouseListeners(this.prevBoxNode),this.zone.runOutsideAngular((function(){t.addMouseListeners(t.boxNode)})),this.prevBoxNode=this.boxNode)}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.removeMouseListeners(this.boxNode)}},{key:"addMouseListeners",value:function(t){t&&(t.nativeElement.addEventListener("mouseover",this.showTooltip.bind(this)),t.nativeElement.addEventListener("mouseout",this.hideTooltip.bind(this)))}},{key:"removeMouseListeners",value:function(t){t&&(t.nativeElement.removeEventListener("mouseover",this.showTooltip),t.nativeElement.removeEventListener("mouseout",this.hideTooltip))}},{key:"hideTooltip",value:function(t){this.tooltip.hideTooltip(this.point,{x:this.xPosition,y:this.yPosition,width:this.xWidth})}},{key:"showTooltip",value:function(t){this.tooltip.showTooltip(this.label,this.point,{x:this.xPosition,y:this.yPosition,width:this.xWidth})}}]),t}()).\u0275fac=function(t){return new(t||fe)(p.Qb(Ce),p.Qb(p.A))},fe.\u0275cmp=p.Kb({type:fe,selectors:[["","bd2hm-data-point-box",""]],viewQuery:function(t,e){var n;1&t&&p.Mc(Ft,!0),2&t&&p.uc(n=p.fc())&&(e.boxNode=n.first)},inputs:{point:"point",yPosition:"yPosition",yHeight:"yHeight",xScale:"xScale",colorScale:"colorScale",label:"label"},features:[p.Ab],attrs:Ht,decls:1,vars:1,consts:[[4,"ngIf"],["box",""]],template:function(t,e){1&t&&p.Ec(0,jt,2,6,"rect",0),2&t&&p.oc("ngIf",e.point&&e.xScale)},directives:[i.m],encapsulation:2,changeDetection:0}),fe),De=((ue=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"trackByIndex",value:function(t,e){return t}},{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||ue)},ue.\u0275cmp=p.Kb({type:ue,selectors:[["","bd2hm-series-box",""]],inputs:{series:"series",graphic:"graphic"},attrs:Gt,decls:1,vars:2,consts:[["bd2hm-serie-row","",3,"graphic","serie",4,"ngFor","ngForOf","ngForTrackBy"],["bd2hm-serie-row","",3,"graphic","serie"]],template:function(t,e){1&t&&p.Ec(0,Lt,1,2,"g",0),2&t&&p.oc("ngForOf",e.series)("ngForTrackBy",e.trackByIndex)},directives:[i.l,Ie],encapsulation:2,changeDetection:0}),ue),Ve=((he=function(){function t(){_classCallCheck(this,t),this.margin=2}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){this.width=this.graphic.workspaceWidth-2*this.margin,this.height=this.graphic.workspaceHeight-2*this.margin,this.width<0&&(this.width=0),this.height<0&&(this.height=0)}}]),t}()).\u0275fac=function(t){return new(t||he)},he.\u0275cmp=p.Kb({type:he,selectors:[["","bd2hm-pane-back",""]],inputs:{margin:"margin",graphic:"graphic"},features:[p.Ab],attrs:$t,decls:1,vars:4,consts:[[1,"bd2hm-dataBackground"]],template:function(t,e){1&t&&(p.hc(),p.Rb(0,"rect",0)),2&t&&p.Db("x",e.margin)("y",e.margin)("width",e.width)("height",e.height)},encapsulation:2,changeDetection:0}),he),Te=((le=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||le)},le.\u0275cmp=p.Kb({type:le,selectors:[["","bd2hm-axis-box",""]],inputs:{graphic:"graphic"},attrs:qt,decls:1,vars:1,consts:[["class","bd2hm-axisWrapper",4,"ngIf"],[1,"bd2hm-axisWrapper"],["bd2hm-num-x-axis","",1,"xTopAxis",3,"top","xScale","yPosition","xDomain"],["bd2hm-num-x-axis","",1,"xBottomAxis",3,"top","xScale","yPosition","xDomain"],["bd2hm-y-axis","",1,"yLeftAxis",3,"left","yScale","xPosition"],["bd2hm-y-axis","",1,"yRightAxis",3,"left","yScale","xPosition"]],template:function(t,e){1&t&&p.Ec(0,Kt,5,14,"g",0),2&t&&p.oc("ngIf",e.graphic)},directives:function(){return[i.m,Re,Ne]},encapsulation:2,changeDetection:0}),le),Ne=((ce=function(){function t(){_classCallCheck(this,t),this.left=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){var e;this.axisTransform="translate(".concat(this.xPosition,",0)"),this.y2=null===(e=this.yScale)||void 0===e?void 0:e.range()[1]}}]),t}()).\u0275fac=function(t){return new(t||ce)},ce.\u0275cmp=p.Kb({type:ce,selectors:[["","bd2hm-y-axis",""]],inputs:{left:"left",yScale:"yScale",xPosition:"xPosition"},features:[p.Ab],attrs:Qt,decls:2,vars:2,consts:[[1,"bd2hm-y-axis"],["x1","0","y1","0","x2","0"]],template:function(t,e){1&t&&(p.hc(),p.Wb(0,"g",0),p.Rb(1,"line",1),p.Vb()),2&t&&(p.Db("transform",e.axisTransform),p.Cb(1),p.Db("y2",e.y2))},encapsulation:2,changeDetection:0}),ce),ze=((se=function(){function t(){_classCallCheck(this,t),this.length=5}return _createClass(t,[{key:"ngOnInit",value:function(){this.calculatePositions()}},{key:"ngOnChanges",value:function(t){this.calculatePositions()}},{key:"calculatePositions",value:function(){var t,e,n;this.marky2=(null===(t=this.tick)||void 0===t?void 0:t.top)?-this.length:this.length,this.texty2=(null===(e=this.tick)||void 0===e?void 0:e.top)?-(this.length+4):this.length+4,this.textdy=(null===(n=this.tick)||void 0===n?void 0:n.top)?0:"0.6em"}}]),t}()).\u0275fac=function(t){return new(t||se)},se.\u0275cmp=p.Kb({type:se,selectors:[["","bd2hm-vtick-mark",""]],inputs:{length:"length",tick:"tick"},features:[p.Ab],attrs:Zt,decls:2,vars:2,consts:[["y1","0",4,"ngIf"],[4,"ngIf"],["y1","0"]],template:function(t,e){1&t&&(p.Ec(0,Yt,1,3,"line",0),p.Ec(1,Xt,2,4,"text",1)),2&t&&(p.oc("ngIf",e.tick),p.Cb(1),p.oc("ngIf",e.tick))},directives:[i.m],encapsulation:2}),se),Re=((oe=function(){function t(){_classCallCheck(this,t),this.top=!1,this.ticks=[]}return _createClass(t,[{key:"trackByIndex",value:function(t,e){return t}},{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){var e;this.axisTransform="translate(0,".concat(this.yPosition,")"),this.x2=null===(e=this.xScale)||void 0===e?void 0:e.range()[1],this.ticks=this.prepareTicks(this.xScale)}},{key:"prepareTicks",value:function(t){var e=this;return this.calculateTicksPosition(t).map((function(n){return new xe(t(n),0,n,e.top,!1)}))}},{key:"calculateTicksPosition",value:function(t){if(!t)return[];for(var e=[],n=this.xDomain||t.domain(),i=Math.round(n[0]),a=Math.round(n[1]),r=this.domainStep(a-i),o=i;o<=a;o+=r)e.push(o);return e}},{key:"domainStep",value:function(t){return t<=25?4:t<=73?6:t<=169?12:24}}]),t}()).\u0275fac=function(t){return new(t||oe)},oe.\u0275cmp=p.Kb({type:oe,selectors:[["","bd2hm-num-x-axis",""]],inputs:{top:"top",xScale:"xScale",xDomain:"xDomain",yPosition:"yPosition"},features:[p.Ab],attrs:Ut,decls:3,vars:4,consts:[[1,"bd2hm-x-axis"],["x1","0","y1","0","y2","0"],["bd2hm-vtick-mark","","class","bd2hm-tickMark",3,"tick",4,"ngFor","ngForOf","ngForTrackBy"],["bd2hm-vtick-mark","",1,"bd2hm-tickMark",3,"tick"]],template:function(t,e){1&t&&(p.hc(),p.Wb(0,"g",0),p.Rb(1,"line",1),p.Ec(2,Jt,1,1,"g",2),p.Vb()),2&t&&(p.Db("transform",e.axisTransform),p.Cb(1),p.Db("x2",e.x2),p.Cb(1),p.oc("ngForOf",e.ticks)("ngForTrackBy",e.trackByIndex))},directives:[i.l,ze],encapsulation:2,changeDetection:0}),oe),Ae=((re=function t(){_classCallCheck(this,t)}).\u0275mod=p.Ob({type:re}),re.\u0275inj=p.Nb({factory:function(t){return new(t||re)},imports:[[i.c]]}),re),Ee=((ae=function t(){_classCallCheck(this,t)}).\u0275mod=p.Ob({type:ae}),ae.\u0275inj=p.Nb({factory:function(t){return new(t||ae)},imports:[[i.c,Ae],Ae]}),ae),Fe=((ie=function t(){_classCallCheck(this,t)}).\u0275mod=p.Ob({type:ie}),ie.\u0275inj=p.Nb({factory:function(t){return new(t||ie)},imports:[[i.c,Ee]]}),ie),He=((ne=function t(){_classCallCheck(this,t)}).\u0275mod=p.Ob({type:ne}),ne.\u0275inj=p.Nb({factory:function(t){return new(t||ne)},imports:[[Fe]]}),ne),je=((ee=function(){function t(){_classCallCheck(this,t),this.middleZero=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"traces",set:function(t){this.series=t}}]),t}()).\u0275fac=function(t){return new(t||ee)},ee.\u0275cmp=p.Kb({type:ee,selectors:[["bd2-heatmap-plot"]],inputs:{traces:"traces",middleZero:"middleZero"},decls:2,vars:2,consts:[[2,"text-align","center"],[3,"data","middleZero"]],template:function(t,e){1&t&&(p.Wb(0,"div",0),p.Rb(1,"bd2-num-heatmap",1),p.Vb()),2&t&&(p.Cb(1),p.oc("data",e.series)("middleZero",e.middleZero))},directives:[Me],encapsulation:2}),ee);function Ge(t,e){if(1&t){var n=p.Xb();p.Wb(0,"div",6),p.Wb(1,"label",7),p.Wb(2,"a",8),p.ec("click",(function(){return p.xc(n),p.ic(2).exportDataView()})),p.Wb(3,"i",9),p.Gc(4,"save_alt"),p.Vb(),p.Wb(5,"span",10),p.Gc(6,"Download"),p.Vb(),p.Vb(),p.Gc(7," current view "),p.Vb(),p.Wb(8,"label",7),p.Wb(9,"a",11),p.ec("click",(function(){return p.xc(n),p.ic(2).exportFullData()})),p.Wb(10,"i",9),p.Gc(11,"save_alt"),p.Vb(),p.Wb(12,"span",10),p.Gc(13,"Download"),p.Vb(),p.Vb(),p.Gc(14," full "),p.Vb(),p.Vb()}}function Le(t,e){if(1&t&&p.Rb(0,"bd2-heatmap-plot",12),2&t){var n=p.ic(2);p.oc("traces",n.timeseries)("middleZero",n.middleZero)}}function $e(t,e){if(1&t){var n=p.Xb();p.Wb(0,"div"),p.Wb(1,"h3"),p.Gc(2,"Data heatmap"),p.Vb(),p.Rb(3,"hr"),p.Wb(4,"bd2-heatmap-display-params-rform",1),p.ec("displayParams",(function(t){return p.xc(n),p.ic().displayChanged(t)})),p.Vb(),p.Wb(5,"mat-expansion-panel"),p.Wb(6,"mat-expansion-panel-header"),p.Wb(7,"mat-panel-title"),p.Gc(8," Sorting "),p.Vb(),p.Vb(),p.Rb(9,"bd2-tssort-params-rform",2),p.jc(10,"async"),p.jc(11,"async"),p.Vb(),p.Rb(12,"hr"),p.Wb(13,"div",3),p.Ec(14,Ge,15,0,"div",4),p.Vb(),p.Rb(15,"hr"),p.Ec(16,Le,1,2,"bd2-heatmap-plot",5),p.Vb()}if(2&t){var i=p.ic();p.Cb(4),p.oc("disabled",i.disabledSecondary)("totalTraces",i.totalTraces)("currentPage",i.currentPage),p.Cb(5),p.oc("ppaJobs",p.kc(10,7,i.analysis.ppaJobs$))("rhythmJobs",p.kc(11,9,i.analysis.rhythmJobs$)),p.Cb(5),p.oc("ngIf",i.timeseries),p.Cb(2),p.oc("ngIf",i.timeseries)}}var qe,Ke,Qe,Ze=[{path:"",pathMatch:"full",component:(qe=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,a,r,o){var s;return _classCallCheck(this,n),(s=e.call(this,o)).analysis=t,s.fetcher=i,s.RDMSocial=a,s.analytics=r,s.timeseries=[],s.totalTraces=0,s.currentPage=l.a.firstPage(),s.tracesPerPlot=5,s.middleZero=!1,s.blocked=!1,s.disabledSecondary=!1,s.csvExporter=new f.a,t.allowedPPAMethods=["NLLS","MESA"],i.addTraceNr=!0,i.addTraceRef=!1,s.titlePart=" Data",s}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.timeSeriesSubsripction=this.fetcher.seriesPackStream.pipe(Object(c.a)(1e3)).subscribe((function(e){if(t.assay){var n=e.data;t.currentParams=e.params,t.middleZero=t.isRangeSimetrical(e.params),t.timeseries=n,t.tracesPerPlot=Math.max(5,n.length/20),t.totalTraces=e.totalTraces,t.currentPage=e.currentPage,t.analytics.experimentHeatmapView(t.assay.id)}}),(function(e){console.log("Error in TS subscription: "+e),t.feedback.error(e)})),this.fetcher.error$.subscribe((function(e){return t.feedback.error(e)}))}},{key:"ngOnDestroy",value:function(){this.timeSeriesSubsripction&&this.timeSeriesSubsripction.unsubscribe(),this.fetcher.ngOnDestroy(),_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this)}},{key:"displayChanged",value:function(t){this.fetcher.changeDisplayParams(t)}},{key:"exportDataView",value:function(){this.exportSeriesPack(this.fetcher.current)}},{key:"exportFullData",value:function(){var t=this;this.fetcher.getFullDataSet(this.assay,this.fetcher.current.params,this.fetcher.current.sorting).subscribe((function(e){t.exportSeriesPack(e,!0)}))}},{key:"exportSeriesPack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var n=this.csvExporter.renderCSVTable(t.data,t.params,t.currentPage,t.sorting,this.assay),i=new Blob([n],{type:"text/csv"});u.saveAs(i,"".concat(this.assay.id,"_data.").concat(t.params.detrending.name).concat(e?".full":".page"+(t.currentPage.pageIndex+1),".csv")),this.recordExport()}}},{key:"recordExport",value:function(){this.analytics.experimentDataExport(this.assay.id)}},{key:"updateModel",value:function(t){var e=this;_get(_getPrototypeOf(n.prototype),"updateModel",this).call(this,t),this.RDMSocial.canProceedByMeasurement(t).then((function(t){e.disabledSecondary=!t})),this.fetcher.experiment(t),this.analysis.experiment(t)}},{key:"isRangeSimetrical",value:function(t){return"RANGE"===t.normalisation||"Z_SCORE"===t.normalisation||"MEAN"===t.align}}]),n}(s.a),qe.\u0275fac=function(t){return new(t||qe)(p.Qb(g.a),p.Qb(h.a),p.Qb(d.a),p.Qb(b.a),p.Qb(m.a))},qe.\u0275cmp=p.Kb({type:qe,selectors:[["bd2-ts-heatmap-view"]],features:[p.Bb([h.a,g.a]),p.zb],decls:1,vars:1,consts:[[4,"ngIf"],[3,"disabled","totalTraces","currentPage","displayParams"],[3,"ppaJobs","rhythmJobs"],[1,"clearfix"],["class","float-right",4,"ngIf"],[3,"traces","middleZero",4,"ngIf"],[1,"float-right"],[1,"mr-4"],["download","","role","button","aria-label","download",1,"btn","btn-primary",2,"color","white",3,"click"],[1,"material-icons","bd-icon"],[1,"cdk-visually-hidden"],["download","","role","button","aria-label","download whole",1,"btn","btn-primary",2,"color","white",3,"click"],[3,"traces","middleZero"]],template:function(t,e){1&t&&p.Ec(0,$e,17,11,"div",0),2&t&&p.oc("ngIf",e.assay)},directives:[i.m,V,T.b,T.c,T.d,N.a,je],pipes:[i.b],encapsulation:2}),qe)}],Ye=((Ke=function t(){_classCallCheck(this,t)}).\u0275mod=p.Ob({type:Ke}),Ke.\u0275inj=p.Nb({factory:function(t){return new(t||Ke)},imports:[[o.f.forChild(Ze)],o.f]}),Ke),Xe=n("NFeN"),Ue=n("a6j2"),Je=((Qe=function t(){_classCallCheck(this,t)}).\u0275mod=p.Ob({type:Qe}),Qe.\u0275inj=p.Nb({factory:function(t){return new(t||Qe)},imports:[[i.c,a.x,a.j,r.c,Xe.b,w.b,x.b,T.a,He,Ue.a,Ye]]}),Qe)}}]);