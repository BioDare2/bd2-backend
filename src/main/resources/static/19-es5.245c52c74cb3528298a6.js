!function(){function t(e,i,n){return(t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(n){var a=Object.getOwnPropertyDescriptor(n,e);return a.get?a.get.call(i):a.value}})(e,i,n||e)}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,a=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(c){a=!0,r=c}finally{try{n||null==s.return||s.return()}finally{if(a)throw r}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function r(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=s(t);if(e){var a=s(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return o(this,i)}}function o(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,i){return e&&l(t.prototype,e),i&&l(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{QftV:function(i,a,o){"use strict";o.r(a),o.d(a,"TsHeatmapModule",(function(){return Te}));var l=o("ofXK"),u=o("3Pt+"),b=o("M9IT"),d=o("tyNb"),g=o("yYXI"),p=o("Kj3r"),f=o("bngM"),m=o("QBpm"),y=o("Iab2"),v=o("e8YO"),x=o("K5d1"),S=o("fXoL"),k=o("vejM"),O=o("ZMwR"),w=o("GVyA"),B=o("wcxA"),T=o("Tl2h"),P=o("1jcm"),D=o("8LU1"),j=o("bTqV");function I(t,e){if(1&t&&(S.Tb(0,"option",16),S.Dc(1),S.Sb()),2&t){var i=e.$implicit;S.jc("value",i),S.Bb(1),S.Fc(" ",i,"")}}function z(t,e){if(1&t){var i=S.Ub();S.Tb(0,"div"),S.Tb(1,"select",14),S.Zb("ngModelChange",(function(t){return S.sc(i),S.dc()._changePageSize(t)})),S.Bc(2,I,2,2,"option",15),S.Sb(),S.Sb()}if(2&t){var n=S.dc();S.Bb(1),S.jc("ngModel",n.pageSize),S.Bb(1),S.jc("ngForOf",n._displayedPageSizeOptions)}}function M(t,e){if(1&t&&(S.Tb(0,"div",17),S.Dc(1),S.Sb()),2&t){var i=S.dc();S.Bb(1),S.Fc("",i.pageSize," ")}}var C,N=((C=function(){function t(e){c(this,t),this._changeDetectorRef=e,this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this.disabled=!1,this.page=new S.o,this.getRangeLabel=function(t,e,i){if(0==i||0==e)return"0 of "+i;var n=t*e;return"".concat(n+1," \u2013 ").concat(n<(i=Math.max(i,0))?Math.min(n+e,i):n+e," of ").concat(i)}}return h(t,[{key:"ngOnInit",value:function(){this._updateDisplayedPageSizeOptions()}},{key:"nextPage",value:function(){if(this.hasNextPage()){var t=this.pageIndex;this.pageIndex++,this._emitPageEvent(t)}}},{key:"previousPage",value:function(){if(this.hasPreviousPage()){var t=this.pageIndex;this.pageIndex--,this._emitPageEvent(t)}}},{key:"hasPreviousPage",value:function(){return this.pageIndex>=1&&0!=this.pageSize}},{key:"hasNextPage",value:function(){var t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}},{key:"getNumberOfPages",value:function(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}},{key:"_nextButtonsDisabled",value:function(){return this.disabled||!this.hasNextPage()}},{key:"_previousButtonsDisabled",value:function(){return this.disabled||!this.hasPreviousPage()}},{key:"_updateDisplayedPageSizeOptions",value:function(){this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((function(t,e){return t-e})),this._changeDetectorRef.markForCheck()}},{key:"_changePageSize",value:function(t){var e=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(e)}},{key:"_emitPageEvent",value:function(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}},{key:"pageIndex",get:function(){return this._pageIndex},set:function(t){this._pageIndex=Math.max(Object(D.f)(t),0),this._changeDetectorRef.markForCheck()}},{key:"length",get:function(){return this._length},set:function(t){this._length=Object(D.f)(t),this._changeDetectorRef.markForCheck()}},{key:"pageSize",get:function(){return this._pageSize},set:function(t){this._pageSize=Math.max(Object(D.f)(t),0),this._updateDisplayedPageSizeOptions()}},{key:"pageSizeOptions",get:function(){return this._pageSizeOptions},set:function(t){this._pageSizeOptions=(t||[]).map((function(t){return Object(D.f)(t)})),this._updateDisplayedPageSizeOptions()}}]),t}()).\u0275fac=function(t){return new(t||C)(S.Nb(S.h))},C.\u0275cmp=S.Hb({type:C,selectors:[["bd2-simple-paginator"]],inputs:{pageIndex:"pageIndex",length:"length",pageSize:"pageSize",pageSizeOptions:"pageSizeOptions",disabled:"disabled"},outputs:{page:"page"},decls:17,vars:7,consts:[[1,"mat-paginator"],[1,"mat-paginator-outer-container"],[1,"mat-paginator-container"],[1,"mat-paginator-page-size"],[1,"mat-paginator-page-size-label"],[4,"ngIf"],["class","mat-paginator-page-size-value",4,"ngIf"],[1,"mat-paginator-range-actions"],[1,"mat-paginator-range-label"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-previous",3,"disabled","click"],["viewBox","0 0 24 24","focusable","false",1,"mat-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-paginator-navigation-next",3,"disabled","click"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["required","",1,"mat-paginator-page-size-select",2,"font-size","12px",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-paginator-page-size-value"]],template:function(t,e){1&t&&(S.Tb(0,"div",0),S.Tb(1,"div",1),S.Tb(2,"div",2),S.Tb(3,"div",3),S.Tb(4,"div",4),S.Dc(5," Items per page: "),S.Sb(),S.Bc(6,z,3,2,"div",5),S.Bc(7,M,2,1,"div",6),S.Sb(),S.Tb(8,"div",7),S.Tb(9,"div",8),S.Dc(10),S.Sb(),S.Tb(11,"button",9),S.Zb("click",(function(){return e.previousPage()})),S.cc(),S.Tb(12,"svg",10),S.Ob(13,"path",11),S.Sb(),S.Sb(),S.bc(),S.Tb(14,"button",12),S.Zb("click",(function(){return e.nextPage()})),S.cc(),S.Tb(15,"svg",10),S.Ob(16,"path",13),S.Sb(),S.Sb(),S.Sb(),S.Sb(),S.Sb(),S.Sb()),2&t&&(S.Bb(6),S.jc("ngIf",e._displayedPageSizeOptions.length>1),S.Bb(1),S.jc("ngIf",e._displayedPageSizeOptions.length<=1),S.Bb(3),S.Fc(" ",e.getRangeLabel(e.pageIndex,e.pageSize,e.length)," "),S.Bb(1),S.jc("disabled",e._previousButtonsDisabled()),S.Cb("aria-label","previous page"),S.Bb(3),S.jc("disabled",e._nextButtonsDisabled()),S.Cb("aria-label","next page"))},directives:[l.m,j.a,u.A,u.z,u.q,u.t,l.l,u.u,u.C],styles:[".mat-paginator-icon[_ngcontent-%COMP%] {\n        width: 28px;\n        fill: currentColor;\n\n      }\n\n      .mat-paginator-range-actions[_ngcontent-%COMP%] {\n        display: flex;\n        align-items: center;\n      }\n\n      .mat-paginator[_ngcontent-%COMP%] {\n        display: block;\n      }\n\n      .mat-paginator-outer-container[_ngcontent-%COMP%] {\n        display: flex;\n      }\n\n      .mat-paginator-container[_ngcontent-%COMP%] {\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        min-height: 56px;\n        padding: 0 8px;\n        flex-wrap: wrap-reverse;\n        width: 100%;\n      }\n\n      .mat-paginator-page-size[_ngcontent-%COMP%] {\n        display: flex;\n        align-items: baseline;\n        margin-right: 8px;\n      }\n\n      .mat-paginator-page-size-label[_ngcontent-%COMP%] {\n        margin: 0 4px;\n      }\n\n      .mat-paginator-page-size-select[_ngcontent-%COMP%] {\n        margin: 6px 4px 0 4px;\n        width: 70px;\n\n      }\n\n      .mat-paginator-range-label[_ngcontent-%COMP%] {\n        margin:  0 32px 0 24px;\n      }"],changeDetection:0}),C);function F(t,e){if(1&t&&(S.Tb(0,"option",28),S.Dc(1),S.Sb()),2&t){var i=e.$implicit;S.jc("value",i.name),S.Bb(1),S.Ec(i.label)}}function _(t,e){if(1&t&&(S.Tb(0,"option",28),S.Dc(1),S.Sb()),2&t){var i=e.$implicit;S.jc("value",i.name),S.Bb(1),S.Ec(i.label)}}function H(t,e){if(1&t&&(S.Tb(0,"option",28),S.Dc(1),S.Sb()),2&t){var i=e.$implicit;S.jc("value",i.name),S.Bb(1),S.Ec(i.label)}}var E,A=function(){return[10,25,50,100,200,500]},L=((E=function(t){n(i,t);var e=r(i);function i(t){var n;c(this,i),(n=e.call(this,t)).alignOptions=[new T.e("NONE","none"),new T.e("MEAN","mean")];var a=n.normalisationOptions.find((function(t){return"RANGE"===t.name}));return n.displayParamsForm.get("normalisation").setValue(null==a?void 0:a.name),n.displayParamsForm.get("hourly").setValue(!0),n}return i}(B.a)).\u0275fac=function(t){return new(t||E)(S.Nb(u.e))},E.\u0275cmp=S.Hb({type:E,selectors:[["bd2-heatmap-display-params-rform"]],inputs:{disabled:"disabled",totalTraces:"totalTraces",currentPage:"currentPage"},outputs:{displayParams:"displayParams"},features:[S.yb],decls:46,vars:10,consts:[["role","form",1,"form-horizontal","container",3,"formGroup"],[1,"row"],[1,"col-md-8","col-sm-10"],["formGroupName","timeScale",1,"form-group","row"],[1,"col-md-3","col-sm-3"],["for","timeStart",1,"col-md-1","col-sm-2"],["type","number","step","any","min","0","size","5","id","timeStart","required","","formControlName","timeStart",1,"form-control"],["for","timeEnd",1,"col-md-1","col-sm-1"],["type","number","step","any","min","0","size","5","required","","id","timeEnd","formControlName","timeEnd",1,"form-control"],[1,"col-md-2","col-sm-4"],["formControlName","hourly",1,"mr-3"],[1,"form-group","row"],["for","detrending",1,"col-sm-2"],[1,"col-sm-3"],["required","","id","detrending","formControlName","detrending",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-1"],["for","align",1,"col-sm-1"],["required","","id","align","formControlName","align",1,"form-control"],[1,"col-sm-2"],["for","normalisation"],["required","","id","normalisation","formControlName","normalisation",1,"form-control"],[1,"col-sm"],["formControlName","trimFirst",1,"mr-3"],["formControlName","log2"],[1,"col-sm-8"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["dataPaginator",""],[3,"value"]],template:function(t,e){1&t&&(S.Tb(0,"form",0),S.Tb(1,"div",1),S.Tb(2,"div",2),S.Tb(3,"div",3),S.Tb(4,"label",4),S.Dc(5,"Time range"),S.Sb(),S.Tb(6,"label",5),S.Dc(7,"from:"),S.Sb(),S.Tb(8,"div",4),S.Ob(9,"input",6),S.Sb(),S.Tb(10,"label",7),S.Dc(11,"to:"),S.Sb(),S.Tb(12,"div",4),S.Ob(13,"input",8),S.Sb(),S.Sb(),S.Sb(),S.Tb(14,"div",9),S.Tb(15,"mat-slide-toggle",10),S.Dc(16,"hourly"),S.Sb(),S.Sb(),S.Sb(),S.Tb(17,"div",11),S.Tb(18,"label",12),S.Dc(19,"Detrending"),S.Sb(),S.Tb(20,"div",13),S.Tb(21,"select",14),S.Bc(22,F,2,2,"option",15),S.Sb(),S.Sb(),S.Ob(23,"div",16),S.Tb(24,"label",17),S.Dc(25,"Align"),S.Sb(),S.Tb(26,"div",13),S.Tb(27,"select",18),S.Bc(28,_,2,2,"option",15),S.Sb(),S.Sb(),S.Sb(),S.Tb(29,"div",11),S.Tb(30,"div",19),S.Tb(31,"label",20),S.Dc(32,"Normalize"),S.Sb(),S.Sb(),S.Tb(33,"div",13),S.Tb(34,"select",21),S.Bc(35,H,2,2,"option",15),S.Sb(),S.Sb(),S.Tb(36,"div",22),S.Tb(37,"mat-slide-toggle",23),S.Dc(38,"within range"),S.Sb(),S.Tb(39,"mat-slide-toggle",24),S.Dc(40,"log2 transf."),S.Sb(),S.Sb(),S.Sb(),S.Tb(41,"div",11),S.Ob(42,"label",19),S.Tb(43,"div",25),S.Tb(44,"bd2-simple-paginator",26,27),S.Zb("page",(function(t){return e.loadDataPage(t)})),S.Sb(),S.Sb(),S.Sb(),S.Sb()),2&t&&(S.jc("formGroup",e.mainForm),S.Bb(22),S.jc("ngForOf",e.detrendingOptions),S.Bb(6),S.jc("ngForOf",e.alignOptions),S.Bb(7),S.jc("ngForOf",e.normalisationOptions),S.Bb(9),S.jc("length",e.totalTraces)("disabled",e.disabledPagination)("pageSize",e.currentPage.pageSize)("pageIndex",e.currentPage.pageIndex)("pageSizeOptions",S.lc(9,A)))},directives:[u.D,u.r,u.i,u.j,u.v,u.d,u.z,u.q,u.h,P.a,u.A,l.l,N,u.u,u.C],encapsulation:2}),E),R=o("7EHt"),W=o("117B"),Z=o("XNiG"),q=o("PqYM"),$=o("VIqg"),V=o("sCaM"),G=o("f4CH"),U=o("FmoU"),Y=o("NltA"),J=o("EjHT"),K=o("CKiT"),X=o("lJxs"),Q=o("vkgz");function tt(t,e){if(1&t&&(S.cc(),S.Tb(0,"svg",2),S.Tb(1,"defs"),S.Tb(2,"filter",3),S.Ob(3,"feDropShadow",4),S.Sb(),S.Tb(4,"pattern",5),S.Ob(5,"line",6),S.Sb(),S.Sb(),S.Tb(6,"g",7),S.Ob(7,"g",8),S.Ob(8,"g",9),S.Ob(9,"g",10),S.Ob(10,"g",11),S.Ob(11,"g",12),S.Sb(),S.Sb()),2&t){var i=S.dc();S.Cb("viewBox",i.graphic.viewBox),S.Bb(6),S.Cb("transform",i.graphic.mainPaneTransform),S.Bb(1),S.jc("graphic",i.graphic),S.Bb(1),S.jc("graphic",i.graphic),S.Bb(1),S.jc("graphic",i.graphic)("series",i.series),S.Bb(1),S.jc("graphic",i.graphic)("data",i.series)("alwaysOn",i.labelsAlwaysOn),S.Bb(1),S.jc("graphic",i.graphic)}}var et=["text"],it=["bd2hm-tooltip",""];function nt(t,e){if(1&t&&(S.cc(),S.Tb(0,"g",1),S.Tb(1,"g"),S.Ob(2,"rect"),S.Tb(3,"text",null,2),S.Tb(5,"tspan",3),S.Dc(6),S.Sb(),S.Tb(7,"tspan",4),S.Dc(8),S.Sb(),S.Sb(),S.Sb(),S.Sb()),2&t){var i=S.dc();S.Cb("display",i.show?void 0:"none")("transform",i.position),S.Bb(1),S.Cb("opacity",i.ready?1:0),S.Bb(1),S.Cb("x",i.textBX)("width",i.textBWidth)("y",i.textBY)("height",i.textBHeight),S.Bb(4),S.Ec(i.label),S.Bb(2),S.Ec(i.values)}}var at=["bd2hm-labels",""];function rt(t,e){if(1&t&&(S.cc(),S.Ob(0,"g",3)),2&t){var i=e.$implicit,n=S.dc(2);S.jc("serie",i)("yStart",n.yStart(i))("maxHeight",n.maxHeight())("alwaysOn",n.alwaysOn)}}function ot(t,e){if(1&t&&(S.cc(),S.Tb(0,"g",1),S.Bc(1,rt,1,4,"g",2),S.Sb()),2&t){var i=S.dc();S.Bb(1),S.jc("ngForOf",i.data)("ngForTrackBy",i.trackByIndex)}}var st=["bd2hm-label-box",""];function ct(t,e){if(1&t&&(S.cc(),S.Tb(0,"text",9),S.Dc(1),S.Sb()),2&t){var i=S.dc(2);S.Cb("y",i.yMiddle)("font-size",i.fontSize()),S.Bb(1),S.Ec(i.serie.label)}}function lt(t,e){if(1&t){var i=S.Ub();S.cc(),S.Tb(0,"g",1),S.Bc(1,ct,2,3,"text",2),S.Tb(2,"g",3),S.Zb("mouseout",(function(){return S.sc(i),S.dc().toggleLabel(!1)}))("mouseover",(function(){return S.sc(i),S.dc().toggleLabel(!0)})),S.Ob(3,"rect",4),S.Tb(4,"g",5),S.Ob(5,"rect",6),S.Tb(6,"text",7,8),S.Dc(8),S.Sb(),S.Sb(),S.Sb(),S.Sb()}if(2&t){var n=S.dc();S.Bb(1),S.jc("ngIf",n.alwaysOn),S.Bb(2),S.Cb("y",n.triggerY)("height",n.triggerHeight)("fill",n.color),S.Bb(1),S.Cb("opacity",n.ready?1:0)("display",n.toggled?void 0:"none"),S.Bb(1),S.Cb("width",n.textBWidth)("y",n.textBY)("height",n.textBHeight),S.Bb(1),S.Cb("y",n.yMiddle),S.Bb(2),S.Ec(n.serie.label)}}var ht=["bd2hm-serie-row",""];function ut(t,e){if(1&t&&(S.cc(),S.Ob(0,"g",3)),2&t){var i=e.$implicit,n=S.dc(2);S.jc("point",i)("xScale",n.graphic.xScale)("yPosition",n.yPosition)("yHeight",n.yHeight)("colorScale",n.graphic.colorScale)("label",n.serie.label)}}function bt(t,e){if(1&t&&(S.cc(),S.Tb(0,"g",1),S.Bc(1,ut,1,6,"g",2),S.Sb()),2&t){var i=S.dc();S.Bb(1),S.jc("ngForOf",i.serie.data)("ngForTrackBy",i.trackByIndex)}}var dt=["box"],gt=["bd2hm-data-point-box",""];function pt(t,e){if(1&t&&(S.cc(),S.Ob(0,"rect",null,1)),2&t){var i=S.dc();S.Cb("x",i.xPosition)("y",i.yPosition)("width",i.xWidth)("height",i.yHeight)("fill",i.colorScale(i.point.y))("stroke",i.colorScale(i.point.y))}}var ft=["bd2hm-series-box",""];function mt(t,e){if(1&t&&(S.cc(),S.Ob(0,"g",1)),2&t){var i=e.$implicit,n=S.dc();S.jc("graphic",n.graphic)("serie",i)}}var yt=["bd2hm-pane-back",""],vt=["bd2hm-axis-box",""];function xt(t,e){if(1&t&&(S.cc(),S.Tb(0,"g",1),S.Ob(1,"g",2),S.Ob(2,"g",3),S.Ob(3,"g",4),S.Ob(4,"g",5),S.Sb()),2&t){var i=S.dc();S.Bb(1),S.jc("top",!0)("xScale",i.graphic.xScale)("yPosition",0)("xDomain",i.graphic.xDomain),S.Bb(1),S.jc("top",!1)("xScale",i.graphic.xScale)("yPosition",i.graphic.workspaceHeight)("xDomain",i.graphic.xDomain),S.Bb(1),S.jc("left",!0)("yScale",i.graphic.yScale)("xPosition",0),S.Bb(1),S.jc("left",!1)("yScale",i.graphic.yScale)("xPosition",i.graphic.workspaceWidth)}}var St=["bd2hm-y-axis",""],kt=["bd2hm-vtick-mark",""];function Ot(t,e){if(1&t&&(S.cc(),S.Ob(0,"line",2)),2&t){var i=S.dc();S.Cb("x1",i.tick.x)("x2",i.tick.x)("y2",i.marky2)}}function wt(t,e){if(1&t&&(S.cc(),S.Tb(0,"text"),S.Dc(1),S.Sb()),2&t){var i=S.dc();S.Cb("x",i.tick.x)("y",i.texty2)("dy",i.textdy),S.Bb(1),S.Ec(i.tick.label)}}var Bt=["bd2hm-num-x-axis",""];function Tt(t,e){1&t&&(S.cc(),S.Ob(0,"g",3)),2&t&&S.jc("tick",e.$implicit)}var Pt,Dt,jt,It,zt,Mt,Ct,Nt,Ft,_t,Ht,Et,At,Lt,Rt,Wt,Zt,qt,$t=function t(){c(this,t),this.vMargin=25,this.hMargin=20,this.smallRowWidth=6,this.midRowWidth=12,this.bigRowWidth=25,this.rowGap=.05},Vt=function t(){c(this,t)},Gt=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c(this,t),this.x=e,this.y=i,this.label=n,this.top=a,this.left=r},Ut=function t(e,i,n,a){c(this,t),this.x=e,this.y=i,this.left=n,this.right=a,this.width=a-n},Yt=function t(){c(this,t)},Jt=((Pt=function(){function t(){c(this,t),this.request$=new Z.a}return h(t,[{key:"showTooltip",value:function(t,e,i){this.request$.next([!0,t,e,i])}},{key:"hideTooltip",value:function(t,e){this.request$.next([!1,void 0,t,e])}},{key:"ngOnDestroy",value:function(){this.request$.complete()}}]),t}()).\u0275fac=function(t){return new(t||Pt)},Pt.\u0275prov=S.Jb({token:Pt,factory:Pt.\u0275fac}),Pt),Kt=function(){function t(){c(this,t)}return h(t,[{key:"seriesToBoxes",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.map((function(t){return e.serieToBoxes(t,i)}))}},{key:"serieToBoxes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Object.assign(new Yt,t);return i.data=e?this.pointsToAsymBoxes(t.data):this.pointsToSymBoxes(t.data),i}},{key:"pointsToAsymBoxes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(!t||0===t.length)return[];if(1===t.length){var i=t[0];return[new Ut(i.x,i.y,i.x-e,i.x+e)]}var n=[],a=t[0];n.push(new Ut(a.x,a.y,(3*a.x-t[1].x)/2,(a.x+t[1].x)/2));for(var r=1;r<t.length-1;r++)n.push(this.asymBoxFromPoints(t[r],t[r-1],t[r+1]));var o=t[t.length-1];return n.push(new Ut(o.x,o.y,(t[t.length-2].x+o.x)/2,(3*o.x-t[t.length-2].x)/2)),n}},{key:"asymBoxFromPoints",value:function(t,e,i){return new Ut(t.x,t.y,(e.x+t.x)/2,(t.x+i.x)/2)}},{key:"pointsToSymBoxes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(!t||0===t.length)return[];if(1===t.length){var i=t[0];return[new Ut(i.x,i.y,i.x-e,i.x+e)]}var n=[],a=t[0];n.push(new Ut(a.x,a.y,(3*a.x-t[1].x)/2,(a.x+t[1].x)/2));for(var r=1;r<t.length-1;r++)n.push(this.symBoxFromPoints(t[r],t[r-1],t[r+1]));var o=t[t.length-1];return n.push(new Ut(o.x,o.y,(t[t.length-2].x+o.x)/2,(3*o.x-t[t.length-2].x)/2)),n}},{key:"symBoxFromPoints",value:function(t,e,i){var n=Math.min(t.x-e.x,i.x-t.x)/2;return new Ut(t.x,t.y,t.x-n,t.x+n)}}]),t}(),Xt=function(){function t(){c(this,t)}return h(t,[{key:"prepareGraphicContext",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new Vt;return this.calculateDimensions(n,t,e),this.addPaneAttributes(n,e),this.addScales(n,t,e,i),this.addFormatters(n,t),n.labelsColors=this.labelsColors(t),n}},{key:"calculateDimensions",value:function(t,e,i){t.pWidth=500,t.workspaceWidth=t.pWidth-3*i.hMargin,t.workspaceHeight=this.calculateWorkspaceHeight(e,i),t.pHeight=t.workspaceHeight+2*i.vMargin}},{key:"calculateWorkspaceHeight",value:function(t,e){return t.length<=25?t.length*e.bigRowWidth:t.length<=100?t.length*e.midRowWidth:t.length*e.smallRowWidth}},{key:"addPaneAttributes",value:function(t,e){t.viewBox="0 0 500 "+t.pHeight,t.mainPaneTransform="translate(".concat(2*e.hMargin,", ").concat(e.vMargin,")")}},{key:"addScales",value:function(t,e,i,n){var a=this.timeDomain(e);t.xDomain=a;var r=this.timeMargin(e,a);a=[a[0]-r,a[1]+r],t.xScale=Object($.a)().clamp(!0).domain(a).range([0,t.workspaceWidth]);var o=e.map((function(t){return t.key}));t.yDomain=o,t.yScale=Object(V.a)().paddingInner(i.rowGap).paddingOuter(0).domain(o).range([0,t.workspaceHeight]),t.colorScale=this.heatmapScale(e,n)}},{key:"addFormatters",value:function(t,e){var i=this.timeDomain(e);t.domainFormatter=this.formatForDomain(i);var n=this.valuesRange(e);t.valuesFormatter=this.formatForDomain(n)}},{key:"timeMargin",value:function(t,e){var i=e[0],n=.5;return t.filter((function(t){return t.data&&t.data.length>0&&t.data[0].x===i})).forEach((function(t){var e=t.data[0];e instanceof Ut&&(n=Math.max(n,e.x-e.left))})),n}},{key:"timeDomain",value:function(t){var e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.forEach((function(t){t.data&&t.data.length>0&&(e=Math.min(e,t.data[0].x),i=Math.max(i,t.data[t.data.length-1].x))})),e=isFinite(e)?e:0,i=isFinite(i)?i:1,[e,i]}},{key:"heatmapScale",value:function(t,e){var i=this.valuesRange(t);if(e){var n=Math.max(Math.abs(i[0]),Math.abs(i[1]));i=[-n,n]}var a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#d62728",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"white",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#1f77b4",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1,a=Object($.a)().domain([-1,0,1]).range([Object(U.g)(t),Object(U.g)(e),Object(U.g)(i)]);return Object(Y.a)(-1,1+n,n).map((function(t){return Object(U.g)(a(t)).hex()}))}();return Object(G.a)().domain(i).range(a)}},{key:"valuesRange",value:function(t){if(0===t.length)return[NaN,NaN];var e=t[0].min,i=t[0].max;return t.forEach((function(t){e=Math.min(e,t.min),i=Math.max(i,t.max)})),[e,i]}},{key:"formatForDomain",value:function(t){var i=e(t,2),n=i[0],a=i[1]-n;return a<1?Object(J.b)(".2~e"):a<100?Object(J.b)(".2~f"):a<1e5?Object(J.b)("d"):Object(J.b)(".2~e")}},{key:"labelsColors",value:function(t){var e=t.length;return function(t){return Object(K.a)(t/e)}}}]),t}(),Qt=((qt=function(){function t(e,i){c(this,t),this.changeDetector=e,this.tooltip=i,this.asymmetric=!1,this.middleZero=!1,this.hidden=!1,this.labelsAlwaysOn=!0,this.lookAndFeel=new $t,this.heatmapDataUtil=new Kt,this.heatmapGraphUtil=new Xt}return h(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.tooltip&&this.tooltip.ngOnDestroy()}},{key:"ngOnChanges",value:function(t){this.data&&this.data.length>0?(this.series=this.heatmapDataUtil.seriesToBoxes(this.data,this.asymmetric),this.graphic=this.heatmapGraphUtil.prepareGraphicContext(this.series,this.lookAndFeel,this.middleZero)):(this.graphic=void 0,this.series=void 0)}}]),t}()).\u0275fac=function(t){return new(t||qt)(S.Nb(S.h),S.Nb(Jt))},qt.\u0275cmp=S.Hb({type:qt,selectors:[["bd2-num-heatmap"]],inputs:{asymmetric:"asymmetric",middleZero:"middleZero",hidden:"hidden",labelsAlwaysOn:"labelsAlwaysOn",lookAndFeel:"lookAndFeel",data:"data"},features:[S.Ab([Jt]),S.zb],decls:2,vars:2,consts:[[1,"bd2hm-heatmap",3,"hidden"],["width","100%",4,"ngIf"],["width","100%"],["id","bd2hm-shadow"],["dx","1","dy","1","stdDeviation","1"],["id","bd2hm-pattern-diagonal","width","10","height","10","patternTransform","rotate(45 0 0)","patternUnits","userSpaceOnUse"],["x1","0","y1","0","x2","0","y2","10",2,"stroke","lightgrey","stroke-width","1"],[1,"bd2hm-mainPane"],["bd2hm-pane-back","",1,"bd2hm-paneBack",3,"graphic"],["bd2hm-axis-box","",3,"graphic"],["bd2hm-series-box","",1,"bd2hm-seriesBox",3,"graphic","series"],["bd2hm-labels","",3,"graphic","data","alwaysOn"],["bd2hm-tooltip","",3,"graphic"]],template:function(t,e){1&t&&(S.Tb(0,"div",0),S.Bc(1,tt,12,10,"svg",1),S.Sb()),2&t&&(S.jc("hidden",e.hidden),S.Bb(1),S.jc("ngIf",e.graphic))},directives:function(){return[l.m,oe,se,re,ee,te]},styles:[".bd2hm-paneBack rect{fill:url(#bd2hm-pattern-diagonal)}  .bd2hm-axisWrapper line{stroke:grey}  .bd2hm-axisWrapper text{fill:grey;font-size:9px;text-anchor:middle}  .bd2hm-labels text.bd2hm-onLabel{dominant-baseline:central;fill:#000;opacity:.6}  .bd2hm-labels .bd2hm-hover text{dominant-baseline:central;fill:#fff;font-size:10px}  .bd2hm-labels .bd2hm-hover rect{fill:#000;filter:url(#bd2hm-shadow);opacity:.8}  .bd2hm-tooltipBox text{fill:#fff;font-size:10px}  .bd2hm-tooltipBox rect{fill:#000;filter:url(#bd2hm-shadow);opacity:.8}"],changeDetection:0}),qt),te=((Zt=function(){function t(e,i){c(this,t),this.tooltip=e,this.changeDetector=i,this.boxMargin=4,this.show=!1,this.ready=!1}return h(t,[{key:"ngOnInit",value:function(){var t=this;this.subscription=this.tooltip.request$.pipe(Object(p.a)(100)).subscribe((function(e){return t.handleRequest(e)}))}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"handleRequest",value:function(t){var i=e(t,4),n=i[0],a=i[1],r=i[2],o=i[3];n?this.showTooltip(a,r,o):this.hideTooltip(r,o)}},{key:"showTooltip",value:function(t,e,i){var n=this;this.ready=!1,this.label=this.formatLabel(t),this.values=this.formatValues(e),this.show=!0,this.changeDetector.detectChanges(),this.updateTextBBox().subscribe((function(t){n.show&&(n.position=n.translateToDataLocation(i,n.textBWidth,n.graphic.workspaceWidth),n.ready=!0),n.changeDetector.detectChanges()}))}},{key:"translateToDataLocation",value:function(t,e,i){var n=t.x+t.width+2*this.boxMargin;return n+e>=i&&(n=t.x-e),"translate(".concat(n,", ").concat(t.y,")")}},{key:"hideTooltip",value:function(t,e){this.show=!1,this.changeDetector.detectChanges()}},{key:"formatValues",value:function(t){return"".concat(this.graphic.domainFormatter(t.x)," : ").concat(this.graphic.valuesFormatter(t.y))}},{key:"updateTextBBox",value:function(){var t=this;return Object(q.a)(0).pipe(Object(X.a)((function(e){return t.textBBox()})),Object(Q.a)((function(e){return t.setTextBBox(e)})))}},{key:"setTextBBox",value:function(t){this.textBX=t.x-this.boxMargin,this.textBY=t.y-this.boxMargin,this.textBHeight=t.height+2*this.boxMargin,this.textBWidth=t.width+2*this.boxMargin}},{key:"textBBox",value:function(){return this.textNode?this.textNode.nativeElement.getBBox():{x:0,y:0,height:0,width:0}}},{key:"formatLabel",value:function(t){return t?t.length<40?t:t.substring(0,38)+"...":""}}]),t}()).\u0275fac=function(t){return new(t||Zt)(S.Nb(Jt),S.Nb(S.h))},Zt.\u0275cmp=S.Hb({type:Zt,selectors:[["","bd2hm-tooltip",""]],viewQuery:function(t,e){var i;1&t&&S.Ic(et,!0),2&t&&S.pc(i=S.ac())&&(e.textNode=i.first)},inputs:{boxMargin:"boxMargin",graphic:"graphic"},attrs:it,decls:1,vars:1,consts:[["class","bd2hm-tooltipBox",4,"ngIf"],[1,"bd2hm-tooltipBox"],["text",""],["x","0"],["x","0","dy","1.2em"]],template:function(t,e){1&t&&S.Bc(0,nt,9,9,"g",0),2&t&&S.jc("ngIf",e.graphic)},directives:[l.m],encapsulation:2,changeDetection:0}),Zt),ee=((Wt=function(){function t(){c(this,t),this.alwaysOn=!0}return h(t,[{key:"trackByIndex",value:function(t,e){return t}},{key:"ngOnInit",value:function(){}},{key:"yStart",value:function(t){return this.graphic.yScale(t.key)}},{key:"maxHeight",value:function(){return this.graphic.yScale.bandwidth()}},{key:"color",value:function(t){return this.graphic.labelsColors(t)}}]),t}()).\u0275fac=function(t){return new(t||Wt)},Wt.\u0275cmp=S.Hb({type:Wt,selectors:[["","bd2hm-labels",""]],inputs:{alwaysOn:"alwaysOn",graphic:"graphic",data:"data"},attrs:at,decls:1,vars:1,consts:[["class","bd2hm-labels",4,"ngIf"],[1,"bd2hm-labels"],["bd2hm-label-box","",3,"serie","yStart","maxHeight","alwaysOn",4,"ngFor","ngForOf","ngForTrackBy"],["bd2hm-label-box","",3,"serie","yStart","maxHeight","alwaysOn"]],template:function(t,e){1&t&&S.Bc(0,ot,2,2,"g",0),2&t&&S.jc("ngIf",e.graphic&&e.data)},directives:function(){return[l.m,l.l,ie]},encapsulation:2,changeDetection:0}),Wt),ie=((Rt=function(){function t(e){c(this,t),this.changeDetector=e,this.alwaysOn=!0,this.color="rgb(67, 125, 179)",this.textBWidth=0,this.textBY=0,this.toggled=!1,this.ready=!1}return h(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){this.margin=this.marginSize(),this.triggerY=this.yStart+this.margin,this.triggerHeight=this.margin>1?this.maxHeight-2*this.margin:this.maxHeight-1,this.yMiddle=this.yStart+this.maxHeight/2}},{key:"marginSize",value:function(){return this.maxHeight>=20?4:this.maxHeight>=12?2:1}},{key:"fontSize",value:function(){return this.maxHeight>12?10:this.maxHeight>=6?this.maxHeight-3:0}},{key:"toggleLabel",value:function(t){var e=this;void 0===t&&(t=!this.toggled),this.ready=!1,this.toggled=t,this.toggled&&this.updateTextBBox().subscribe((function(t){e.toggled&&(e.ready=!0),e.changeDetector.markForCheck()}))}},{key:"updateTextBBox",value:function(){var t=this;return Object(q.a)(0).pipe(Object(X.a)((function(e){return t.textBBox()})),Object(Q.a)((function(e){return t.setTextBBox(e)})))}},{key:"setTextBBox",value:function(t){this.textBY=t.y-4,this.textBHeight=t.height+8,this.textBWidth=t.x+t.width+4}},{key:"textBBox",value:function(){return this.textNode?this.textNode.nativeElement.getBBox():{x:0,y:0,height:0,width:0}}}]),t}()).\u0275fac=function(t){return new(t||Rt)(S.Nb(S.h))},Rt.\u0275cmp=S.Hb({type:Rt,selectors:[["","bd2hm-label-box",""]],viewQuery:function(t,e){var i;1&t&&S.Ic(et,!0),2&t&&S.pc(i=S.ac())&&(e.textNode=i.first)},inputs:{alwaysOn:"alwaysOn",color:"color",serie:"serie",yStart:"yStart",maxHeight:"maxHeight"},features:[S.zb],attrs:st,decls:1,vars:1,consts:[["class","bd2hm-label",4,"ngIf"],[1,"bd2hm-label"],["x","5","class","bd2hm-onLabel",4,"ngIf"],[3,"mouseout","mouseover"],["x","-7","width","7"],[1,"bd2hm-hover"],["x","0"],["x","5"],["text",""],["x","5",1,"bd2hm-onLabel"]],template:function(t,e){1&t&&S.Bc(0,lt,9,11,"g",0),2&t&&S.jc("ngIf",e.serie)},directives:[l.m],encapsulation:2,changeDetection:0}),Rt),ne=((Lt=function(){function t(){c(this,t)}return h(t,[{key:"trackByIndex",value:function(t,e){return t}},{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){this.graphic&&this.serie&&(this.yPosition=this.graphic.yScale(this.serie.key),this.yHeight=this.graphic.yScale.bandwidth())}}]),t}()).\u0275fac=function(t){return new(t||Lt)},Lt.\u0275cmp=S.Hb({type:Lt,selectors:[["","bd2hm-serie-row",""]],inputs:{graphic:"graphic",serie:"serie"},features:[S.zb],attrs:ht,decls:1,vars:1,consts:[["class","bd2hm-serie",4,"ngIf"],[1,"bd2hm-serie"],["bd2hm-data-point-box","",3,"point","xScale","yPosition","yHeight","colorScale","label",4,"ngFor","ngForOf","ngForTrackBy"],["bd2hm-data-point-box","",3,"point","xScale","yPosition","yHeight","colorScale","label"]],template:function(t,e){1&t&&S.Bc(0,bt,2,2,"g",0),2&t&&S.jc("ngIf",e.graphic&&e.serie)},directives:function(){return[l.m,l.l,ae]},encapsulation:2,changeDetection:0}),Lt),ae=((At=function(){function t(e,i){c(this,t),this.tooltip=e,this.zone=i}return h(t,[{key:"ngOnChanges",value:function(t){if(this.xScale&&this.point){this.xPosition=this.xScale(this.point.left);var e=this.xScale(this.point.right)-this.xScale(this.point.left);this.xWidth=e>=2?e-1:1}}},{key:"ngAfterViewInit",value:function(){var t=this;this.boxNode&&this.prevBoxNode!==this.boxNode&&(this.removeMouseListeners(this.prevBoxNode),this.zone.runOutsideAngular((function(){t.addMouseListeners(t.boxNode)})),this.prevBoxNode=this.boxNode)}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.removeMouseListeners(this.boxNode)}},{key:"addMouseListeners",value:function(t){t&&(t.nativeElement.addEventListener("mouseover",this.showTooltip.bind(this)),t.nativeElement.addEventListener("mouseout",this.hideTooltip.bind(this)))}},{key:"removeMouseListeners",value:function(t){t&&(t.nativeElement.removeEventListener("mouseover",this.showTooltip),t.nativeElement.removeEventListener("mouseout",this.hideTooltip))}},{key:"hideTooltip",value:function(t){this.tooltip.hideTooltip(this.point,{x:this.xPosition,y:this.yPosition,width:this.xWidth})}},{key:"showTooltip",value:function(t){this.tooltip.showTooltip(this.label,this.point,{x:this.xPosition,y:this.yPosition,width:this.xWidth})}}]),t}()).\u0275fac=function(t){return new(t||At)(S.Nb(Jt),S.Nb(S.B))},At.\u0275cmp=S.Hb({type:At,selectors:[["","bd2hm-data-point-box",""]],viewQuery:function(t,e){var i;1&t&&S.Ic(dt,!0),2&t&&S.pc(i=S.ac())&&(e.boxNode=i.first)},inputs:{point:"point",yPosition:"yPosition",yHeight:"yHeight",xScale:"xScale",colorScale:"colorScale",label:"label"},features:[S.zb],attrs:gt,decls:1,vars:1,consts:[[4,"ngIf"],["box",""]],template:function(t,e){1&t&&S.Bc(0,pt,2,6,"rect",0),2&t&&S.jc("ngIf",e.point&&e.xScale)},directives:[l.m],encapsulation:2,changeDetection:0}),At),re=((Et=function(){function t(){c(this,t)}return h(t,[{key:"trackByIndex",value:function(t,e){return t}},{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||Et)},Et.\u0275cmp=S.Hb({type:Et,selectors:[["","bd2hm-series-box",""]],inputs:{series:"series",graphic:"graphic"},attrs:ft,decls:1,vars:2,consts:[["bd2hm-serie-row","",3,"graphic","serie",4,"ngFor","ngForOf","ngForTrackBy"],["bd2hm-serie-row","",3,"graphic","serie"]],template:function(t,e){1&t&&S.Bc(0,mt,1,2,"g",0),2&t&&S.jc("ngForOf",e.series)("ngForTrackBy",e.trackByIndex)},directives:[l.l,ne],encapsulation:2,changeDetection:0}),Et),oe=((Ht=function(){function t(){c(this,t),this.margin=2}return h(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){this.width=this.graphic.workspaceWidth-2*this.margin,this.height=this.graphic.workspaceHeight-2*this.margin,this.width<0&&(this.width=0),this.height<0&&(this.height=0)}}]),t}()).\u0275fac=function(t){return new(t||Ht)},Ht.\u0275cmp=S.Hb({type:Ht,selectors:[["","bd2hm-pane-back",""]],inputs:{margin:"margin",graphic:"graphic"},features:[S.zb],attrs:yt,decls:1,vars:4,consts:[[1,"bd2hm-dataBackground"]],template:function(t,e){1&t&&(S.cc(),S.Ob(0,"rect",0)),2&t&&S.Cb("x",e.margin)("y",e.margin)("width",e.width)("height",e.height)},encapsulation:2,changeDetection:0}),Ht),se=((_t=function(){function t(){c(this,t)}return h(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||_t)},_t.\u0275cmp=S.Hb({type:_t,selectors:[["","bd2hm-axis-box",""]],inputs:{graphic:"graphic"},attrs:vt,decls:1,vars:1,consts:[["class","bd2hm-axisWrapper",4,"ngIf"],[1,"bd2hm-axisWrapper"],["bd2hm-num-x-axis","",1,"xTopAxis",3,"top","xScale","yPosition","xDomain"],["bd2hm-num-x-axis","",1,"xBottomAxis",3,"top","xScale","yPosition","xDomain"],["bd2hm-y-axis","",1,"yLeftAxis",3,"left","yScale","xPosition"],["bd2hm-y-axis","",1,"yRightAxis",3,"left","yScale","xPosition"]],template:function(t,e){1&t&&S.Bc(0,xt,5,14,"g",0),2&t&&S.jc("ngIf",e.graphic)},directives:function(){return[l.m,he,ce]},encapsulation:2,changeDetection:0}),_t),ce=((Ft=function(){function t(){c(this,t),this.left=!1}return h(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){var e;this.axisTransform="translate(".concat(this.xPosition,",0)"),this.y2=null===(e=this.yScale)||void 0===e?void 0:e.range()[1]}}]),t}()).\u0275fac=function(t){return new(t||Ft)},Ft.\u0275cmp=S.Hb({type:Ft,selectors:[["","bd2hm-y-axis",""]],inputs:{left:"left",yScale:"yScale",xPosition:"xPosition"},features:[S.zb],attrs:St,decls:2,vars:2,consts:[[1,"bd2hm-y-axis"],["x1","0","y1","0","x2","0"]],template:function(t,e){1&t&&(S.cc(),S.Tb(0,"g",0),S.Ob(1,"line",1),S.Sb()),2&t&&(S.Cb("transform",e.axisTransform),S.Bb(1),S.Cb("y2",e.y2))},encapsulation:2,changeDetection:0}),Ft),le=((Nt=function(){function t(){c(this,t),this.length=5}return h(t,[{key:"ngOnInit",value:function(){this.calculatePositions()}},{key:"ngOnChanges",value:function(t){this.calculatePositions()}},{key:"calculatePositions",value:function(){var t,e,i;this.marky2=(null===(t=this.tick)||void 0===t?void 0:t.top)?-this.length:this.length,this.texty2=(null===(e=this.tick)||void 0===e?void 0:e.top)?-(this.length+4):this.length+4,this.textdy=(null===(i=this.tick)||void 0===i?void 0:i.top)?0:"0.6em"}}]),t}()).\u0275fac=function(t){return new(t||Nt)},Nt.\u0275cmp=S.Hb({type:Nt,selectors:[["","bd2hm-vtick-mark",""]],inputs:{length:"length",tick:"tick"},features:[S.zb],attrs:kt,decls:2,vars:2,consts:[["y1","0",4,"ngIf"],[4,"ngIf"],["y1","0"]],template:function(t,e){1&t&&(S.Bc(0,Ot,1,3,"line",0),S.Bc(1,wt,2,4,"text",1)),2&t&&(S.jc("ngIf",e.tick),S.Bb(1),S.jc("ngIf",e.tick))},directives:[l.m],encapsulation:2}),Nt),he=((Ct=function(){function t(){c(this,t),this.top=!1,this.ticks=[]}return h(t,[{key:"trackByIndex",value:function(t,e){return t}},{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(t){var e;this.axisTransform="translate(0,".concat(this.yPosition,")"),this.x2=null===(e=this.xScale)||void 0===e?void 0:e.range()[1],this.ticks=this.prepareTicks(this.xScale)}},{key:"prepareTicks",value:function(t){var e=this;return this.calculateTicksPosition(t).map((function(i){return new Gt(t(i),0,i,e.top,!1)}))}},{key:"calculateTicksPosition",value:function(t){if(!t)return[];for(var e=[],i=this.xDomain||t.domain(),n=Math.round(i[0]),a=Math.round(i[1]),r=this.domainStep(a-n),o=n;o<=a;o+=r)e.push(o);return e}},{key:"domainStep",value:function(t){return t<=25?4:t<=73?6:t<=169?12:24}}]),t}()).\u0275fac=function(t){return new(t||Ct)},Ct.\u0275cmp=S.Hb({type:Ct,selectors:[["","bd2hm-num-x-axis",""]],inputs:{top:"top",xScale:"xScale",xDomain:"xDomain",yPosition:"yPosition"},features:[S.zb],attrs:Bt,decls:3,vars:4,consts:[[1,"bd2hm-x-axis"],["x1","0","y1","0","y2","0"],["bd2hm-vtick-mark","","class","bd2hm-tickMark",3,"tick",4,"ngFor","ngForOf","ngForTrackBy"],["bd2hm-vtick-mark","",1,"bd2hm-tickMark",3,"tick"]],template:function(t,e){1&t&&(S.cc(),S.Tb(0,"g",0),S.Ob(1,"line",1),S.Bc(2,Tt,1,1,"g",2),S.Sb()),2&t&&(S.Cb("transform",e.axisTransform),S.Bb(1),S.Cb("x2",e.x2),S.Bb(1),S.jc("ngForOf",e.ticks)("ngForTrackBy",e.trackByIndex))},directives:[l.l,le],encapsulation:2,changeDetection:0}),Ct),ue=((Mt=function t(){c(this,t)}).\u0275mod=S.Lb({type:Mt}),Mt.\u0275inj=S.Kb({factory:function(t){return new(t||Mt)},imports:[[l.c]]}),Mt),be=((zt=function t(){c(this,t)}).\u0275mod=S.Lb({type:zt}),zt.\u0275inj=S.Kb({factory:function(t){return new(t||zt)},imports:[[l.c,ue],ue]}),zt),de=((It=function t(){c(this,t)}).\u0275mod=S.Lb({type:It}),It.\u0275inj=S.Kb({factory:function(t){return new(t||It)},imports:[[l.c,be]]}),It),ge=((jt=function t(){c(this,t)}).\u0275mod=S.Lb({type:jt}),jt.\u0275inj=S.Kb({factory:function(t){return new(t||jt)},imports:[[de]]}),jt),pe=((Dt=function(){function t(){c(this,t),this.middleZero=!1}return h(t,[{key:"ngOnInit",value:function(){}},{key:"traces",set:function(t){this.series=t}}]),t}()).\u0275fac=function(t){return new(t||Dt)},Dt.\u0275cmp=S.Hb({type:Dt,selectors:[["bd2-heatmap-plot"]],inputs:{traces:"traces",middleZero:"middleZero"},decls:2,vars:2,consts:[[2,"text-align","center"],[3,"data","middleZero"]],template:function(t,e){1&t&&(S.Tb(0,"div",0),S.Ob(1,"bd2-num-heatmap",1),S.Sb()),2&t&&(S.Bb(1),S.jc("data",e.series)("middleZero",e.middleZero))},directives:[Qt],encapsulation:2}),Dt);function fe(t,e){if(1&t){var i=S.Ub();S.Tb(0,"div",6),S.Tb(1,"label",7),S.Tb(2,"a",8),S.Zb("click",(function(){return S.sc(i),S.dc(2).exportDataView()})),S.Tb(3,"i",9),S.Dc(4,"save_alt"),S.Sb(),S.Tb(5,"span",10),S.Dc(6,"Download"),S.Sb(),S.Sb(),S.Dc(7," current view "),S.Sb(),S.Tb(8,"label",7),S.Tb(9,"a",11),S.Zb("click",(function(){return S.sc(i),S.dc(2).exportFullData()})),S.Tb(10,"i",9),S.Dc(11,"save_alt"),S.Sb(),S.Tb(12,"span",10),S.Dc(13,"Download"),S.Sb(),S.Sb(),S.Dc(14," full "),S.Sb(),S.Sb()}}function me(t,e){if(1&t&&S.Ob(0,"bd2-heatmap-plot",12),2&t){var i=S.dc(2);S.jc("traces",i.timeseries)("middleZero",i.middleZero)}}function ye(t,e){if(1&t){var i=S.Ub();S.Tb(0,"div"),S.Tb(1,"h3"),S.Dc(2,"Data heatmap"),S.Sb(),S.Ob(3,"hr"),S.Tb(4,"bd2-heatmap-display-params-rform",1),S.Zb("displayParams",(function(t){return S.sc(i),S.dc().displayChanged(t)})),S.Sb(),S.Tb(5,"mat-expansion-panel"),S.Tb(6,"mat-expansion-panel-header"),S.Tb(7,"mat-panel-title"),S.Dc(8," Sorting "),S.Sb(),S.Sb(),S.Ob(9,"bd2-tssort-params-rform",2),S.ec(10,"async"),S.ec(11,"async"),S.Sb(),S.Ob(12,"hr"),S.Tb(13,"div",3),S.Bc(14,fe,15,0,"div",4),S.Sb(),S.Ob(15,"hr"),S.Bc(16,me,1,2,"bd2-heatmap-plot",5),S.Sb()}if(2&t){var n=S.dc();S.Bb(4),S.jc("disabled",n.disabledSecondary)("totalTraces",n.totalTraces)("currentPage",n.currentPage),S.Bb(5),S.jc("ppaJobs",S.fc(10,7,n.analysis.ppaJobs$))("rhythmJobs",S.fc(11,9,n.analysis.rhythmJobs$)),S.Bb(5),S.jc("ngIf",n.timeseries),S.Bb(2),S.jc("ngIf",n.timeseries)}}var ve,xe,Se,ke=[{path:"",pathMatch:"full",component:(ve=function(e){n(a,e);var i=r(a);function a(t,e,n,r,o){var s;return c(this,a),(s=i.call(this,o)).analysis=t,s.fetcher=e,s.RDMSocial=n,s.analytics=r,s.timeseries=[],s.totalTraces=0,s.currentPage=f.a.firstPage(),s.tracesPerPlot=5,s.middleZero=!1,s.blocked=!1,s.disabledSecondary=!1,s.csvExporter=new v.a,t.allowedPPAMethods=["NLLS","MESA"],e.addTraceNr=!0,e.addTraceRef=!1,s.titlePart=" Data",s}return h(a,[{key:"ngOnInit",value:function(){var e=this;t(s(a.prototype),"ngOnInit",this).call(this),this.timeSeriesSubsripction=this.fetcher.seriesPackStream.pipe(Object(p.a)(1e3)).subscribe((function(t){if(e.assay){var i=t.data;e.currentParams=t.params,e.middleZero=e.isRangeSimetrical(t.params),e.timeseries=i,e.tracesPerPlot=Math.max(5,i.length/20),e.totalTraces=t.totalTraces,e.currentPage=t.currentPage,e.analytics.experimentHeatmapView(e.assay.id)}}),(function(t){console.log("Error in TS subscription: "+t),e.feedback.error(t)})),this.fetcher.error$.subscribe((function(t){return e.feedback.error(t)}))}},{key:"ngOnDestroy",value:function(){this.timeSeriesSubsripction&&this.timeSeriesSubsripction.unsubscribe(),this.fetcher.ngOnDestroy(),t(s(a.prototype),"ngOnDestroy",this).call(this)}},{key:"displayChanged",value:function(t){this.fetcher.changeDisplayParams(t)}},{key:"exportDataView",value:function(){this.exportSeriesPack(this.fetcher.current)}},{key:"exportFullData",value:function(){var t=this;this.fetcher.getFullDataSet(this.assay,this.fetcher.current.params,this.fetcher.current.sorting).subscribe((function(e){t.exportSeriesPack(e,!0)}))}},{key:"exportSeriesPack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var i=this.csvExporter.renderCSVTable(t.data,t.params,t.currentPage,t.sorting,this.assay),n=new Blob([i],{type:"text/csv"});y.saveAs(n,"".concat(this.assay.id,"_data.").concat(t.params.detrending.name).concat(e?".full":".page"+(t.currentPage.pageIndex+1),".csv")),this.recordExport()}}},{key:"recordExport",value:function(){this.analytics.experimentDataExport(this.assay.id)}},{key:"updateModel",value:function(e){var i=this;t(s(a.prototype),"updateModel",this).call(this,e),this.RDMSocial.canProceedByMeasurement(e).then((function(t){i.disabledSecondary=!t})),this.fetcher.experiment(e),this.analysis.experiment(e)}},{key:"isRangeSimetrical",value:function(t){return"RANGE"===t.normalisation||"Z_SCORE"===t.normalisation||"MEAN"===t.align}}]),a}(g.a),ve.\u0275fac=function(t){return new(t||ve)(S.Nb(x.a),S.Nb(m.a),S.Nb(k.a),S.Nb(O.a),S.Nb(w.a))},ve.\u0275cmp=S.Hb({type:ve,selectors:[["bd2-ts-heatmap-view"]],features:[S.Ab([m.a,x.a]),S.yb],decls:1,vars:1,consts:[[4,"ngIf"],[3,"disabled","totalTraces","currentPage","displayParams"],[3,"ppaJobs","rhythmJobs"],[1,"clearfix"],["class","float-right",4,"ngIf"],[3,"traces","middleZero",4,"ngIf"],[1,"float-right"],[1,"mr-4"],["download","","role","button","aria-label","download",1,"btn","btn-primary",2,"color","white",3,"click"],[1,"material-icons","bd-icon"],[1,"cdk-visually-hidden"],["download","","role","button","aria-label","download whole",1,"btn","btn-primary",2,"color","white",3,"click"],[3,"traces","middleZero"]],template:function(t,e){1&t&&S.Bc(0,ye,17,11,"div",0),2&t&&S.jc("ngIf",e.assay)},directives:[l.m,L,R.b,R.c,R.d,W.a,pe],pipes:[l.b],encapsulation:2}),ve)}],Oe=((xe=function t(){c(this,t)}).\u0275mod=S.Lb({type:xe}),xe.\u0275inj=S.Kb({factory:function(t){return new(t||xe)},imports:[[d.f.forChild(ke)],d.f]}),xe),we=o("NFeN"),Be=o("a6j2"),Te=((Se=function t(){c(this,t)}).\u0275mod=S.Lb({type:Se}),Se.\u0275inj=S.Kb({factory:function(t){return new(t||Se)},imports:[[l.c,u.y,u.k,b.c,we.b,j.b,P.b,R.a,ge,Be.a,Oe]]}),Se)}}])}();