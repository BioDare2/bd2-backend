(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{ReLR:function(e,t,i){"use strict";i.r(t),i.d(t,"ExperimentsModule",(function(){return _}));var s=i("ofXK"),r=i("tyNb"),n=i("M9IT"),c=i("pLZG"),a=i("lJxs"),o=i("XNiG"),u=i("2Vo4"),h=i("LRne"),b=i("itXk"),l=i("VRyK"),p=i("IzEk"),g=i("Kj3r"),d=i("vkgz"),m=i("JIr8"),f=i("/uUt"),S=i("eIep");let x=(()=>{class e{constructor(t=!1){this.removeDebounce=t,this.error$=new o.a,this.isFetching$=new u.a(!1),this.isProcessing$=new u.a(!1),this.dataLength=0,this.page$=new u.a(void 0),this.sort$=new u.a(void 0),this.on$=new u.a(!1),this.refresh$=new o.a,this.input$=new u.a(void 0),this.params$=new u.a(void 0),this.asset$=new u.a(void 0),this.DEBUG=!1,this.dataInputsDebounce=10,this.assetInputsDebounce=200,this.busyDebounce=50,this.id=e.ids++,this.logMe("created"),this.initAssetsStream(),this.isBusy$=this.initBusyStream(),this.data$=this.initDataStream()}logMe(e,t){this.DEBUG&&(e=this.constructor.name+":"+this.id+" "+e,t?console.log(e,t):console.log(e))}input(e){e&&(this.input$.next(e),this.resetPage())}params(e){this.params$.next(e)}on(e=!0){this.on$.next(e)}refresh(){this.refresh$.next(!0)}page(e){this.page$.next(e)}sort(e){this.sort$.next(e),this.resetPage()}close(){this.asset$.complete(),this.error$.complete(),this.isFetching$.complete(),this.isProcessing$.complete(),this.input$.complete(),this.params$.complete(),this.on$.complete(),this.refresh$.complete(),this.page$.complete(),this.sort$.complete()}errorToData(e){return Object(h.a)(void 0)}assetToSort(e){}assetToPage(e){}resetPage(){this.page$.pipe(Object(p.a)(1)).subscribe(e=>{if(e){const t=new n.d;t.pageIndex=0,t.pageSize=e.pageSize,this.page(t)}})}initBusyStream(){return this.removeDebounce?Object(b.a)([this.isFetching$,this.isProcessing$]).pipe(Object(a.a)(([e,t])=>e||t)):Object(b.a)([this.isFetching$,this.isProcessing$]).pipe(Object(g.a)(this.busyDebounce),Object(a.a)(([e,t])=>e||t))}initDataStream(){const e=this.dataMutators();let t;return t=this.removeDebounce?Object(b.a)(e):Object(b.a)(e).pipe(Object(g.a)(this.dataInputsDebounce)),t.pipe(Object(d.a)(e=>this.logMe("Input for data stream",e)),Object(d.a)(e=>this.isProcessing$.next(!0)),Object(a.a)(([e,t])=>{const i=this.processData(e,t);return this.currentParams=t,this.currentData=i,i}),Object(m.a)(e=>(this.error$.next(e),this.errorToData(e))),Object(d.a)(e=>this.isProcessing$.next(!1)))}dataMutators(){return[this.asset$.pipe(Object(c.a)(e=>!!e)),this.params$]}assetsMutators(){return[this.initAssetsInput(),this.sort$,this.page$.pipe(Object(c.a)(e=>!!e))]}initAssetsStream(){const e=this.assetsMutators();let t;t=this.removeDebounce?Object(b.a)(e):Object(b.a)(e).pipe(Object(g.a)(this.assetInputsDebounce)),t.pipe(Object(d.a)(e=>this.logMe("Input for asset stream",e))).subscribe(([e,t,i])=>this.loadAsset(e,t,i),e=>this.error$.next(e))}loadAsset(e,t,i){this.isFetching$.next(!0),this.fetchAsset(e,t,i).subscribe(s=>{this.isFetching$.next(!1),this.setAsset(s,e,t,i)},e=>{this.isFetching$.next(!1),this.error$.next(e)})}setAsset(e,t,i,s){this.currentInput=t,this.currentAsset=e,this.currentSort=this.assetToSort(e)||i,this.currentPage=this.assetToPage(e)||s,this.dataLength=this.assetToDataLength(e),this.asset$.next(e)}initAssetsInput(){const e=Object(b.a)([this.input$,this.on$]).pipe(Object(c.a)(([e,t])=>e&&t),Object(a.a)(([e,t])=>e)).pipe(Object(f.a)((e,t)=>this.sameInput(e,t))),t=this.refresh$.pipe(Object(S.a)(t=>e.pipe(Object(p.a)(1))));return Object(l.a)(e,t).pipe(Object(d.a)(e=>this.logMe("Assets input",e)))}}return e.ids=0,e})();var v=i("Iurr"),T=i("fXoL"),O=i("RtrU");let j=(()=>{class e extends x{constructor(e,t=!1){super(t),this.experimentService=e,this.experiment$=this.data$}fetchAsset(e,t,i){const s=(e.query||"").trim();return""===s?this.experimentService.getExperiments(e.showPublic,t,i):this.experimentService.searchExperiments(s,e.showPublic,t,i)}processData(e,t){return e.data}sameInput(e,t){return e.showPublic===t.showPublic&&e.query===t.query}assetToDataLength(e){return e.currentPage.length}assetToPage(e){return e.currentPage}errorToData(e){return Object(h.a)([])}}return e.\u0275fac=function(t){return new(t||e)(T.Xb(O.a),T.Xb(v.a,8))},e.\u0275prov=T.Jb({token:e,factory:e.\u0275fac}),e})();var $=i("6tuW"),D=i("naqj"),P=i("3Pt+"),y=i("bTqV");function I(e,t){if(1&e){const e=T.Ub();T.Tb(0,"i",3),T.Zb("click",(function(){return T.sc(e),T.dc().select("desc")})),T.Dc(1,"sort"),T.Sb()}}function w(e,t){if(1&e){const e=T.Ub();T.Tb(0,"i",4),T.Zb("click",(function(){return T.sc(e),T.dc().select("")})),T.Dc(1,"sort"),T.Sb()}}function B(e,t){if(1&e){const e=T.Ub();T.Tb(0,"i",4),T.Zb("click",(function(){return T.sc(e),T.dc().select("asc")})),T.Dc(1,"more_horiz"),T.Sb()}}const k={provide:P.o,useExisting:Object(T.V)(()=>F),multi:!0};let F=(()=>{class e{constructor(){this.value="",this.disabled=!1,this.onChange=e=>{},this.onTouched=()=>{}}ngOnInit(){}select(e){this.disabled||(this.value=e,this.onChange(this.value),this.onTouched())}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}writeValue(e){this.value=e}setDisabledState(e){this.disabled=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=T.Hb({type:e,selectors:[["bd2-sort-switch"]],features:[T.Ab([k])],decls:4,vars:4,consts:[["mat-mini-fab","","aria-label","sorting",3,"disabled"],["class","material-icons  icon-flipped-h",3,"click",4,"ngIf"],["class","material-icons",3,"click",4,"ngIf"],[1,"material-icons","icon-flipped-h",3,"click"],[1,"material-icons",3,"click"]],template:function(e,t){1&e&&(T.Tb(0,"button",0),T.Bc(1,I,2,0,"i",1),T.Bc(2,w,2,0,"i",2),T.Bc(3,B,2,0,"i",2),T.Sb()),2&e&&(T.jc("disabled",t.disabled),T.Bb(1),T.jc("ngIf","asc"===t.value),T.Bb(1),T.jc("ngIf","desc"===t.value),T.Bb(1),T.jc("ngIf",""===t.value))},directives:[y.a,s.m],encapsulation:2}),e})();var q=i("jaxi"),z=i("1jcm");let L=(()=>{class e{constructor(e){this.fb=e,this.search=new T.o,this.sort=new T.o,this.currentSort={active:"id",direction:"asc"},this.currentQuery="",this.currentShowPublic=!1}set options(e){e&&(this.currentQuery=e.query,this.currentShowPublic=e.showPublic,this.currentSort=e.sorting)}ngOnInit(){this.sortOptionsF=this.fb.group({sorting:[this.currentSort.active],direction:[this.currentSort.direction]}),this.showPublicF=this.fb.control(this.currentShowPublic),this.queryF=this.fb.control(this.currentQuery,[P.B.required,P.B.minLength(3)]),this.sortOptionsF.valueChanges.subscribe(e=>this.updateSort(e.sorting,e.direction)),this.showPublicF.valueChanges.subscribe(e=>{this.currentShowPublic=e,this.emitSearch()})}updateSort(e,t){const i={active:e,direction:t};this.currentSort=i,this.sort.next(i)}emitSearch(){this.search.next({showPublic:this.currentShowPublic,query:this.currentQuery})}find(){this.queryF.valid&&(this.currentQuery=this.queryF.value,this.emitSearch())}all(){this.queryF.setValue(""),this.currentQuery="",this.emitSearch()}}return e.\u0275fac=function(t){return new(t||e)(T.Nb(P.e))},e.\u0275cmp=T.Hb({type:e,selectors:[["bd2-search-and-sort-panel"]],inputs:{options:"options"},outputs:{search:"search",sort:"sort"},decls:25,vars:4,consts:[[1,"pb-1","pt-1","searchpanel"],[1,"float-left",3,"formGroup"],["formControlName","direction",1,"mr-1"],["name","sorting","aria-label","sorting","formControlName","sorting",1,"mr-4"],["value","id"],["value","name"],["value","author"],["value","executed"],["value","modified"],[1,"mr-2",3,"formControl"],[1,"no-clues","float-right"],["name","search","minlength","3","placeholder","e.g. prr9 temp*",1,"form-control-sm","mr-1",3,"formControl","keydown.enter"],["mat-mini-fab","","mat-icon-button","","aria-label","search",1,"mr-2",3,"disabled","click"],[1,"material-icons"],["mat-mini-fab","","color","primary","aria-label","all",3,"click"],[1,"clearfix"]],template:function(e,t){1&e&&(T.Tb(0,"div",0),T.Tb(1,"small"),T.Tb(2,"div",1),T.Ob(3,"bd2-sort-switch",2),T.Tb(4,"mat-button-toggle-group",3),T.Tb(5,"mat-button-toggle",4),T.Dc(6,"Id"),T.Sb(),T.Tb(7,"mat-button-toggle",5),T.Dc(8,"Title"),T.Sb(),T.Tb(9,"mat-button-toggle",6),T.Dc(10,"Author"),T.Sb(),T.Tb(11,"mat-button-toggle",7),T.Dc(12,"Exec."),T.Sb(),T.Tb(13,"mat-button-toggle",8),T.Dc(14,"Mod."),T.Sb(),T.Sb(),T.Sb(),T.Tb(15,"mat-slide-toggle",9),T.Dc(16,"Show public"),T.Sb(),T.Tb(17,"div",10),T.Tb(18,"input",11),T.Zb("keydown.enter",(function(){return t.find()})),T.Sb(),T.Tb(19,"button",12),T.Zb("click",(function(){return t.find()})),T.Tb(20,"i",13),T.Dc(21,"search"),T.Sb(),T.Sb(),T.Tb(22,"button",14),T.Zb("click",(function(){return t.all()})),T.Dc(23,"all"),T.Sb(),T.Sb(),T.Sb(),T.Ob(24,"div",15),T.Sb()),2&e&&(T.Bb(2),T.jc("formGroup",t.sortOptionsF),T.Bb(13),T.jc("formControl",t.showPublicF),T.Bb(3),T.jc("formControl",t.queryF),T.Bb(1),T.jc("disabled",t.queryF.invalid))},directives:[P.r,P.i,F,P.q,P.h,q.b,q.a,z.a,P.g,P.d,P.m,y.a],encapsulation:2}),e})();var M=i("bv9b");function A(e,t){1&e&&(T.Tb(0,"i",5),T.Dc(1,"lock_open"),T.Sb())}const C=function(e){return["/experiment",e]};let N=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=T.Hb({type:e,selectors:[["bd2-experiment-summary"]],inputs:{exp:"exp"},decls:24,vars:14,consts:[[1,"list-group-item","list-group-item-action",3,"routerLink"],[1,"list-group-item-heading"],["class","material-icons bd-icon","style","color: green",4,"ngIf"],[1,"list-group-item-text"],[1,"mb-1"],[1,"material-icons","bd-icon",2,"color","green"]],template:function(e,t){1&e&&(T.Tb(0,"a",0),T.Tb(1,"h5",1),T.Bc(2,A,2,0,"i",2),T.Dc(3),T.Sb(),T.Tb(4,"div",3),T.Tb(5,"div",4),T.Dc(6),T.Sb(),T.Tb(7,"div"),T.Tb(8,"strong"),T.Dc(9,"Authors:"),T.Sb(),T.Dc(10),T.Sb(),T.Tb(11,"div"),T.Tb(12,"small"),T.Tb(13,"strong"),T.Dc(14,"Id:"),T.Sb(),T.Dc(15),T.Tb(16,"strong"),T.Dc(17,"Executed:"),T.Sb(),T.Dc(18),T.ec(19,"date"),T.Tb(20,"strong"),T.Dc(21,"Modified:"),T.Sb(),T.Dc(22),T.ec(23,"date"),T.Sb(),T.Sb(),T.Sb(),T.Sb()),2&e&&(T.jc("routerLink",T.mc(12,C,t.exp.id)),T.Bb(2),T.jc("ngIf",t.exp.features.isOpenAccess),T.Bb(1),T.Fc(" ",t.exp.name," "),T.Bb(3),T.Ec(t.exp.generalDesc.purpose),T.Bb(4),T.Fc(" ",t.exp.authors,""),T.Bb(5),T.Fc(" ",t.exp.id," "),T.Bb(3),T.Fc(" ",T.fc(19,8,t.exp.generalDesc.executionDate.date)," "),T.Bb(4),T.Fc(" ",T.fc(23,10,t.exp.provenance.modified.date)," "))},directives:[r.e,s.m],pipes:[s.e],encapsulation:2}),e})();function E(e,t){1&e&&(T.Tb(0,"div",14),T.Dc(1," There are no visible experiments matching the criteria. "),T.Sb())}function Z(e,t){1&e&&T.Ob(0,"mat-progress-bar",15)}function R(e,t){1&e&&T.Ob(0,"bd2-experiment-summary",16),2&e&&T.jc("exp",t.$implicit)}const U=function(){return[]},G=function(e,t){return{pageIndex:e,pageSize:t}};function Q(e,t){if(1&e&&(T.Tb(0,"a",17),T.Dc(1,"Next"),T.Sb()),2&e){const e=T.dc();T.jc("routerLink",T.lc(2,U))("queryParams",T.nc(3,G,(null==e.fetcher.currentPage?null:e.fetcher.currentPage.pageIndex)+1,null==e.fetcher.currentPage?null:e.fetcher.currentPage.pageSize))}}const V=function(){return[10,25,50,100,200]},X=[{path:"",children:[{path:"",component:(()=>{class e{constructor(e,t,i,s,r){this.experimentService=e,this.fetcher=t,this.feedback=i,this.userService=s,this.route=r}ngOnInit(){this.firstPage(),this.initialSearchOptions={sorting:{active:"modified",direction:"desc"},showPublic:!this.userService.isLoggedIn(),query:""},this.subscribeRoute(),this.fetcher.experiment$.subscribe(e=>this.experiments=e),this.fetcher.error$.subscribe(e=>this.feedback.error(e)),this.fetcher.on(!0),this.sort(this.initialSearchOptions.sorting),this.search(this.initialSearchOptions),this.page(this.firstPage())}ngOnDestroy(){this.routeSubscription&&this.routeSubscription.unsubscribe(),this.fetcher&&this.fetcher.close()}search(e){this.fetcher.input(e)}sort(e){this.fetcher.sort(e)}page(e){this.fetcher.page(e)}firstPage(){const e=+this.route.snapshot.queryParamMap.get("pageIndex")||0,t=+this.route.snapshot.queryParamMap.get("pageSize")||25,i=new n.d;return i.pageIndex=e,i.pageSize=t,i}subscribeRoute(){this.routeSubscription=this.route.queryParamMap.pipe(Object(c.a)(e=>e.has("pageIndex")&&e.has("pageSize")),Object(a.a)(e=>{const t=new n.d;return t.pageSize=+e.get("pageSize"),t.pageIndex=+e.get("pageIndex"),t})).subscribe(e=>this.page(e))}refresh(){this.fetcher.refresh()}}return e.\u0275fac=function(t){return new(t||e)(T.Nb(O.a),T.Nb(j),T.Nb($.a),T.Nb(D.a),T.Nb(r.a))},e.\u0275cmp=T.Hb({type:e,selectors:[["ng-component"]],features:[T.Ab([j])],decls:20,vars:18,consts:[[1,"float-left"],["role","button","aria-label","refresh",3,"click"],[1,"material-icons","bd-icon-inh","bd-primary",2,"font-size","larger"],[1,"clearfix"],["class","alert alert-info",4,"ngIf"],[3,"options","search","sort"],[3,"length","pageSize","pageIndex","pageSizeOptions","page"],["paginator",""],["mode","indeterminate",4,"ngIf"],[1,"list-group"],[3,"exp",4,"ngFor","ngForOf"],[3,"hidden","length","pageSize","pageIndex","pageSizeOptions","page"],["paginator2",""],["style","color: rgba(0,0,0,.54);",3,"routerLink","queryParams",4,"ngIf"],[1,"alert","alert-info"],["mode","indeterminate"],[3,"exp"],[2,"color","rgba(0,0,0,.54)",3,"routerLink","queryParams"]],template:function(e,t){if(1&e&&(T.Tb(0,"div"),T.Tb(1,"h2",0),T.Dc(2,"Experiments "),T.Tb(3,"a",1),T.Zb("click",(function(){return t.refresh()})),T.Tb(4,"i",2),T.Dc(5,"refresh"),T.Sb(),T.Sb(),T.Sb(),T.Ob(6,"div",3),T.Bc(7,E,2,0,"div",4),T.Tb(8,"div"),T.Tb(9,"bd2-search-and-sort-panel",5),T.Zb("search",(function(e){return t.search(e)}))("sort",(function(e){return t.sort(e)})),T.Sb(),T.Tb(10,"mat-paginator",6,7),T.Zb("page",(function(e){return t.page(e)})),T.Sb(),T.Bc(12,Z,1,0,"mat-progress-bar",8),T.ec(13,"async"),T.Tb(14,"div",9),T.Bc(15,R,1,1,"bd2-experiment-summary",10),T.Sb(),T.Tb(16,"mat-paginator",11,12),T.Zb("page",(function(e){return t.page(e)})),T.Sb(),T.Tb(18,"div",0),T.Bc(19,Q,2,6,"a",13),T.Sb(),T.Sb(),T.Sb()),2&e){const e=T.qc(11);T.Bb(7),T.jc("ngIf",!t.experiments||t.experiments.length<1),T.Bb(2),T.jc("options",t.initialSearchOptions),T.Bb(1),T.jc("length",t.fetcher.dataLength)("pageSize",(null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageSize)||25)("pageIndex",null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageIndex)("pageSizeOptions",T.lc(16,V)),T.Bb(2),T.jc("ngIf",T.fc(13,14,t.fetcher.isBusy$)),T.Bb(3),T.jc("ngForOf",t.experiments),T.Bb(1),T.jc("hidden",(null==t.experiments?null:t.experiments.length)<1)("length",t.fetcher.dataLength)("pageSize",(null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageSize)||25)("pageIndex",null==t.fetcher.currentPage?null:t.fetcher.currentPage.pageIndex)("pageSizeOptions",T.lc(17,V)),T.Bb(3),T.jc("ngIf",e.hasNextPage())}},directives:[s.m,L,n.a,s.l,M.a,N,r.e],pipes:[s.b],encapsulation:2}),e})(),pathMatch:"full"}]}];let J=(()=>{class e{}return e.\u0275mod=T.Lb({type:e}),e.\u0275inj=T.Kb({factory:function(t){return new(t||e)},imports:[[r.f.forChild(X)],r.f]}),e})();var K=i("DkMi"),H=i("+0xr");let _=(()=>{class e{}return e.\u0275mod=T.Lb({type:e}),e.\u0275inj=T.Kb({factory:function(t){return new(t||e)},imports:[[s.c,P.k,P.y,y.b,q.c,z.b,n.c,H.o,M.b,K.a,J]]}),e})()}}]);