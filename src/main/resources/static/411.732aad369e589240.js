"use strict";(self.webpackChunkbiodare2_ui=self.webpackChunkbiodare2_ui||[]).push([[411],{411:(ue,I,a)=>{a.r(I),a.d(I,{RhythmicityModule:()=>b});var h=a(6895),A=a(9299),Y=a(471),t=a(4650),u=a(9333),U=a(2110);class f extends Y.w{constructor(e,i){super(i),this.rhythmicityService=e,this.titlePart=" Rhythm"}goToRhythmicityHome(e){const i=this.expHomePath(e);i.push("rhythmicity"),this.router.navigate(i)}}f.\u0275fac=function(e){return new(e||f)(t.Y36(u.o),t.Y36(U.L))},f.\u0275dir=t.lG2({type:f,features:[t.qOj]});var Q=a(1135),F=a(2805),k=a(7467),E=a(6598),c=a(7529),B=a(239),w=a(3403),H=a(4798);class d extends B.S{get currentJob(){return this.currentAsset}constructor(e,i=!1){super(i),this.rhythmicityService=e,this.finishedJob$=this.finished$,this.runningJob$=this.running$,this.allJob$=this.all$}initIntervalsKeeper(){return new H.i(1e3,3e4,6e5,2)}assayJob(e){this.input(e)}sameInput(e,i){return e[1]===i[1]&&e[0]===i[0]}fetchAsset([e,i]){return this.rhythmicityService.getJob(e,i)}hasFailed(e){return c.GJ.hasFailed(e)}isFinished(e){return c.GJ.isFinished(e)}isRunning(e){return c.GJ.isRunning(e)}assetToId(e){return e.jobId}assetToInput(e){return[e.parentId,e.jobId]}}d.\u0275fac=function(e){return new(e||d)(t.LFG(u.o),t.LFG(w.I,8))},d.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac});var D=a(8739),L=a(8505),$=a(4534);class p extends $.v{constructor(e,i=!1){super(i),this.rhythmicityService=e,this.results$=this.data$}isClassicJob(){return"BD2JTK"===this.currentInput?.parameters?.METHOD}sameInput(e,i){return c.GJ.sameJob(e,i)}assetToData(e,i){return e.results}fetchAsset(e){return this.rhythmicityService.getResults(e.parentId,e.jobId).pipe((0,L.b)(i=>this.labelPatterns(i)))}sortingKey(e){switch(e.active){case"label":return i=>i.label;case"id":return i=>+i.id;case"empp":return i=>+i.result.empP;case"emppbh":return i=>+i.result.empPBH;case"p":return i=>+i.result.p;case"pbh":return i=>+i.result.pBH;case"tau":return i=>+i.result.tau;case"period":return i=>i.result.pattern.period;case"peak":return i=>i.result.pattern.peak;case"trough":return i=>i.result.pattern.trough;default:return console.error("Not implemented sorting for "+e.active),i=>0}}processData(e,i){return i&&this.rankResults(e,i.pValue,i.bhCorrection,this.isClassicJob()),e}labelPatterns(e){e.results.forEach(i=>{i.result.patternLabel=this.describePattern(i.result),i.result.pattern.shapeLabel=this.patternToShape(i.result.pattern)})}describePattern(e){const i=e.pattern,s=Math.round(10*i.period)/10,o=Math.round(100*i.peak)/100,l=Math.round(100*i.trough)/100;return`${this.patternToShape(i)}\t${s}\t${o}\t${l}`}patternToShape(e){switch(e.waveform){case"ASYM_COSINE":return.5===e.leftPortion?"COS":"ACOS";case"ASYM_COS_SPIKE":return"SPIKE";case"ASYM_COS_SPIKE_NEG":return"NPIKE";default:return e.waveform}}rankResults(e,i,s,o){e.forEach(l=>{const T=l.result;let S;S=o?s?T.pBH:T.p:s?T.empPBH:T.empP,T.rhythmic=S<i})}}p.\u0275fac=function(e){return new(e||p)(t.LFG(u.o),t.LFG(w.I,8))},p.\u0275prov=t.Yz7({token:p,factory:p.\u0275fac});var O=a(2160),M=a(6308),m=a(7155),K=a(3162);function G(n,e){1&n&&t._UZ(0,"mat-progress-bar",28)}function z(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"Id"),t.qZA())}function V(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(i.id)}}function W(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"Label"),t.qZA())}function X(n,e){if(1&n&&(t.TgZ(0,"td",31),t._uU(1),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(i.label)}}function tt(n,e){1&n&&(t.TgZ(0,"th",32),t._uU(1,"Rhythmic"),t.qZA())}function et(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&n){const i=e.$implicit;t.ekj("bold",i.result.rhythmic),t.xp6(1),t.Oqu(i.result.rhythmic)}}function it(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"emp-p"),t.qZA())}function nt(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.result.empP,"1.0-5"))}}function st(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"BH emp-p"),t.qZA())}function ot(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.result.empPBH,"1.0-5"))}}function at(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"Tau"),t.qZA())}function rt(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.result.tau,"1.0-2"))}}function ct(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"p"),t.qZA())}function lt(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.result.p,"1.0-5"))}}function ht(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"BH p"),t.qZA())}function mt(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.result.pBH,"1.0-5"))}}function dt(n,e){1&n&&(t.TgZ(0,"th",32),t._uU(1,"Pattern"),t.qZA())}function pt(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(i.result.patternLabel)}}function ut(n,e){1&n&&(t.TgZ(0,"th",32),t._uU(1,"P.Shape"),t.qZA())}function ft(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(i.result.pattern.shapeLabel)}}function yt(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"P.Period"),t.qZA())}function _t(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.result.pattern.period,"1.0-1"))}}function gt(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"P.Peak"),t.qZA())}function bt(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.result.pattern.peak,"1.1-1"))}}function Tt(n,e){1&n&&(t.TgZ(0,"th",32),t._uU(1,"P.Peak"),t.qZA())}function vt(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,24*i.result.pattern.peak/i.result.pattern.period,"1.1-1"))}}function Zt(n,e){1&n&&(t.TgZ(0,"th",29),t._uU(1,"P.Trough"),t.qZA())}function Ct(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,i.result.pattern.trough,"1.1-1"))}}function Rt(n,e){1&n&&(t.TgZ(0,"th",32),t._uU(1,"P.Trough"),t.qZA())}function xt(n,e){if(1&n&&(t.TgZ(0,"td",30),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const i=e.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,24*i.result.pattern.trough/i.result.pattern.period,"1.1-1"))}}function Pt(n,e){1&n&&t._UZ(0,"tr",33)}function Jt(n,e){1&n&&t._UZ(0,"tr",34)}const N=function(){return[10,25,50,100,250]};class y{set job(e){e&&this.fetcher.input(e)}set statTestParams(e){if(e){this.fetcher.params(e);let i=e.bhCorrection?this.bhEmpPColumns:this.normEmpPColumns;this.fetcher.isClassicJob()&&(i=e.bhCorrection?this.bhClsPColumns:this.normClsPColumns),e.showPattern&&(i=i.concat(e.circadian?this.patternColumnsC:this.patternColumns)),this.displayedColumns=i}}constructor(e,i){this.fetcher=e,this.feedback=i,this.normEmpPColumns=["id","label","rhythmic","empp","tau"],this.normClsPColumns=["id","label","rhythmic","p","tau"],this.bhEmpPColumns=["id","label","rhythmic","emppbh","tau"],this.bhClsPColumns=["id","label","rhythmic","pbh","tau"],this.patternColumns=["shape","period","peak","trough"],this.patternColumnsC=["shape","period","peakc","troughc"],this.displayedColumns=this.normEmpPColumns,this.disablePaginator=!1}ngOnInit(){this.fetcher.error$.subscribe(i=>this.feedback.error(i));const e=new D.kl;e.pageSize=25,e.pageIndex=0,this.fetcher.page(e),this.fetcher.on(!0)}ngOnDestroy(){this.fetcher.close()}ngAfterViewInit(){}reload(){this.fetcher.refresh()}sortData(e){this.fetcher.sort(e)}loadPage(e){this.fetcher.page(e)}}y.\u0275fac=function(e){return new(e||y)(t.Y36(p),t.Y36(O.T))},y.\u0275cmp=t.Xpm({type:y,selectors:[["bd2-rhythmicity-results-mdtable"]],inputs:{job:"job",statTestParams:"statTestParams"},features:[t._Bn([p])],decls:55,vars:18,consts:[[1,"mat-elevation-z8"],["mode","indeterminate",4,"ngIf"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["paginator",""],["mat-table","","matSort","","aria-label","Results","matSort","","matSortActive","id","matSortDirection","asc",1,"full-width-table",3,"dataSource","matSortChange"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","label"],["mat-cell","","class","word_wrapping","style","max-width: 100px",4,"matCellDef"],["matColumnDef","rhythmic"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"bold",4,"matCellDef"],["matColumnDef","empp"],["matColumnDef","emppbh"],["matColumnDef","tau"],["matColumnDef","p"],["matColumnDef","pbh"],["matColumnDef","pattern"],["matColumnDef","shape"],["matColumnDef","period"],["matColumnDef","peak"],["matColumnDef","peakc"],["matColumnDef","trough"],["matColumnDef","troughc"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["paginator2",""],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",1,"word_wrapping",2,"max-width","100px"],["mat-header-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.YNc(1,G,1,0,"mat-progress-bar",1),t.ALo(2,"async"),t.TgZ(3,"mat-paginator",2,3),t.NdJ("page",function(o){return i.loadPage(o)}),t.qZA(),t.TgZ(5,"table",4),t.NdJ("matSortChange",function(o){return i.sortData(o)}),t.ynx(6,5),t.YNc(7,z,2,0,"th",6),t.YNc(8,V,2,1,"td",7),t.BQk(),t.ynx(9,8),t.YNc(10,W,2,0,"th",6),t.YNc(11,X,2,1,"td",9),t.BQk(),t.ynx(12,10),t.YNc(13,tt,2,0,"th",11),t.YNc(14,et,2,3,"td",12),t.BQk(),t.ynx(15,13),t.YNc(16,it,2,0,"th",6),t.YNc(17,nt,3,4,"td",7),t.BQk(),t.ynx(18,14),t.YNc(19,st,2,0,"th",6),t.YNc(20,ot,3,4,"td",7),t.BQk(),t.ynx(21,15),t.YNc(22,at,2,0,"th",6),t.YNc(23,rt,3,4,"td",7),t.BQk(),t.ynx(24,16),t.YNc(25,ct,2,0,"th",6),t.YNc(26,lt,3,4,"td",7),t.BQk(),t.ynx(27,17),t.YNc(28,ht,2,0,"th",6),t.YNc(29,mt,3,4,"td",7),t.BQk(),t.ynx(30,18),t.YNc(31,dt,2,0,"th",11),t.YNc(32,pt,2,1,"td",7),t.BQk(),t.ynx(33,19),t.YNc(34,ut,2,0,"th",11),t.YNc(35,ft,2,1,"td",7),t.BQk(),t.ynx(36,20),t.YNc(37,yt,2,0,"th",6),t.YNc(38,_t,3,4,"td",7),t.BQk(),t.ynx(39,21),t.YNc(40,gt,2,0,"th",6),t.YNc(41,bt,3,4,"td",7),t.BQk(),t.ynx(42,22),t.YNc(43,Tt,2,0,"th",11),t.YNc(44,vt,3,4,"td",7),t.BQk(),t.ynx(45,23),t.YNc(46,Zt,2,0,"th",6),t.YNc(47,Ct,3,4,"td",7),t.BQk(),t.ynx(48,24),t.YNc(49,Rt,2,0,"th",11),t.YNc(50,xt,3,4,"td",7),t.BQk(),t.YNc(51,Pt,1,0,"tr",25),t.YNc(52,Jt,1,0,"tr",26),t.qZA(),t.TgZ(53,"mat-paginator",2,27),t.NdJ("page",function(o){return i.loadPage(o)}),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,14,i.fetcher.isBusy$)),t.xp6(2),t.Q6J("length",i.fetcher.dataLength)("disabled",i.disablePaginator)("pageSize",(null==i.fetcher.currentPage?null:i.fetcher.currentPage.pageSize)||25)("pageIndex",null==i.fetcher.currentPage?null:i.fetcher.currentPage.pageIndex)("pageSizeOptions",t.DdM(16,N)),t.xp6(2),t.Q6J("dataSource",i.fetcher.results$),t.xp6(46),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.fetcher.dataLength)("disabled",i.disablePaginator)("pageSize",(null==i.fetcher.currentPage?null:i.fetcher.currentPage.pageSize)||25)("pageIndex",null==i.fetcher.currentPage?null:i.fetcher.currentPage.pageIndex)("pageSizeOptions",t.DdM(17,N)))},dependencies:[h.O5,D.NW,M.YE,M.nU,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,K.pW,h.Ov,h.JJ],styles:[".full-width-table[_ngcontent-%COMP%]{width:100%}"]});var At=a(7045),Ut=a(7032),Dt=a(1572),P=a(3546),St=a(4850),It=a(455),r=a(4006),wt=a(9549),q=a(1948);function Ot(n,e){if(1&n&&(t.TgZ(0,"mat-radio-button",5),t._uU(1),t.qZA()),2&n){const i=e.$implicit;t.Q6J("value",i),t.xp6(1),t.Oqu(i)}}class v{constructor(){this.values=[1e-4,.001,.005,.01,.05,.1],this.pvalue=.001,this.pvalue$=new t.vpe}ngOnInit(){}ngAfterViewInit(){this.pvalue$.emit(this.pvalue)}selected(e){this.pvalue$.emit(e.value)}}v.\u0275fac=function(e){return new(e||v)},v.\u0275cmp=t.Xpm({type:v,selectors:[["bd2-pvalue-form"]],outputs:{pvalue$:"pvalue$"},decls:8,vars:2,consts:[[1,"form-inline"],[1,"mx-auto","text-center"],["id","pvalues-label",1,"mb-1"],["aria-label","Select p-value","aria-labelledby","pvalues-label",3,"value","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"mat-label",2)(3,"strong"),t._uU(4,"p-value threshold:"),t.qZA()(),t.TgZ(5,"div")(6,"mat-radio-group",3),t.NdJ("change",function(o){return i.selected(o)}),t.YNc(7,Ot,2,2,"mat-radio-button",4),t.qZA()()()()),2&e&&(t.xp6(6),t.Q6J("value",i.pvalue),t.xp6(1),t.Q6J("ngForOf",i.values))},dependencies:[h.sg,r._Y,r.JL,r.F,wt.hX,q.VQ,q.U0],styles:[".mat-radio-button[_ngcontent-%COMP%]{margin-right:15px}"]});class Z{constructor(){this.options=new t.vpe,this.currentOptions=new c.Mn(0,!1,!1,!1)}ngOnInit(){}pValue(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.pValue=e,this.options.next(this.currentOptions)}bhCorrection(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.bhCorrection=e,this.options.next(this.currentOptions)}circadian(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.circadian=e,this.options.next(this.currentOptions)}showPattern(e){this.currentOptions=this.currentOptions.clone(),this.currentOptions.showPattern=e,this.options.next(this.currentOptions)}}function Mt(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"div",5)(1,"button",13),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.delete())}),t.TgZ(2,"i",4),t._uU(3,"delete_forever"),t.qZA()(),t.TgZ(4,"button",14),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.export())}),t.TgZ(5,"i",4),t._uU(6,"save_alt"),t.qZA()()()}}function Nt(n,e){if(1&n&&(t.TgZ(0,"div",15),t._UZ(1,"br"),t._uU(2),t.qZA()),2&n){const i=t.oxw().ngIf;t.xp6(2),t.hij("ERROR: ",i.jobStatus.message," ")}}function qt(n,e){1&n&&(t.TgZ(0,"div")(1,"mat-card")(2,"mat-card-content"),t._UZ(3,"mat-spinner",16),t.qZA()()())}function jt(n,e){1&n&&(t.TgZ(0,"div")(1,"mat-card")(2,"mat-card-content")(3,"div",17),t._uU(4,"It may take up to 10 minutes to test for rhythmicity"),t.qZA()()()())}function Yt(n,e){if(1&n){const i=t.EpF();t.ynx(0),t.TgZ(1,"bd2-stat-test-options-widget",18),t.NdJ("options",function(o){t.CHM(i);const l=t.oxw(3);return t.KtG(l.statTestOptions(o))}),t.qZA(),t._UZ(2,"bd2-rhythmicity-results-mdtable",19),t.BQk()}if(2&n){const i=e.ngIf,s=t.oxw(3);t.xp6(2),t.Q6J("statTestParams",s.statTestParams)("job",i)}}function Qt(n,e){if(1&n&&(t.TgZ(0,"div"),t._UZ(1,"mat-divider"),t.YNc(2,qt,4,0,"div",12),t.ALo(3,"async"),t.YNc(4,jt,5,0,"div",12),t.YNc(5,Yt,3,2,"ng-container",12),t.ALo(6,"async"),t.qZA()),2&n){const i=t.oxw().ngIf,s=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,3,s.rhythmicityJobDatasource.isReloading$)),t.xp6(2),t.Q6J("ngIf","SUBMITTED"===i.jobStatus.state),t.xp6(1),t.Q6J("ngIf",t.lcZ(6,5,s.rhythmicityJobDatasource.finishedJob$))}}function Ft(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.toggleExpanded())}),t.TgZ(3,"i",4),t._uU(4,"waves"),t.qZA(),t._uU(5),t.ALo(6,"date"),t._UZ(7,"br"),t._uU(8),t.qZA(),t.TgZ(9,"div",5),t._uU(10),t.TgZ(11,"a",6),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.refresh())}),t.TgZ(12,"i",7),t._uU(13,"refresh"),t.qZA()()()(),t.TgZ(14,"div",8)(15,"mat-card")(16,"mat-card-content")(17,"div",9),t.YNc(18,Mt,7,0,"div",10),t._uU(19),t.YNc(20,Nt,3,1,"div",11),t.qZA()()(),t.YNc(21,Qt,7,7,"div",12),t.qZA()()}if(2&n){const i=e.ngIf,s=t.oxw();t.xp6(3),t.Udp("color",s.isExpanded?"green":"red")("font-size",150,"%"),t.xp6(2),t.AsE(" \xa0",s.shortUUID(i.jobId)," (",t.lcZ(6,13,s.toLocalDateTime(i.jobStatus.submitted)),") "),t.xp6(3),t.AsE(" ",s.friendlyMethod(i.parameters.METHOD),"; \xa0 waveforms: ",i.parameters.PRESET," "),t.xp6(2),t.hij(" ",i.jobStatus.state," "),t.xp6(8),t.Q6J("ngIf",s.assay.security.canWrite),t.xp6(1),t.hij(" ",i.parameters.PARAMS_SUMMARY," "),t.xp6(1),t.Q6J("ngIf",i.jobStatus.message&&"OK"!=i.jobStatus.message),t.xp6(1),t.Q6J("ngIf",s.isExpanded)}}Z.\u0275fac=function(e){return new(e||Z)},Z.\u0275cmp=t.Xpm({type:Z,selectors:[["bd2-stat-test-options-widget"]],outputs:{options:"options"},decls:14,vars:1,consts:[[3,"pvalue$"],[2,"margin-top","0.5em","text-align","center"],[3,"change"],["pattern",""],[3,"disabled","change"]],template:function(e,i){if(1&e&&(t.TgZ(0,"mat-card")(1,"mat-card-content")(2,"section")(3,"bd2-pvalue-form",0),t.NdJ("pvalue$",function(o){return i.pValue(o)}),t.qZA()(),t.TgZ(4,"section",1)(5,"mat-slide-toggle",2),t.NdJ("change",function(o){return i.bhCorrection(o.checked)}),t._uU(6,"Benjamini Hochberg correction"),t.qZA()(),t.TgZ(7,"section",1)(8,"mat-slide-toggle",2,3),t.NdJ("change",function(o){return i.showPattern(o.checked)}),t._uU(10,"show pattern"),t.qZA(),t._uU(11," \xa0 "),t.TgZ(12,"mat-slide-toggle",4),t.NdJ("change",function(o){return i.circadian(o.checked)}),t._uU(13,"circadian unit"),t.qZA()()()()),2&e){const s=t.MAs(9);t.xp6(12),t.Q6J("disabled",!s.checked)}},dependencies:[It.Rr,P.a8,P.dn,v],encapsulation:2});class _{set expanded(e){this.isExpanded=e,this.expandedToogleStream.next(e)}constructor(e,i,s,o){this.rhythmicityService=e,this.rhythmicityJobDatasource=i,this.feedback=s,this.dialogs=o,this.deleted=new t.vpe,this.isExpanded=!1,this.expandedToogleStream=new Q.X(!1)}ngOnInit(){this.initSubscriptions()}ngOnDestroy(){this.rhythmicityJobDatasource.close(),this.expandedToogleStream&&this.expandedToogleStream.complete()}ngOnChanges(e){(e.jobId||e.assay)&&this.jobId&&this.assay&&this.rhythmicityJobDatasource.assayJob([this.assay.id,this.jobId])}statTestOptions(e){const i=(0,F.H)(1).subscribe(()=>{this.statTestParams=e,i&&i.unsubscribe()})}export(){this.rhythmicityService.downloadJob(this.assay.id,this.jobId).subscribe(e=>{this.saveJobBlob(e,this.assay.id,this.jobId)},e=>this.feedback.error(e))}saveJobBlob(e,i,s){const o={fileName:i+"_job"+this.shortUUID(s)+".rhythmicity.csv",extensions:[".csv"]};(0,E.NL)(e,o).then(l=>{}).catch(l=>console.log("could not save export",l))}refresh(){this.rhythmicityJobDatasource.refresh(),this.resultsTable&&this.resultsTable.reload()}delete(){const e=this.assay,i=this.rhythmicityJobDatasource.currentJob;this.dialogs.confirm("Do you want to delete analysis: "+i.jobId,i.parameters.PARAMS_SUMMARY).subscribe(s=>{s&&this.doDelete(e,i.jobId)})}initSubscriptions(){this.rhythmicityJobDatasource.on(!0),this.rhythmicityJobDatasource.error$.forEach(e=>this.feedback.error(e))}doDelete(e,i){this.rhythmicityService.deleteJob(e,i).subscribe(s=>{this.deleted.next(s),this.feedback.success("Job: "+this.shortUUID(i)+" deleted")},s=>{this.feedback.error(s)})}toggleExpanded(){this.expanded=!this.isExpanded}toLocalDateTime(e){return k.a.deserialize(e).date}shortUUID(e){return(0,At.tm)(e)}friendlyMethod(e){return"BD2JTK"===e?"Classic JTK":"BD2EJTK"===e?"BD2 eJTK":e}}function kt(n,e){if(1&n&&(t.TgZ(0,"div")(1,"strong"),t._uU(2),t.qZA()()),2&n){const i=t.oxw(2);t.xp6(2),t.hij("Submitted jobs: ",i.jobs.length,"")}}function Et(n,e){1&n&&(t.TgZ(0,"div"),t._uU(1," No jobs submitted, start a new test. "),t.qZA())}_.\u0275fac=function(e){return new(e||_)(t.Y36(u.o),t.Y36(d),t.Y36(O.T),t.Y36(Ut.d))},_.\u0275cmp=t.Xpm({type:_,selectors:[["bd2-rhythmicity-job-pane"]],viewQuery:function(e,i){if(1&e&&t.Gf(y,5),2&e){let s;t.iGM(s=t.CRH())&&(i.resultsTable=s.first)}},inputs:{jobId:"jobId",assay:"assay",expanded:"expanded"},outputs:{deleted:"deleted"},features:[t._Bn([d]),t.TTD],decls:2,vars:3,consts:[["class","card mb-2",4,"ngIf"],[1,"card","mb-2"],[1,"card-header","clearfix"],["role","button",1,"float-left",3,"click"],[1,"material-icons","bd-icon"],[1,"float-right"],["role","button","aria-label","refresh",3,"click"],[1,"material-icons","bd-icon","bd-primary"],[1,"card-body"],[1,"clearfix"],["class","float-right",4,"ngIf"],["class","text-danger","style","word-wrap: break-word;",4,"ngIf"],[4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm","mr-1",3,"click"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"text-danger",2,"word-wrap","break-word"],[1,"center-block"],[2,"margin-top","0.5em","text-align","center"],[3,"options"],[3,"statTestParams","job"]],template:function(e,i){1&e&&(t.YNc(0,Ft,22,15,"div",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,i.rhythmicityJobDatasource.allJob$))},dependencies:[h.O5,Dt.Ou,P.a8,P.dn,St.d,y,Z,h.Ov,h.uU],encapsulation:2});const Bt=function(){return["new"]};function Ht(n,e){1&n&&(t.TgZ(0,"a",7),t._uU(1," New test "),t.qZA()),2&n&&t.Q6J("routerLink",t.DdM(1,Bt))}function Lt(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"div")(1,"bd2-rhythmicity-job-pane",8),t.NdJ("deleted",function(o){t.CHM(i);const l=t.oxw(2);return t.KtG(l.remove(o))}),t.qZA()()}if(2&n){const i=e.$implicit,s=e.index,o=t.oxw(2);t.xp6(1),t.Q6J("assay",o.assay)("jobId",i)("expanded",o.expandAll||0==s)}}function $t(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"div")(1,"h3"),t._uU(2,"Rhythmicity tests"),t.qZA(),t._UZ(3,"hr"),t.TgZ(4,"div",1)(5,"div",2),t.YNc(6,kt,3,1,"div",0),t.YNc(7,Et,2,0,"div",0),t.qZA(),t.TgZ(8,"div",3),t.YNc(9,Ht,2,2,"a",4),t.TgZ(10,"button",5),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.refresh())}),t._uU(11,"Refresh "),t.qZA()()(),t._UZ(12,"hr"),t.YNc(13,Lt,2,3,"div",6),t._UZ(14,"hr"),t.qZA()}if(2&n){const i=t.oxw();t.xp6(6),t.Q6J("ngIf",i.jobs&&i.jobs.length>0),t.xp6(1),t.Q6J("ngIf",!i.jobs||0==i.jobs.length),t.xp6(2),t.Q6J("ngIf",i.assay.security.canWrite),t.xp6(1),t.Q6J("disabled",i.blocked),t.xp6(3),t.Q6J("ngForOf",i.jobsIds)}}class C extends f{constructor(e,i){super(e,i),this.expandAll=!1,this.blocked=!1,this.titlePart=" Rhythm"}updateModel(e){super.updateModel(e),e&&this.loadJobs(e)}loadJobs(e,i=!1){this.blocked=!0,this.rhythmicityService.getJobs(e).subscribe(s=>{this.jobs=s,this.refreshJobsInfo(s),this.exportURL=this.rhythmicityService.exportURL(e),i&&this.refreshPanes(),this.blocked=!1},s=>{this.blocked=!1,this.feedback.error(s)})}refreshJobsInfo(e){this.jobsIds=e.map(i=>i.jobId)}refresh(){this.loadJobs(this.assay,!0)}refreshPanes(){this.panes&&this.panes.forEach(e=>e.refresh())}remove(e){const i=this.jobs.findIndex(s=>e.jobId===s.jobId);i>=0&&(this.jobs.splice(i,1),this.refreshJobsInfo(this.jobs))}refreshJob(e){const i=this.jobs.findIndex(s=>e.jobId===s.jobId);i>=0&&(this.jobs[i]=e,this.refreshJobsInfo(this.jobs))}calculateQueuing(e){return e.filter(i=>this.isQueueing(i.jobStatus.state)).length}isQueueing(e){switch(e){case"WAITING":case"PROCESSING":case"SUBMITTED":return!0;default:return!1}}checkFinished(e){return!!e.find(i=>this.isFinished(i.jobStatus.state))}isFinished(e){switch(e){case"SUCCESS":case"FINISHED":case"COMPLETED":return!0;default:return!1}}}C.\u0275fac=function(e){return new(e||C)(t.Y36(u.o),t.Y36(U.L))},C.\u0275cmp=t.Xpm({type:C,selectors:[["ng-component"]],viewQuery:function(e,i){if(1&e&&t.Gf(_,5),2&e){let s;t.iGM(s=t.CRH())&&(i.panes=s)}},features:[t.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-body"],["class","btn btn-primary mr-1",3,"routerLink",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary",3,"disabled","click"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary","mr-1",3,"routerLink"],[3,"assay","jobId","expanded","deleted"]],template:function(e,i){1&e&&t.YNc(0,$t,15,5,"div",0),2&e&&t.Q6J("ngIf",i.assay)},dependencies:[h.sg,h.O5,A.rH,_],encapsulation:2});var j=a(3174),Kt=a(8372),Gt=a(4661),zt=a(2724),Vt=a(4004),Wt=a(661),J=a(4698),Xt=a(5545);function te(n,e){if(1&n&&(t.TgZ(0,"option",29),t._uU(1),t.qZA()),2&n){const i=e.$implicit;t.Q6J("value",i.name),t.xp6(1),t.Oqu(i.label)}}function ee(n,e){1&n&&(t.TgZ(0,"div",30)(1,"div",31),t._uU(2," Rhythmicity tests are generally used for short, sparse timeseries. "),t._UZ(3,"br"),t._uU(4," The current limit is 5 or 4 days of hourly sampled data for eJTK preset and BD2 preset respectivelly."),t._UZ(5,"br"),t._uU(6," Generally the raw data are being analysed, but we also enabled a linear detrended option. "),t.qZA()())}function ie(n,e){if(1&n&&(t.TgZ(0,"option",29),t._uU(1),t.qZA()),2&n){const i=e.$implicit;t.Q6J("value",i.name),t.xp6(1),t.Oqu(i.label)}}function ne(n,e){1&n&&(t.TgZ(0,"div",30)(1,"div",31)(2,"p")(3,"b"),t._uU(4,"Classic JTK"),t.qZA(),t._uU(5," is the implementation of JTK_CYCLE from "),t.TgZ(6,"a",32),t._uU(7,"Michael E. Hughes et al. 2010"),t.qZA(),t._uU(8," a standard method for detecting rhythmicity in genome-scale datasets. "),t._UZ(9,"br"),t._uU(10,"The method is fast but it is reliable only when it tests against small set of patterns, we provide patterns of 24h cosines with different phases."),t.qZA(),t.TgZ(11,"p")(12,"b"),t._uU(13,"BD2 eJTK"),t.qZA(),t._uU(14," is the BioDare2 implementation of Empirical JTK_CYCLE with asymmetry search from "),t.TgZ(15,"a",33),t._uU(16,"Alan L. Hutchison et al. 2015"),t.qZA(),t._uU(17,". It is similar to the classic JTK method but with p values empirically calculated against set of random noise data. "),t._UZ(18,"br"),t._uU(19,"This modification permits using larger sets of test patterns and it provides better accuracy. However, this method is much slower so it can only analyze timeseries only up to 5 days of data (though the Classic JTK method was never intended to be used with such a long data)."),t.qZA()()())}function se(n,e){if(1&n&&(t.TgZ(0,"option",29),t._uU(1),t.qZA()),2&n){const i=e.$implicit;t.Q6J("value",i.name),t.xp6(1),t.Oqu(i.label)}}function oe(n,e){1&n&&(t.TgZ(0,"div",30)(1,"div",31),t._uU(2," Presets determine set of pattern curves against the comparison test is run."),t._UZ(3,"br"),t.TgZ(4,"ul")(5,"li"),t._uU(6,"Cosine 24h 1/2/4h are set of cosine curves of 24h periods, and phases spread every 1, 2, or 4 hours. To be used mainly with Classic JTK."),t.qZA(),t.TgZ(7,"li"),t._uU(8,"eJTK Classic is recommended for typical omics-like data for which eJTK method was developed. "),t._UZ(9,"br"),t._uU(10," It works well for short data (48h, 2h- 1h-sampled) when actual period is within range 22-26 hours."),t._UZ(11,"br"),t._uU(12," The patterns are series of cosine-like waveforms with 24h period, phases by 2hours and range of asymmetries by 2h (see original paper)."),t._UZ(13,"br"),t.qZA(),t.TgZ(14,"li"),t._uU(15,"BD2 Classic can detect non 24 periods and some forms of the spikes."),t._UZ(16,"br"),t._uU(17," As it compares against much more patterns it has a weaker power."),t._UZ(18,"br"),t._uU(19," It should be used when there is a good reason to suspect periods outside 22-26h range."),t._UZ(20,"br"),t._uU(21," The patterns are series of cosine-like waverforms with periods from 18-35hours, for each period there are multiple "),t.TgZ(22,"b"),t._uU(23,"circadian"),t.qZA(),t._uU(24," phases with step 2h (so each period value generates the same number of patterns but the peaks in absolute units do not coincide) and a range of assymetries by 2h in circadian units (see original paper). The preset contains also additional some spike patterns. "),t.qZA()()()())}const ae=function(){return[10,25,50,100,200]};class R extends Xt.P{constructor(e){super(e),this.methodOptions=c.RX,this.presetOptions=c.mM,this.dataHelp=!1,this.presetsHelp=!1,this.methodHelp=!1,this.rhythmicityRequests=new t.vpe,this.detrendingOptions=[J.QK.NO_DTR,J.QK.LIN_DTR],this.methodForm=this.mainForm.get("method"),this.presetForm=this.mainForm.get("preset")}buildMainForm(){return this.fb.group({displayParams:this.displayParamsForm,periodScale:this.fb.group({periodMin:[18,[r.kI.required]],periodMax:[34,[r.kI.required]]},{validator:i=>this.validPeriodScale(i.value)}),method:[c.v6.BD2EJTK.name,[r.kI.required]],preset:[c.Ah.EJTK_CLASSIC.name,[r.kI.required]]})}ngOnInit(){super.ngOnInit(),this.methodForm.valueChanges.subscribe(e=>this.setPresetOptions(e))}ngOnDestroy(){super.ngOnDestroy()}setPresetOptions(e){e===c.v6.BD2EJTK.name?(this.presetOptions=c.mM,this.presetForm.setValue(c.Ah.EJTK_CLASSIC.name)):e===c.v6.BD2JTK.name?(this.presetOptions=c.pd,this.presetForm.setValue(c.Ah.COS_2H.name)):this.presetOptions=[]}defaultDetrending(){return J.QK.NO_DTR.name}validPeriodScale(e){const i=e.periodMin,s=e.periodMax;return i<10?{validPeriodScale:"Period min must >= 10"}:s<10?{validPeriodScale:"Period max must >= 10"}:s>50?{validPeriodScale:"Period max must < 50"}:i>=s?{validPeriodScale:"Period min must be < max"}:null}analyse(){if(this.mainForm.invalid)return;const e=this.map2RhythmicityRequest(this.mainForm.value);e.isValid()&&this.rhythmicityRequests.next(e)}map2RhythmicityRequest(e){const i=new c.T9;return i.detrending=J.QK.get(e.displayParams.detrending),i.method=c.v6.get(e.method),i.preset=c.Ah.get(e.preset),i.periodMax=e.periodScale.periodMax,i.periodMin=e.periodScale.periodMin,i.windowEnd=e.displayParams.timeScale.timeEnd,i.windowStart=e.displayParams.timeScale.timeStart,i}}function re(n,e){if(1&n&&t._UZ(0,"bd2-ts-plots",3),2&n){const i=t.oxw(3);t.Q6J("data",i.timeseries)("tracesPerPlot",i.tracesPerPlot)}}function ce(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"div")(1,"bd2-rhythmicityjob-params-rform",1),t.NdJ("displayParams",function(o){t.CHM(i);const l=t.oxw(2);return t.KtG(l.emitDisplayParams(o))})("rhythmicityRequests",function(o){t.CHM(i);const l=t.oxw(2);return t.KtG(l.doAnalysis(o))}),t.qZA(),t._UZ(2,"hr"),t.YNc(3,re,1,2,"bd2-ts-plots",2),t.qZA()}if(2&n){const i=t.oxw(2);t.xp6(1),t.Q6J("disabled",i.blocked)("totalTraces",i.totalTraces)("currentPage",i.currentPage),t.xp6(2),t.Q6J("ngIf",i.timeseries)}}function le(n,e){if(1&n&&(t.TgZ(0,"div")(1,"h3"),t._uU(2,"Start rhythmicity test"),t.qZA(),t._UZ(3,"hr"),t.YNc(4,ce,4,4,"div",0),t.qZA()),2&n){const i=t.oxw();t.xp6(4),t.Q6J("ngIf",!i.disabled)}}R.\u0275fac=function(e){return new(e||R)(t.Y36(r.QS))},R.\u0275cmp=t.Xpm({type:R,selectors:[["bd2-rhythmicityjob-params-rform"]],inputs:{disabled:"disabled",totalTraces:"totalTraces",currentPage:"currentPage"},outputs:{displayParams:"displayParams",rhythmicityRequests:"rhythmicityRequests"},features:[t.qOj],decls:61,vars:15,consts:[["role","form",1,"form-horizontal",3,"formGroup"],["formGroupName","displayParams"],["formGroupName","timeScale",1,"form-group","row"],[1,"col-sm-4"],["for","windowStart",1,"col-sm-1"],[1,"col-sm-2"],["formControlName","timeStart","id","windowStart","min","0","required","","size","5","step","any","type","number",1,"form-control"],["for","windowEnd",1,"col-sm-1"],["formControlName","timeEnd","id","windowEnd","min","0","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],[1,"form-group","row"],["for","detrending",1,"col-sm-4"],[3,"click"],[1,"material-icons","bd-icon","bd-primary"],[1,"col-sm-6"],["formControlName","detrending","id","detrending","required","",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["class","col-sm-12",4,"ngIf"],["for","method",1,"col-sm-4"],["formControlName","method","id","method","required","",1,"form-control"],["formControlName","preset","id","preset","required","",1,"form-control"],["formGroupName","periodScale",1,"form-group","row",3,"hidden"],["for","periodMin",1,"col-sm-1"],["formControlName","periodMin","id","periodMin","max","50","min","10","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],["for","periodMax",1,"col-sm-1"],["formControlName","periodMax","id","periodMax","max","50","min","10","placeholder","","required","","size","5","step","any","type","number",1,"form-control"],[1,"col-sm-8"],[3,"length","disabled","pageSize","pageIndex","pageSizeOptions","page"],["dataPaginator",""],["type","button",1,"btn","btn-primary",3,"disabled","click"],[3,"value"],[1,"col-sm-12"],["role","alert","type","info",1,"alert","alert-info"],["href","https://dx.doi.org/10.1177%2F0748730410379711"],["href"," https://doi.org/10.1371/journal.pcbi.1004094","target","_blank"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),t._uU(4,"Data window"),t.qZA(),t.TgZ(5,"label",4),t._uU(6,"from:"),t.qZA(),t.TgZ(7,"div",5),t._UZ(8,"input",6),t.qZA(),t.TgZ(9,"label",7),t._uU(10,"to:"),t.qZA(),t.TgZ(11,"div",5),t._UZ(12,"input",8),t.qZA()(),t.TgZ(13,"div",9)(14,"label",10),t._uU(15,"Input Data "),t.TgZ(16,"a",11),t.NdJ("click",function(){return i.dataHelp=!i.dataHelp}),t.TgZ(17,"i",12),t._uU(18,"help"),t.qZA()()(),t.TgZ(19,"div",13)(20,"select",14),t.YNc(21,te,2,2,"option",15),t.qZA()()()(),t.YNc(22,ee,7,0,"div",16),t.TgZ(23,"div",9)(24,"label",17),t._uU(25,"Test Method "),t.TgZ(26,"a",11),t.NdJ("click",function(){return i.methodHelp=!i.methodHelp}),t.TgZ(27,"i",12),t._uU(28,"help"),t.qZA()()(),t.TgZ(29,"div",13)(30,"select",18),t.YNc(31,ie,2,2,"option",15),t.qZA()()(),t.YNc(32,ne,20,0,"div",16),t.TgZ(33,"div",9)(34,"label",17),t._uU(35,"Analysis Presets "),t.TgZ(36,"a",11),t.NdJ("click",function(){return i.presetsHelp=!i.presetsHelp}),t.TgZ(37,"i",12),t._uU(38,"help"),t.qZA()()(),t.TgZ(39,"div",13)(40,"select",19),t.YNc(41,se,2,2,"option",15),t.qZA()()(),t.YNc(42,oe,25,0,"div",16),t.TgZ(43,"div",20)(44,"label",3),t._uU(45,"Expected periods"),t.qZA(),t.TgZ(46,"label",21),t._uU(47,"from:"),t.qZA(),t.TgZ(48,"div",5),t._UZ(49,"input",22),t.qZA(),t.TgZ(50,"label",23),t._uU(51,"to:"),t.qZA(),t.TgZ(52,"div",5),t._UZ(53,"input",24),t.qZA()(),t.TgZ(54,"div",9),t._UZ(55,"label",5),t.TgZ(56,"div",25)(57,"mat-paginator",26,27),t.NdJ("page",function(o){return i.loadDataPage(o)}),t.qZA()()(),t.TgZ(59,"button",28),t.NdJ("click",function(){return i.analyse()}),t._uU(60,"Test Rhythmicity "),t.qZA()()),2&e&&(t.Q6J("formGroup",i.mainForm),t.xp6(21),t.Q6J("ngForOf",i.detrendingOptions),t.xp6(1),t.Q6J("ngIf",i.dataHelp),t.xp6(9),t.Q6J("ngForOf",i.methodOptions),t.xp6(1),t.Q6J("ngIf",i.methodHelp),t.xp6(9),t.Q6J("ngForOf",i.presetOptions),t.xp6(1),t.Q6J("ngIf",i.presetsHelp),t.xp6(1),t.Q6J("hidden",!0),t.xp6(14),t.Q6J("length",i.totalTraces)("disabled",i.disabledPagination)("pageSize",i.currentPage.pageSize)("pageIndex",i.currentPage.pageIndex)("pageSizeOptions",t.DdM(14,ae)),t.xp6(2),t.Q6J("disabled",i.disabled||i.mainForm.invalid))},dependencies:[h.sg,h.O5,r._Y,r.YN,r.Kr,r.Fj,r.wV,r.EJ,r.JJ,r.JL,r.Q7,r.qQ,r.Fd,r.sg,r.u,r.x0,D.NW],encapsulation:2});class x extends f{constructor(e,i,s,o,l){super(o,l),this.fetcher=e,this.analytics=i,this.userService=s,this.disabled=!1,this.blocked=!1,this.tracesPerPlot=5,this.totalTraces=0,this.currentPage=Gt.U.firstPage(),this.titlePart=" New Test"}ngOnInit(){super.ngOnInit(),this.timeSeriesSubsripction=this.fetcher.seriesPackStream.pipe((0,Kt.b)(1e3)).subscribe(e=>{const i=e.data;this.tracesPerPlot=Math.max(5,i.length/20),this.timeseries=i,this.totalTraces=e.totalTraces,this.currentPage=e.currentPage},e=>{console.log("Error in TS subscription: "+e),this.feedback.error(e)})}ngOnDestroy(){this.timeSeriesSubsripction&&this.timeSeriesSubsripction.unsubscribe(),this.fetcher.ngOnDestroy(),super.ngOnDestroy()}emitDisplayParams(e){this.fetcher.changeDisplayParams(e)}doAnalysis(e){e.isValid()&&(this.blocked=!0,this.rhythmicityService.newTest(this.assay,e).subscribe(i=>{this.feedback.success("Rhythmicity test submitted"),this.analytics.rhythmicityNew(e.method.name,this.assay.id,this.userService.currentUser.login),this.refreshModel(),this.goToRhythmicityHome()},i=>{this.blocked=!1,this.feedback.error(i)}))}updateModel(e){this.fetcher.experiment(e),super.updateModel(e)}}x.\u0275fac=function(e){return new(e||x)(t.Y36(j.C),t.Y36(zt.y),t.Y36(Vt.K),t.Y36(u.o),t.Y36(U.L))},x.\u0275cmp=t.Xpm({type:x,selectors:[["ng-component"]],features:[t._Bn([j.C]),t.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[3,"disabled","totalTraces","currentPage","displayParams","rhythmicityRequests"],[3,"data","tracesPerPlot",4,"ngIf"],[3,"data","tracesPerPlot"]],template:function(e,i){1&e&&t.YNc(0,le,5,1,"div",0),2&e&&t.Q6J("ngIf",i.assay)},dependencies:[h.O5,Wt.x,R],encapsulation:2});const he=[{path:"",children:[{path:"new",component:x},{path:"",component:C,pathMatch:"full"}]}];class g{}g.\u0275fac=function(e){return new(e||g)},g.\u0275mod=t.oAB({type:g}),g.\u0275inj=t.cJS({imports:[A.Bz.forChild(he),A.Bz]});var me=a(1585),de=a(6288),pe=a(6397);class b{}b.\u0275fac=function(e){return new(e||b)},b.\u0275mod=t.oAB({type:b}),b.\u0275inj=t.cJS({imports:[h.ez,r.u5,r.UX,me.i,de.G,pe.O,g]})}}]);