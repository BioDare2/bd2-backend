var E=class e{static{this.NONE=new e(0,"NONE","NONE")}static{this.IGNORED=new e(1,"IGNORED","Ignored")}static{this.TIME=new e(2,"TIME","Time")}static{this.DATA=new e(3,"DATA","Data")}static{this.BACKGROUND=new e(4,"BACKGROUND","Background noise")}static{this.LABEL=new e(5,"LABEL","Label")}constructor(t,s,i){this._id=t,this._name=s,this._label=i}get id(){return this._id}get name(){return this._name}get label(){return this._label}static get(t){return e.getValuesMap().get(t)}static getValuesMap(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}static initValuesMap(){let t=new Map;return t.set(e.NONE.name,e.NONE),t.set(e.IGNORED.name,e.IGNORED),t.set(e.TIME.name,e.TIME),t.set(e.DATA.name,e.DATA),t.set(e.BACKGROUND.name,e.BACKGROUND),t.set(e.LABEL.name,e.LABEL),t}toJSON(){return this.name}},o=class e{static{this.NONE=new e(0,"NONE","NONE","")}static{this.TIME_IN_HOURS=new e(1,"TIME_IN_HOURS","time in hours","h")}static{this.TIME_IN_MINUTES=new e(2,"TIME_IN_MINUTES","time in minutes","m")}static{this.TIME_IN_SECONDS=new e(3,"TIME_IN_SECONDS","time in seconds","s")}static{this.IMG_NUMBER=new e(4,"IMG_NUMBER","image nr. (1-based)","img")}constructor(t,s,i,r){this._id=t,this._name=s,this._label=i,this._unit=r}get id(){return this._id}get name(){return this._name}get label(){return this._label}get unit(){return this._unit}static get(t){return e.getValuesMap().get(t)}static getValuesMap(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}static initValuesMap(){let t=new Map;return t.set(e.NONE.name,e.NONE),t.set(e.TIME_IN_HOURS.name,e.TIME_IN_HOURS),t.set(e.TIME_IN_MINUTES.name,e.TIME_IN_MINUTES),t.set(e.TIME_IN_SECONDS.name,e.TIME_IN_SECONDS),t.set(e.IMG_NUMBER.name,e.IMG_NUMBER),t}toJSON(){return this.name}},g=class{},w=class{constructor(t){this.dataLabel=t}},n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function a(e){e=e-1;let t=n.length;if(e<t)return n[e];if(e<t*t+t){let s=Math.floor(e/t)-1,i=e%t;return n[s]+n[i]}if(e<16384){let s=Math.floor(e/(t*t))-1,i=e%(t*t),r=Math.floor(i/t)-1;return i=e%t,n[s]+n[r]+n[i]}throw new RangeError("Unsupported column number: "+(e+1))}function f(e){if(e<1||e>96)throw new RangeError("Unsupported topcount column number: "+e);e=e-1;let t=Math.floor(e/12);return n[t]+(e%12+1)}var u=class e{constructor(t,s){this.col=t,this.row=s}get numericalLabel(){return""+this.col+"-"+this.row}get excelLabel(){return a(this.col)+this.row}get columnLetter(){return a(this.col)}get topCountWell(){return n[this.row-1]+this.col}clone(){return new e(this.col,this.row)}},p=class e{constructor(t,s){this.first=t,this.last=s;let i=this.normalize(t,s);this.first=i[0],this.last=i[1]}get firstCol(){return this.first.col}get lastCol(){return this.last.col}get fullRangeLabel(){return this.isSingleCell()?this.first.excelLabel:this.first.excelLabel+"-"+this.last.excelLabel}get columnRangeLabel(){return this.isSingleCell()?this.first.columnLetter:this.first.columnLetter+"-"+this.last.columnLetter}get topCountRangeLabel(){return this.isSingleCell()?this.first.topCountWell:this.first.topCountWell+"-"+this.last.topCountWell}clone(){return new e(this.first.clone(),this.last.clone())}normalize(t,s){if(t.row<=s.row&&t.col<=s.col)return[t,s];let i=Math.min(t.row,s.row),r=Math.min(t.col,s.col),c=Math.max(t.row,s.row),h=Math.max(t.col,s.col);return[new u(r,i),new u(h,c)]}isSingleCell(){return this.first.row===this.last.row&&this.first.col===this.last.col}size(){let t=this.last.col-this.first.col+1,s=this.last.row-this.first.row+1;return t*s}},b=class e{constructor(t,s){this.range=t,this.content=s}get fullRangeLabel(){return this.range.fullRangeLabel}get columnRangeLabel(){return this.range.columnRangeLabel}get topCountRangeLabel(){return this.range.topCountRangeLabel}get firstCol(){return this.range.firstCol}get lastCol(){return this.range.lastCol}clone(){let t=new e(this.range.clone(),this.content);return t.role=this.role,t.details=this.details,t}},m=class e{constructor(t,s,i,r){this.start=t,this.end=s,this.details=i,this.value=r}get label(){return this.start===this.end?a(this.start):a(this.start)+"-"+a(this.end)}get topcountLabel(){return this.start===this.end?f(this.start):f(this.start)+"-"+f(this.end)}trimEnd(t){if(t<=this.start)return;let s=this.details.clone();return s.range.last.col=t-1,new e(this.start,t-1,s,this.value)}trimBegining(t){if(t>=this.end)return;let s=this.details.clone();return s.range.first.col=t+1,new e(t+1,this.end,s,this.value)}isSimilar(t){return!(this.details.role!==t.details.role||this.value!==t.value)}},T=class{constructor(){this.columns=[]}get blocks(){let t=[],s=1;for(;s<this.columns.length;){let i=this.columns[s];i?(t.push(i),s=i.end+1):s++}return t}details(t){let s=this.columns[t];if(s)return s.details}delete(t){if(t.size()===0)return!1;let s=!1;return this.columns[t.firstCol]&&(this.trimPreviousAt(t.firstCol),s=!0),this.columns[t.lastCol]&&(this.trimBehindAt(t.lastCol),s=!0),this.clear(t),s}insert(t,s){if(t.range.size()===0)return!1;let i=!1,r=new m(t.range.first.col,t.range.last.col,t,s);return this.columns[r.start]&&(this.trimPreviousAt(r.start),i=!0),this.columns[r.end]&&(this.trimBehindAt(r.end),i=!0),this.put(r),i}merge(){let t=1;for(;t<this.columns.length;){let s=this.columns[t];if(!s)t++;else if(!this.columns[s.end+1])t=s.end+1;else{let i=this.columns[s.end+1];s.isSimilar(i)?(s.end=i.end,s.details.range.last=i.details.range.last,this.put(s)):t=i.start}}}trimPreviousAt(t){let s=this.columns[t];if(s.start===t)return;let i=s.trimEnd(t);this.put(i)}trimBehindAt(t){let s=this.columns[t];if(s.end===t)return;let i=s.trimBegining(t);this.put(i)}put(t){for(let s=t.start;s<=t.end;s++)this.columns[s]=t}clear(t){for(let s=t.firstCol;s<=t.lastCol;s++)this.columns[s]=void 0}};var l=class e{static{this.NONE=new e(0,"NONE","none")}static{this.EXCEL_TABLE=new e(1,"EXCEL_TABLE","Excel Table")}static{this.TOPCOUNT=new e(2,"TOPCOUNT","TopCount")}static{this.TAB_SEP=new e(3,"TAB_SEP","Tab-separated")}static{this.COMA_SEP=new e(4,"COMA_SEP","Coma-separated")}constructor(t,s,i){this.id=t,this.name=s,this.label=i}static getValuesMap(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}static get(t){return e.getValuesMap().get(t)}static initValuesMap(){let t=new Map;return t.set(e.NONE.name,e.NONE),t.set(e.EXCEL_TABLE.name,e.EXCEL_TABLE),t.set(e.TOPCOUNT.name,e.TOPCOUNT),t.set(e.TAB_SEP.name,e.TAB_SEP),t.set(e.COMA_SEP.name,e.COMA_SEP),t}toJSON(){return this.name}},A=[l.EXCEL_TABLE,l.TAB_SEP,l.COMA_SEP,l.TOPCOUNT],N=class{},M=class extends N{constructor(){super(...arguments),this._class_name=".ExcelTSImportParameters"}},C=class{},L=class{constructor(t=-1,s=-1,i="",r=-1,c=-1,h="",S){this.colIx=t,this.colNumber=s,this.colName=i,this.rowIx=r,this.rowNumber=c,this.rowName=h,this.value=S,this.fake=!1}toJSON(){return{col:this.colNumber,row:this.rowNumber}}isBeforeOrSame(t){return this.colIx<=t.colIx&&this.rowIx<=t.rowIx}hasSameIx(t){return this.colIx===t.colIx&&this.rowIx===t.rowIx}},d=class{constructor(){this.inRows=!1,this.timeOffset=0,this.importLabels=!0,this.userLabels=[],this.containsBackgrounds=!1,this.backgroundsLabels=[]}get inLabel(){return this.inRows?"row":"column"}get inLabelNeg(){return this.inRows?"column":"row"}isTimeDefined(){return!(!this.firstTimeCell||!this.timeType||this.timeType==o.IMG_NUMBER&&(!this.imgInterval||+this.imgInterval<=0)||isNaN(Number(this.firstTimeCell.value)))}areLabelsCorrectlySelected(){return this.labelsSelection?this.areLabelsAfterTime():!1}areLabelsAfterTime(){return this.firstTimeCell&&this.labelsSelection?this.inRows?this.labelsSelection.colNumber<this.firstTimeCell.colNumber&&this.labelsSelection.colNumber>=0:this.labelsSelection.rowNumber<this.firstTimeCell.rowNumber&&this.labelsSelection.rowNumber>=0:!1}areLabelsCorrectlyAssigned(){return this.userLabels?this.userLabels.filter(t=>!!t).length>0:!1}isDataAfterTime(){return this.firstTimeCell&&this.dataStart?this.inRows?this.dataStart.rowNumber>this.firstTimeCell.rowNumber:this.dataStart.colNumber>this.firstTimeCell.colNumber:!1}isDataStartCorrectlySelected(){return this.dataStart?this.isDataAfterTime():!1}isComplete(){if(!this.isTimeDefined())return!1;if(this.importLabels){if(!this.areLabelsCorrectlySelected()||!this.isDataStartCorrectlySelected())return!1}else if(!this.areLabelsCorrectlyAssigned())return!1;return!0}summarizeLabels(t=10){if(!this.userLabels)return"No labels";let s=new Set;for(let i of this.userLabels)if(i&&(s.add(i),s.size>=t)){s.add("...");break}return[...s].join(", ")}},O=class extends d{constructor(){super(...arguments),this._class_name=".DataTableImportParameters"}};export{E as a,o as b,g as c,w as d,a as e,f,u as g,p as h,b as i,T as j,l as k,A as l,M as m,C as n,L as o,O as p};
