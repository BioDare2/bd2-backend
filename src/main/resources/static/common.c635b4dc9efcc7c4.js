"use strict";(self.webpackChunkbiodare2_ui=self.webpackChunkbiodare2_ui||[]).push([[592],{7521:(O,P,a)=>{a.d(P,{T:()=>T});var e=a(1896),n=a(2181),i=a(3997),M=a(5879),d=a(6593);let T=(()=>{class l{constructor(g,c,p){if(this.router=g,this.titleService=c,console.log("TitleSetter created"),p)throw new Error("TitleSetterService is already loaded. Activate it in the AppModule only");g.events.pipe((0,n.h)(u=>u instanceof e.m2),(0,i.x)((u,f)=>u.url===f.url)).subscribe(u=>{this.changedURL(u.urlAfterRedirects)},u=>{console.log("Error in router stream")},()=>console.log("Router stream end"))}changedURL(g){const c=this.getTitleFromURL(g);c&&this.setTitle(c)}getTitleFromURL(g){return g.endsWith("welcome")?"Circadian period analysis":g.endsWith("experiments")?"Experiments":g.endsWith("experiments/new")?"New Experiment":g.endsWith("login")?"Login":g.endsWith("account/register")?"Register":g.endsWith("account/edit")?"Account":""}setTitle(g){this.titleService.setTitle("BioDare2 "+g)}}return l.\u0275fac=function(g){return new(g||l)(M.LFG(e.F0),M.LFG(d.Dx),M.LFG(l,12))},l.\u0275prov=M.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},4047:(O,P,a)=>{a.d(P,{QT:()=>i,fD:()=>e,xE:()=>n});const e=[["about","About","Documentation"],["service","Service Description (T&C)","Service Description (T&C)"],["privacy","Privacy Statement","Privacy Statement"],["faq","Frequently Asked Questions (FAQ)","FAQ"],["timeseries-data","TimeSeries data and formats","Timeseries data"],["period-methods","Methods of period analysis","Period analysis methods"],["detrending","Detrending for period analysis","Detrending and analysis"],["phases","Phase calculation","Phase calculation"]];function n(M){return e.findIndex(d=>d[0]===M)>=0}function i(M){return e.find(d=>d[0]===M)}},481:(O,P,a)=>{a.d(P,{l:()=>g});var e=a(8189),n=a(4047),i=a(5879),M=a(6814),d=a(8262);function T(c,p){if(1&c&&(i.TgZ(0,"div",6),i._uU(1),i.qZA()),2&c){const u=i.oxw();i.xp6(1),i.Oqu(u.missing)}}function l(c,p){if(1&c&&i._UZ(0,"bd2-static-content",7),2&c){const u=i.oxw();i.Q6J("docName",u.docName)}}let h=(()=>{class c{constructor(u){const f=u?u.docName:void 0;(0,n.xE)(f)?(this.title=n.fD.find(v=>v[0]===f)[1],this.docName=f,this.missing=void 0):(this.missing="Unknown document: "+f,this.title=this.missing,this.docName=void 0)}ngOnInit(){}}return c.\u0275fac=function(u){return new(u||c)(i.Y36(e.WI))},c.\u0275cmp=i.Xpm({type:c,selectors:[["bd2-static-content-dialog"]],decls:8,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["class","alert alert-danger","role","alert","type","danger",4,"ngIf"],[3,"docName",4,"ngIf"],["mat-dialog-actions",""],["mat-dialog-close","","tabindex","-1",1,"btn","btn-primary"],["role","alert","type","danger",1,"alert","alert-danger"],[3,"docName"]],template:function(u,f){1&u&&(i.TgZ(0,"h1",0),i._uU(1),i.qZA(),i.TgZ(2,"div",1),i.YNc(3,T,2,1,"div",2),i.YNc(4,l,1,1,"bd2-static-content",3),i.qZA(),i.TgZ(5,"div",4)(6,"button",5),i._uU(7,"Close"),i.qZA()()),2&u&&(i.xp6(1),i.Oqu(f.title),i.xp6(2),i.Q6J("ngIf",f.missing),i.xp6(1),i.Q6J("ngIf",!f.missing))},dependencies:[M.O5,e.ZT,e.uh,e.xY,e.H8,d.$],encapsulation:2}),c})(),g=(()=>{class c{constructor(u){this.dialog=u}show(u){this.dialog.open(h,{data:{docName:u}})}}return c.\u0275fac=function(u){return new(u||c)(i.LFG(e.uw))},c.\u0275prov=i.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},8262:(O,P,a)=>{a.d(P,{$:()=>g});var e=a(5879),n=a(9862),i=a(8504),M=a(7398),d=a(6306),T=a(8351);let l=(()=>{class c{constructor(u){this.http=u}getDocs(u){const f=this.makeOptions();return this.OKTxt(this.http.get("assets/"+u+".html",f)).toPromise()}makeOptions(){return{headers:new n.WM({Accept:"text/html"}),responseType:"text",withCredentials:!0}}OKTxt(u){return u.pipe((0,M.U)(f=>{let v;return v=f.body?f.txt:f,v}),(0,d.K)(this.handleBadResponse))}handleBadResponse(u){let f;return console.error("Response error",u),f=401===u.status?"Bad credentials, locked or not activated account":T.q.extractMessage(u,"No error details"),(0,i._)(f)}}return c.\u0275fac=function(u){return new(u||c)(e.LFG(n.eN))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})();var h=a(1574);let g=(()=>{class c{constructor(u,f){this.contentService=u,this.feedback=f,this.content="loading..."}set docName(u){u&&(this.content="",this.contentService.getDocs(u).then(f=>this.content=f).catch(f=>{this.content="Cannot load: "+f,this.feedback.error(f)}))}ngOnInit(){}}return c.\u0275fac=function(u){return new(u||c)(e.Y36(l),e.Y36(h.T))},c.\u0275cmp=e.Xpm({type:c,selectors:[["bd2-static-content"]],inputs:{docName:"docName"},decls:1,vars:1,consts:[[3,"innerHTML"]],template:function(u,f){1&u&&e._UZ(0,"div",0),2&u&&e.Q6J("innerHTML",f.content,e.oJD)},encapsulation:2}),c})()},5945:(O,P,a)=>{a.d(P,{Cj:()=>g,Rl:()=>n,W4:()=>i,aF:()=>e,fV:()=>b,hp:()=>l,jF:()=>M,q7:()=>c});class e{constructor(m,A){this._name=m,this._label=A}get name(){return this._name}get label(){return this._label}static get(m){return e.getValuesMap().get(m)}static getValuesMap(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}static initValuesMap(){const m=new Map;return e.values.forEach(A=>m.set(A.name,A)),m}toJSON(){return this.name}}e.NLLS=new e("NLLS","FFT NLLS"),e.MFourFit=new e("MFourFit","MFourFit"),e.MESA=new e("MESA","MESA"),e.EPR=new e("EPR","ER Periodogram"),e.EPR_ND=new e("EPR_ND","ER Periodogram (no DT)"),e.LSPR=new e("LSPR","LS Periodogram"),e.SR=new e("SR","Spectrum Resampling"),e.SR_LD=new e("SR_LD","Spectrum Resampling (lin DT)"),e.FAKE=new e("FAKE","Fake method"),e.values=[e.NLLS,e.MFourFit,e.MESA,e.EPR,e.EPR_ND,e.LSPR,e.SR,e.SR_LD,e.FAKE];const n=[e.NLLS,e.MFourFit,e.MESA,e.EPR,e.LSPR,e.SR];class i{isValid(){return!(this.windowStart<0||this.windowEnd<0||this.periodMin<=0||this.periodMax<=0||this.periodMin>this.periodMax||this.windowEnd>0&&this.windowStart>=this.windowEnd||null==this.method||null==this.detrending)}}class M{static sameJob(m,A){return!(!m||!A)&&m.jobId===A.jobId&&m.parentId===A.parentId}static hasFailed(m){return!(!m||this.isFinished(m)||this.isRunning(m))}static isFinished(m){return!(!m||!m.state||"FINISHED"!==m.state&&"SUCCESS"!==m.state)}static isRunning(m){return!(!m||!m.state||"SUBMITTED"!==m.state&&"PROCESSING"!==m.state)}}function l(E,m){switch(m){case"ByFit":case"f":return E.f;case"ByMethod":case"m":return E.m;case"ByFirstPeak":case"p":return E.p;case"ByAvgMax":case"a":return E.a;default:throw new Error("Unknown phase option: "+m)}}class g{static extractState(m){return m.failed?"F":m.ignored?" I":m.attention?"A":""}}function c(E,m,A){if("zero"===m&&"circ"===A)return E.ph2ZCir;if("zero"===m&&"abs"===A)return E.ph2Z;if("dw"===m&&"circ"===A)return E.ph2WCir;if("dw"===m&&"abs"===A)return E.ph2W;throw new Error("Unknown relative/unit combination: "+m+":"+A)}class b{}},3491:(O,P,a)=>{a.d(P,{D:()=>M});var e=a(7398),n=a(5879),i=a(8351);let M=(()=>{class d{constructor(l){this.BD2REST=l}newPPA(l,h){return this.BD2REST.ppaNew(l.id,h)}getPPAJobs(l){return this.BD2REST.ppaJobs(l.id).pipe((0,e.U)(h=>h.data))}getPPAJob(l,h){return this.BD2REST.ppaJob(l,h)}downloadPPAJob(l,h,g){return this.BD2REST.ppaExportJob(l,h,g)}deletePPAJob(l,h){return this.BD2REST.ppaDeleteJob(l.id,h)}getPPAJobResultsGrouped(l,h){return this.BD2REST.ppaJobResultsGrouped(l,h)}getPPAJobSimpleResults(l,h){return this.BD2REST.ppaJobSimpleResults(l,h)}getPPAForSelect(l,h){return this.BD2REST.ppaForSelect(l,h).then(g=>g.data)}getPPAJobSimpleStats(l,h){return this.BD2REST.ppaJobSimpleStat(l,h)}getPPAResults(l){return this.BD2REST.ppaResults(l.id).then(h=>h.data)}doPPASelection(l,h,g){return this.BD2REST.ppaDoSelection(l,h,g)}exportURL(l){return this.BD2REST.ppaExportURL(l.id)}}return d.\u0275fac=function(l){return new(l||d)(n.LFG(i.q))},d.\u0275prov=n.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},1301:(O,P,a)=>{a.d(P,{Ah:()=>i,GJ:()=>h,Mn:()=>f,RX:()=>n,T9:()=>T,mM:()=>M,pd:()=>d,v6:()=>e});class e{constructor(r,t){this._name=r,this._label=t}get name(){return this._name}get label(){return this._label}static get(r){return e.getValuesMap().get(r)}static getValuesMap(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}static initValuesMap(){const r=new Map;return e.values.forEach(t=>r.set(t.name,t)),r}toJSON(){return this.name}}e.BD2EJTK=new e("BD2EJTK","BD2 eJTK"),e.BD2JTK=new e("BD2JTK","Classic JTK"),e.values=[e.BD2JTK,e.BD2EJTK];const n=[e.BD2JTK,e.BD2EJTK];class i{constructor(r,t){this._name=r,this._label=t}get name(){return this._name}get label(){return this._label}static get(r){return i.getValuesMap().get(r)}static getValuesMap(){return i.valuesMap||(i.valuesMap=i.initValuesMap()),i.valuesMap}static initValuesMap(){const r=new Map;return i.values.forEach(t=>r.set(t.name,t)),r}toJSON(){return this.name}}i.EJTK_CLASSIC=new i("EJTK_CLASSIC","eJTK Classic"),i.BD2_CLASSIC=new i("BD2_CLASSIC","BD2 Classic"),i.BD2_SPREAD=new i("BD2_SPREAD","Period range"),i.COS_1H=new i("COS_1H","Cosine 24h 1h"),i.COS_2H=new i("COS_2H","Cosine 24h 2h"),i.COS_4H=new i("COS_4H","Cosine 24h 4h"),i.values=[i.COS_1H,i.COS_2H,i.COS_4H,i.EJTK_CLASSIC,i.BD2_CLASSIC,i.BD2_SPREAD];const M=[i.COS_1H,i.COS_2H,i.COS_4H,i.EJTK_CLASSIC,i.BD2_CLASSIC],d=[i.COS_1H,i.COS_2H,i.COS_4H];class T{isValid(){return!(this.windowStart<0||this.windowEnd<0||this.periodMin<=0||this.periodMax<=0||this.periodMin>this.periodMax||this.windowEnd>0&&this.windowStart>=this.windowEnd||null==this.method||null==this.preset||null==this.detrending)}}class h{static sameJob(r,t){return!(!r||!t)&&r.jobId===t.jobId&&r.parentId===t.parentId}static hasFailed(r){return!(!r||this.isFinished(r)||this.isRunning(r))}static isFinished(r){return!(!r||!r.jobStatus||"FINISHED"!==r.jobStatus.state&&"SUCCESS"!==r.jobStatus.state)}static isRunning(r){return!!r&&!(!r||!r.jobStatus||"SUBMITTED"!==r.jobStatus.state&&"PROCESSING"!==r.jobStatus.state)}}class f{constructor(r=0,t=!1,s=!1,S=!1){this.pValue=r,this.bhCorrection=t,this.showPattern=s,this.circadian=S}clone(){return new f(this.pValue,this.bhCorrection,this.showPattern,this.circadian)}}},7469:(O,P,a)=>{a.d(P,{o:()=>M});var e=a(7398),n=a(5879),i=a(8351);let M=(()=>{class d{constructor(l){this.BD2REST=l}newTest(l,h){return this.BD2REST.rhythmicityNew(l.id,h)}getJob(l,h){return this.BD2REST.rhythmicityJob(l,h)}getJobs(l){return this.BD2REST.rhythmicityJobs(l.id).pipe((0,e.U)(h=>h.data))}getResults(l,h){return this.BD2REST.rhythmicityResults(l,h)}exportURL(l){return this.BD2REST.ppaExportURL(l.id)}deleteJob(l,h){return this.BD2REST.rhythmicityDeleteJob(l.id,h)}downloadJob(l,h){return this.BD2REST.rhythmicityExportJob(l,h)}}return d.\u0275fac=function(l){return new(l||d)(n.LFG(i.q))},d.\u0275prov=n.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},8685:(O,P,a)=>{a.d(P,{Jt:()=>g,Kw:()=>i,Xc:()=>l,kk:()=>n,nl:()=>T,p5:()=>d});var e=a(6138);class n{constructor(p,u,f){this.id=p,this.name=u,this.label=f}static getValuesMap(){return n.valuesMap||(n.valuesMap=n.initValuesMap()),n.valuesMap}static get(p){return n.getValuesMap().get(p)}static initValuesMap(){const p=new Map;return p.set(n.NONE.name,n.NONE),p.set(n.EXCEL_TABLE.name,n.EXCEL_TABLE),p.set(n.TOPCOUNT.name,n.TOPCOUNT),p.set(n.TAB_SEP.name,n.TAB_SEP),p.set(n.COMA_SEP.name,n.COMA_SEP),p}toJSON(){return this.name}}n.NONE=new n(0,"NONE","none"),n.EXCEL_TABLE=new n(1,"EXCEL_TABLE","Excel Table"),n.TOPCOUNT=new n(2,"TOPCOUNT","TopCount"),n.TAB_SEP=new n(3,"TAB_SEP","Tab-separated"),n.COMA_SEP=new n(4,"COMA_SEP","Coma-separated");const i=[n.EXCEL_TABLE,n.TAB_SEP,n.COMA_SEP,n.TOPCOUNT];class M{}class d extends M{constructor(){super(...arguments),this._class_name=".ExcelTSImportParameters"}}class T{}class l{constructor(p=-1,u=-1,f="",v=-1,r=-1,t="",s){this.colIx=p,this.colNumber=u,this.colName=f,this.rowIx=v,this.rowNumber=r,this.rowName=t,this.value=s,this.fake=!1}toJSON(){return{col:this.colNumber,row:this.rowNumber}}isBeforeOrSame(p){return this.colIx<=p.colIx&&this.rowIx<=p.rowIx}hasSameIx(p){return this.colIx===p.colIx&&this.rowIx===p.rowIx}}class h{constructor(){this.inRows=!1,this.timeOffset=0,this.importLabels=!0,this.userLabels=[],this.containsBackgrounds=!1,this.backgroundsLabels=[]}get inLabel(){return this.inRows?"row":"column"}get inLabelNeg(){return this.inRows?"column":"row"}isTimeDefined(){return!(!this.firstTimeCell||!this.timeType||this.timeType==e.ET.IMG_NUMBER&&(!this.imgInterval||+this.imgInterval<=0)||isNaN(Number(this.firstTimeCell.value)))}areLabelsCorrectlySelected(){return!!this.labelsSelection&&this.areLabelsAfterTime()}areLabelsAfterTime(){return!(!this.firstTimeCell||!this.labelsSelection)&&(this.inRows?this.labelsSelection.colNumber<this.firstTimeCell.colNumber&&this.labelsSelection.colNumber>=0:this.labelsSelection.rowNumber<this.firstTimeCell.rowNumber&&this.labelsSelection.rowNumber>=0)}areLabelsCorrectlyAssigned(){return!!this.userLabels&&this.userLabels.filter(p=>!!p).length>0}isDataAfterTime(){return!(!this.firstTimeCell||!this.dataStart)&&(this.inRows?this.dataStart.rowNumber>this.firstTimeCell.rowNumber:this.dataStart.colNumber>this.firstTimeCell.colNumber)}isDataStartCorrectlySelected(){return!!this.dataStart&&this.isDataAfterTime()}isComplete(){if(!this.isTimeDefined())return!1;if(this.importLabels){if(!this.areLabelsCorrectlySelected()||!this.isDataStartCorrectlySelected())return!1}else if(!this.areLabelsCorrectlyAssigned())return!1;return!0}summarizeLabels(p=10){if(!this.userLabels)return"No labels";const u=new Set;for(const f of this.userLabels)if(f&&(u.add(f),u.size>=p)){u.add("...");break}return[...u].join(", ")}}class g extends h{constructor(){super(...arguments),this._class_name=".DataTableImportParameters"}}},6138:(O,P,a)=>{a.d(P,{ET:()=>n,H3:()=>e,Mt:()=>v,T:()=>M,Wr:()=>u,bq:()=>i,jO:()=>T,jh:()=>h,lu:()=>p,xn:()=>c});class e{constructor(t,s,S){this._id=t,this._name=s,this._label=S}get id(){return this._id}get name(){return this._name}get label(){return this._label}static get(t){return e.getValuesMap().get(t)}static getValuesMap(){return e.valuesMap||(e.valuesMap=e.initValuesMap()),e.valuesMap}static initValuesMap(){const t=new Map;return t.set(e.NONE.name,e.NONE),t.set(e.IGNORED.name,e.IGNORED),t.set(e.TIME.name,e.TIME),t.set(e.DATA.name,e.DATA),t.set(e.BACKGROUND.name,e.BACKGROUND),t.set(e.LABEL.name,e.LABEL),t}toJSON(){return this.name}}e.NONE=new e(0,"NONE","NONE"),e.IGNORED=new e(1,"IGNORED","Ignored"),e.TIME=new e(2,"TIME","Time"),e.DATA=new e(3,"DATA","Data"),e.BACKGROUND=new e(4,"BACKGROUND","Background noise"),e.LABEL=new e(5,"LABEL","Label");class n{constructor(t,s,S,b){this._id=t,this._name=s,this._label=S,this._unit=b}get id(){return this._id}get name(){return this._name}get label(){return this._label}get unit(){return this._unit}static get(t){return n.getValuesMap().get(t)}static getValuesMap(){return n.valuesMap||(n.valuesMap=n.initValuesMap()),n.valuesMap}static initValuesMap(){const t=new Map;return t.set(n.NONE.name,n.NONE),t.set(n.TIME_IN_HOURS.name,n.TIME_IN_HOURS),t.set(n.TIME_IN_MINUTES.name,n.TIME_IN_MINUTES),t.set(n.TIME_IN_SECONDS.name,n.TIME_IN_SECONDS),t.set(n.IMG_NUMBER.name,n.IMG_NUMBER),t}toJSON(){return this.name}}n.NONE=new n(0,"NONE","NONE",""),n.TIME_IN_HOURS=new n(1,"TIME_IN_HOURS","time in hours","h"),n.TIME_IN_MINUTES=new n(2,"TIME_IN_MINUTES","time in minutes","m"),n.TIME_IN_SECONDS=new n(3,"TIME_IN_SECONDS","time in seconds","s"),n.IMG_NUMBER=new n(4,"IMG_NUMBER","image nr. (1-based)","img");class i{}class M{constructor(t){this.dataLabel=t}}const d="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function T(r){const t=d.length;if((r-=1)<t)return d[r];if(r<t*t+t){const s=Math.floor(r/t)-1;return d[s]+d[r%t]}if(r<16384){const s=Math.floor(r/(t*t))-1;let S=r%(t*t);const b=Math.floor(S/t)-1;return S=r%t,d[s]+d[b]+d[S]}throw new RangeError("Unsupported column number: "+(r+1))}function h(r){if(r<1||r>96)throw new RangeError("Unsupported topcount column number: "+r);r-=1;const t=Math.floor(r/12);return d[t]+(r%12+1)}class c{constructor(t,s){this.col=t,this.row=s}get numericalLabel(){return this.col+"-"+this.row}get excelLabel(){return T(this.col)+this.row}get columnLetter(){return T(this.col)}get topCountWell(){return d[this.row-1]+this.col}clone(){return new c(this.col,this.row)}}class p{constructor(t,s){this.first=t,this.last=s;const S=this.normalize(t,s);this.first=S[0],this.last=S[1]}get firstCol(){return this.first.col}get lastCol(){return this.last.col}get fullRangeLabel(){return this.isSingleCell()?this.first.excelLabel:this.first.excelLabel+"-"+this.last.excelLabel}get columnRangeLabel(){return this.isSingleCell()?this.first.columnLetter:this.first.columnLetter+"-"+this.last.columnLetter}get topCountRangeLabel(){return this.isSingleCell()?this.first.topCountWell:this.first.topCountWell+"-"+this.last.topCountWell}clone(){return new p(this.first.clone(),this.last.clone())}normalize(t,s){if(t.row<=s.row&&t.col<=s.col)return[t,s];const S=Math.min(t.row,s.row),b=Math.min(t.col,s.col),o=Math.max(t.row,s.row),D=Math.max(t.col,s.col);return[new c(b,S),new c(D,o)]}isSingleCell(){return this.first.row===this.last.row&&this.first.col===this.last.col}size(){return(this.last.col-this.first.col+1)*(this.last.row-this.first.row+1)}}class u{constructor(t,s){this.range=t,this.content=s}get fullRangeLabel(){return this.range.fullRangeLabel}get columnRangeLabel(){return this.range.columnRangeLabel}get topCountRangeLabel(){return this.range.topCountRangeLabel}get firstCol(){return this.range.firstCol}get lastCol(){return this.range.lastCol}clone(){const t=new u(this.range.clone(),this.content);return t.role=this.role,t.details=this.details,t}}class f{constructor(t,s,S,b){this.start=t,this.end=s,this.details=S,this.value=b}get label(){return this.start===this.end?T(this.start):T(this.start)+"-"+T(this.end)}get topcountLabel(){return this.start===this.end?h(this.start):h(this.start)+"-"+h(this.end)}trimEnd(t){if(t<=this.start)return;const s=this.details.clone();return s.range.last.col=t-1,new f(this.start,t-1,s,this.value)}trimBegining(t){if(t>=this.end)return;const s=this.details.clone();return s.range.first.col=t+1,new f(t+1,this.end,s,this.value)}isSimilar(t){return!(this.details.role!==t.details.role||this.value!==t.value)}}class v{constructor(){this.columns=[]}get blocks(){const t=[];let s=1;for(;s<this.columns.length;){const S=this.columns[s];S?(t.push(S),s=S.end+1):s++}return t}details(t){const s=this.columns[t];if(s)return s.details}delete(t){if(0===t.size())return!1;let s=!1;return this.columns[t.firstCol]&&(this.trimPreviousAt(t.firstCol),s=!0),this.columns[t.lastCol]&&(this.trimBehindAt(t.lastCol),s=!0),this.clear(t),s}insert(t,s){if(0===t.range.size())return!1;let S=!1;const b=new f(t.range.first.col,t.range.last.col,t,s);return this.columns[b.start]&&(this.trimPreviousAt(b.start),S=!0),this.columns[b.end]&&(this.trimBehindAt(b.end),S=!0),this.put(b),S}merge(){let t=1;for(;t<this.columns.length;){const s=this.columns[t];if(s)if(this.columns[s.end+1]){const S=this.columns[s.end+1];s.isSimilar(S)?(s.end=S.end,s.details.range.last=S.details.range.last,this.put(s)):t=S.start}else t=s.end+1;else t++}}trimPreviousAt(t){const s=this.columns[t];if(s.start===t)return;const S=s.trimEnd(t);this.put(S)}trimBehindAt(t){const s=this.columns[t];if(s.end===t)return;const S=s.trimBegining(t);this.put(S)}put(t){for(let s=t.start;s<=t.end;s++)this.columns[s]=t}clear(t){for(let s=t.firstCol;s<=t.lastCol;s++)this.columns[s]=void 0}}},6828:(O,P,a)=>{a.d(P,{i:()=>e});class e{constructor(i=1e3,M=3e4,d=3e5,T=2){this.RELOAD_INT=i,this.MAX_RELOAD_INT=M,this.MAX_RELOAD_TIME=d,this.RELOAD_FACTOR=T,T<1&&(this.RELOAD_FACTOR=2)}nextInterval(i){if(this.id!==i?this.reset(i):this.interval<this.MAX_RELOAD_INT&&(this.interval*=this.RELOAD_FACTOR),this.deadline>Date.now())return this.interval}reset(i){this.id=i,this.interval=this.RELOAD_INT,this.deadline=Date.now()+this.MAX_RELOAD_TIME}}},5323:(O,P,a)=>{a.d(P,{v:()=>s});var e=a(2096),n=a(1344),i=a(8645),M=a(5619),d=a(2572),T=a(3019),l=a(4900),h=a(8180),g=a(7398),c=a(3620),p=a(9397),u=a(6306),f=a(2181),v=a(3997),r=a(4664);let t=(()=>{class S{constructor(o=!1){this.removeDebounce=o,this.error$=new i.x,this.isFetching$=new M.X(!1),this.isProcessing$=new M.X(!1),this.dataLength=0,this.page$=new M.X(void 0),this.sort$=new M.X(void 0),this.on$=new M.X(!1),this.refresh$=new i.x,this.input$=new M.X(void 0),this.params$=new M.X(void 0),this.asset$=new M.X(void 0),this.DEBUG=!1,this.dataInputsDebounce=200,this.busyDebounce=50,this.id=S.ids++,this.logMe("created"),this.initAssetsStream(),this.isBusy$=this.initBusyStream(),this.data$=this.initDataStream()}logMe(o,D){this.DEBUG&&(o=this.constructor.name+":"+this.id+" "+o,D?console.log(o,D):console.log(o))}input(o){o&&this.input$.next(o)}params(o){this.params$.next(o)}on(o=!0){this.on$.next(o)}refresh(){this.refresh$.next(!0)}page(o){this.page$.next(o)}sort(o){this.sort$.next(o),this.resetPage()}close(){this.asset$.complete(),this.error$.complete(),this.isFetching$.complete(),this.isProcessing$.complete(),this.input$.complete(),this.params$.complete(),this.on$.complete(),this.refresh$.complete(),this.page$.complete(),this.sort$.complete()}errorToData(o){return(0,e.of)(void 0)}resetPage(){this.page$.pipe((0,h.q)(1)).subscribe(o=>{if(o){const D=new l.kl;D.pageIndex=0,D.pageSize=o.pageSize,this.page(D)}})}initBusyStream(){return this.removeDebounce?(0,d.a)([this.isFetching$,this.isProcessing$]).pipe((0,g.U)(([o,D])=>o||D)):(0,d.a)([this.isFetching$,this.isProcessing$]).pipe((0,c.b)(this.busyDebounce),(0,g.U)(([o,D])=>o||D))}initDataStream(){const o=this.dataMutators();let D;return D=this.removeDebounce?(0,d.a)(o):(0,d.a)(o).pipe((0,c.b)(this.dataInputsDebounce)),D.pipe((0,p.b)(E=>this.logMe("Input for data stream",E)),(0,p.b)(E=>this.isProcessing$.next(!0)),(0,g.U)(([E,m,A,R])=>{this.dataLength=this.assetToDataLength(E,R);const w=this.processSortedPagedData(E,m,A,R);return this.currentSort=m,this.currentPage=A,this.currentParams=R,this.currentData=w,w}),(0,u.K)(E=>(this.error$.next(E),this.errorToData(E))),(0,p.b)(E=>this.isProcessing$.next(!1)))}dataMutators(){return[this.asset$.pipe((0,f.h)(o=>!!o)),this.sort$,this.page$.pipe((0,f.h)(o=>!!o)),this.params$]}initAssetsStream(){this.initAssetsInput().subscribe(o=>this.loadAsset(o),o=>this.error$.next(o))}loadAsset(o){this.isFetching$.next(!0),this.fetchAsset(o).subscribe(D=>{this.isFetching$.next(!1),this.setAsset(D,o)},D=>{this.isFetching$.next(!1),this.error$.next(D)})}setAsset(o,D){this.currentInput=D,this.currentAsset=o,this.asset$.next(o)}initAssetsInput(){const D=(0,d.a)([this.input$,this.on$]).pipe((0,f.h)(([A,R])=>A&&R),(0,g.U)(([A,R])=>A)).pipe((0,v.x)((A,R)=>this.sameInput(A,R))),E=this.refresh$.pipe((0,r.w)(A=>D.pipe((0,h.q)(1))));return(0,T.T)(D,E).pipe((0,p.b)(A=>this.logMe("Assets input",A)))}}return S.ids=0,S})();class s extends t{constructor(b=!1){super(b),this.removeDebounce=b}sortingKey(b,o){return D=>D}processData(b,o){return b}errorToData(b){return(0,e.of)([])}processSortedPagedData(b,o,D,E){let m=this.assetToData(b,E);return m=this.sortData(m,o,E),m=this.pageData(m,D,E),m=this.processData(m,E),m}sortData(b,o,D){return o&&o.active&&""!==o.direction?(0,n.Ic)(b,o.direction,this.sortingKey(o,D)):b}pageData(b,o,D){return o?(0,n.sq)(b,o):b}assetToDataLength(b,o){return this.assetToData(b).length}}},7439:(O,P,a)=>{a.d(P,{S:()=>f});var e=a(8645),n=a(5619),i=a(2572),M=a(3019),d=a(9080),T=a(2181),l=a(3620),h=a(7398),g=a(3997),c=a(4664),p=a(8180),u=a(9397);let f=(()=>{class v{constructor(t=!1){this.removeDebounce=t,this.error$=new e.x,this.on$=new n.X(!1),this.refresh$=new e.x,this.input$=new n.X(void 0),this.asset$=new n.X(void 0),this.reloading$=new n.X(!1),this.DEBUG=!1,this.reloadDebounce=50,this.id=v.ids++,this.logMe("created"),this.currentReloadStatus=this.initIntervalsKeeper(),this.finished$=this.asset$.asObservable().pipe((0,T.h)(s=>s&&this.isFinished(s))),this.running$=this.asset$.asObservable().pipe((0,T.h)(s=>s&&this.isRunning(s))),this.failed$=this.asset$.asObservable().pipe((0,T.h)(s=>s&&this.hasFailed(s))),this.all$=this.asset$.asObservable().pipe((0,T.h)(s=>null!=s&&void 0!==s)),this.isReloading$=this.initReloadingStream(),this.initAssetsStream(),this.initReloads()}logMe(t,s){this.DEBUG&&(t=this.constructor.name+":"+this.id+" "+t,s?console.log(t,s):console.log(t))}close(){this.asset$.complete(),this.input$.complete(),this.error$.complete(),this.reloading$.complete(),this.on$.complete(),this.refresh$.complete(),this.reloadSubscription&&this.reloadSubscription.unsubscribe()}input(t){t&&this.input$.next(t)}on(t=!0){this.on$.next(t)}refresh(){this.currentReloadStatus.reset(void 0),this.reloadSubscription&&this.reloadSubscription.unsubscribe(),this.refresh$.next(!0)}initReloadingStream(){return this.removeDebounce?this.reloading$.asObservable():this.reloading$.asObservable().pipe((0,l.b)(this.reloadDebounce))}initAssetsStream(){this.initAssetsInput().subscribe(t=>this.loadAsset(t),t=>this.error$.next(t))}initReloads(){this.running$.subscribe(t=>this.reload(t))}loadAsset(t){this.fetchAsset(t).subscribe(s=>{this.setAsset(s,t)},s=>{this.error$.next(s)})}setAsset(t,s){this.currentInput=s,this.currentAsset=t,this.reloading$.next(this.isRunning(t)),this.asset$.next(t)}initAssetsInput(){const s=(0,i.a)([this.input$,this.on$]).pipe((0,T.h)(([o,D])=>o&&D),(0,h.U)(([o,D])=>o)).pipe((0,g.x)((o,D)=>this.sameInput(o,D))),S=this.refresh$.pipe((0,c.w)(o=>s.pipe((0,p.q)(1))));return(0,M.T)(s,S).pipe((0,u.b)(o=>this.logMe("Assets input",o)))}reload(t){this.reloadSubscription&&this.reloadSubscription.unsubscribe();const s=this.currentReloadStatus.nextInterval(this.assetToId(t));if(!s)return void this.reloading$.next(!1);const S=this.assetToInput(t);this.reloadSubscription=(0,d.H)(s).subscribe(b=>{this.sameInput(S,this.currentInput)?(this.reloadSubscription=void 0,this.loadAsset(S)):console.log("Disabled reload as input has changed")})}}return v.ids=0,v})()}}]);